(()=>{var t={9662:(t,e,i)=>{var n=i(614),s=i(6330),o=TypeError;t.exports=function(t){if(n(t))return t;throw o(s(t)+" is not a function")}},9483:(t,e,i)=>{var n=i(4411),s=i(6330),o=TypeError;t.exports=function(t){if(n(t))return t;throw o(s(t)+" is not a constructor")}},6077:(t,e,i)=>{var n=i(614),s=String,o=TypeError;t.exports=function(t){if("object"==typeof t||n(t))return t;throw o("Can't set "+s(t)+" as a prototype")}},1223:(t,e,i)=>{var n=i(5112),s=i(30),o=i(3070).f,r=n("unscopables"),a=Array.prototype;null==a[r]&&o(a,r,{configurable:!0,value:s(null)}),t.exports=function(t){a[r][t]=!0}},1530:(t,e,i)=>{"use strict";var n=i(8710).charAt;t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},5787:(t,e,i)=>{var n=i(7976),s=TypeError;t.exports=function(t,e){if(n(e,t))return t;throw s("Incorrect invocation")}},9670:(t,e,i)=>{var n=i(111),s=String,o=TypeError;t.exports=function(t){if(n(t))return t;throw o(s(t)+" is not an object")}},7556:(t,e,i)=>{var n=i(7293);t.exports=n((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},8457:(t,e,i)=>{"use strict";var n=i(9974),s=i(6916),o=i(7908),r=i(3411),a=i(7659),c=i(4411),u=i(6244),l=i(6135),h=i(4121),g=i(1246),d=Array;t.exports=function(t){var e=o(t),i=c(this),f=arguments.length,p=f>1?arguments[1]:void 0,v=void 0!==p;v&&(p=n(p,f>2?arguments[2]:void 0));var y,m,I,C,_,b,T=g(e),O=0;if(!T||this===d&&a(T))for(y=u(e),m=i?new this(y):d(y);y>O;O++)b=v?p(e[O],O):e[O],l(m,O,b);else for(_=(C=h(e,T)).next,m=i?new this:[];!(I=s(_,C)).done;O++)b=v?r(C,p,[I.value,O],!0):I.value,l(m,O,b);return m.length=O,m}},1318:(t,e,i)=>{var n=i(5656),s=i(1400),o=i(6244),r=function(t){return function(e,i,r){var a,c=n(e),u=o(c),l=s(r,u);if(t&&i!=i){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===i)return t||l||0;return!t&&-1}};t.exports={includes:r(!0),indexOf:r(!1)}},2092:(t,e,i)=>{var n=i(9974),s=i(1702),o=i(8361),r=i(7908),a=i(6244),c=i(5417),u=s([].push),l=function(t){var e=1==t,i=2==t,s=3==t,l=4==t,h=6==t,g=7==t,d=5==t||h;return function(f,p,v,y){for(var m,I,C=r(f),_=o(C),b=n(p,v),T=a(_),O=0,E=y||c,k=e?E(f,T):i||g?E(f,0):void 0;T>O;O++)if((d||O in _)&&(I=b(m=_[O],O,C),t))if(e)k[O]=I;else if(I)switch(t){case 3:return!0;case 5:return m;case 6:return O;case 2:u(k,m)}else switch(t){case 4:return!1;case 7:u(k,m)}return h?-1:s||l?l:k}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},1194:(t,e,i)=>{var n=i(7293),s=i(5112),o=i(7392),r=s("species");t.exports=function(t){return o>=51||!n((function(){var e=[];return(e.constructor={})[r]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},1589:(t,e,i)=>{var n=i(1400),s=i(6244),o=i(6135),r=Array,a=Math.max;t.exports=function(t,e,i){for(var c=s(t),u=n(e,c),l=n(void 0===i?c:i,c),h=r(a(l-u,0)),g=0;u<l;u++,g++)o(h,g,t[u]);return h.length=g,h}},206:(t,e,i)=>{var n=i(1702);t.exports=n([].slice)},4362:(t,e,i)=>{var n=i(1589),s=Math.floor,o=function(t,e){var i=t.length,c=s(i/2);return i<8?r(t,e):a(t,o(n(t,0,c),e),o(n(t,c),e),e)},r=function(t,e){for(var i,n,s=t.length,o=1;o<s;){for(n=o,i=t[o];n&&e(t[n-1],i)>0;)t[n]=t[--n];n!==o++&&(t[n]=i)}return t},a=function(t,e,i,n){for(var s=e.length,o=i.length,r=0,a=0;r<s||a<o;)t[r+a]=r<s&&a<o?n(e[r],i[a])<=0?e[r++]:i[a++]:r<s?e[r++]:i[a++];return t};t.exports=o},7475:(t,e,i)=>{var n=i(3157),s=i(4411),o=i(111),r=i(5112)("species"),a=Array;t.exports=function(t){var e;return n(t)&&(e=t.constructor,(s(e)&&(e===a||n(e.prototype))||o(e)&&null===(e=e[r]))&&(e=void 0)),void 0===e?a:e}},5417:(t,e,i)=>{var n=i(7475);t.exports=function(t,e){return new(n(t))(0===e?0:e)}},3411:(t,e,i)=>{var n=i(9670),s=i(9212);t.exports=function(t,e,i,o){try{return o?e(n(i)[0],i[1]):e(i)}catch(e){s(t,"throw",e)}}},7072:(t,e,i)=>{var n=i(5112)("iterator"),s=!1;try{var o=0,r={next:function(){return{done:!!o++}},return:function(){s=!0}};r[n]=function(){return this},Array.from(r,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var o={};o[n]=function(){return{next:function(){return{done:i=!0}}}},t(o)}catch(t){}return i}},4326:(t,e,i)=>{var n=i(1702),s=n({}.toString),o=n("".slice);t.exports=function(t){return o(s(t),8,-1)}},648:(t,e,i)=>{var n=i(1694),s=i(614),o=i(4326),r=i(5112)("toStringTag"),a=Object,c="Arguments"==o(function(){return arguments}());t.exports=n?o:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=a(t),r))?i:c?o(e):"Object"==(n=o(e))&&s(e.callee)?"Arguments":n}},5631:(t,e,i)=>{"use strict";var n=i(30),s=i(7045),o=i(9190),r=i(9974),a=i(5787),c=i(8554),u=i(408),l=i(1656),h=i(6178),g=i(6340),d=i(9781),f=i(2423).fastKey,p=i(9909),v=p.set,y=p.getterFor;t.exports={getConstructor:function(t,e,i,l){var h=t((function(t,s){a(t,g),v(t,{type:e,index:n(null),first:void 0,last:void 0,size:0}),d||(t.size=0),c(s)||u(s,t[l],{that:t,AS_ENTRIES:i})})),g=h.prototype,p=y(e),m=function(t,e,i){var n,s,o=p(t),r=I(t,e);return r?r.value=i:(o.last=r={index:s=f(e,!0),key:e,value:i,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=r),n&&(n.next=r),d?o.size++:t.size++,"F"!==s&&(o.index[s]=r)),t},I=function(t,e){var i,n=p(t),s=f(e);if("F"!==s)return n.index[s];for(i=n.first;i;i=i.next)if(i.key==e)return i};return o(g,{clear:function(){for(var t=p(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,d?t.size=0:this.size=0},delete:function(t){var e=this,i=p(e),n=I(e,t);if(n){var s=n.next,o=n.previous;delete i.index[n.index],n.removed=!0,o&&(o.next=s),s&&(s.previous=o),i.first==n&&(i.first=s),i.last==n&&(i.last=o),d?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=p(this),n=r(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!I(this,t)}}),o(g,i?{get:function(t){var e=I(this,t);return e&&e.value},set:function(t,e){return m(this,0===t?0:t,e)}}:{add:function(t){return m(this,t=0===t?0:t,t)}}),d&&s(g,"size",{configurable:!0,get:function(){return p(this).size}}),h},setStrong:function(t,e,i){var n=e+" Iterator",s=y(e),o=y(n);l(t,e,(function(t,e){v(this,{type:n,target:t,state:s(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?h("keys"==e?i.key:"values"==e?i.value:[i.key,i.value],!1):(t.target=void 0,h(void 0,!0))}),i?"entries":"values",!i,!0),g(e)}}},7710:(t,e,i)=>{"use strict";var n=i(2109),s=i(7854),o=i(1702),r=i(4705),a=i(8052),c=i(2423),u=i(408),l=i(5787),h=i(614),g=i(8554),d=i(111),f=i(7293),p=i(7072),v=i(8003),y=i(9587);t.exports=function(t,e,i){var m=-1!==t.indexOf("Map"),I=-1!==t.indexOf("Weak"),C=m?"set":"add",_=s[t],b=_&&_.prototype,T=_,O={},E=function(t){var e=o(b[t]);a(b,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(I&&!d(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return I&&!d(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(I&&!d(t))&&e(this,0===t?0:t)}:function(t,i){return e(this,0===t?0:t,i),this})};if(r(t,!h(_)||!(I||b.forEach&&!f((function(){(new _).entries().next()})))))T=i.getConstructor(e,t,m,C),c.enable();else if(r(t,!0)){var k=new T,S=k[C](I?{}:-0,1)!=k,A=f((function(){k.has(1)})),R=p((function(t){new _(t)})),x=!I&&f((function(){for(var t=new _,e=5;e--;)t[C](e,e);return!t.has(-0)}));R||((T=e((function(t,e){l(t,b);var i=y(new _,t,T);return g(e)||u(e,i[C],{that:i,AS_ENTRIES:m}),i}))).prototype=b,b.constructor=T),(A||x)&&(E("delete"),E("has"),m&&E("get")),(x||S)&&E(C),I&&b.clear&&delete b.clear}return O[t]=T,n({global:!0,constructor:!0,forced:T!=_},O),v(T,t),I||i.setStrong(T,t,m),T}},9920:(t,e,i)=>{var n=i(2597),s=i(3887),o=i(1236),r=i(3070);t.exports=function(t,e,i){for(var a=s(e),c=r.f,u=o.f,l=0;l<a.length;l++){var h=a[l];n(t,h)||i&&n(i,h)||c(t,h,u(e,h))}}},4964:(t,e,i)=>{var n=i(5112)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,"/./"[t](e)}catch(t){}}return!1}},8544:(t,e,i)=>{var n=i(7293);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},6178:t=>{t.exports=function(t,e){return{value:t,done:e}}},8880:(t,e,i)=>{var n=i(9781),s=i(3070),o=i(9114);t.exports=n?function(t,e,i){return s.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},9114:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6135:(t,e,i)=>{"use strict";var n=i(4948),s=i(3070),o=i(9114);t.exports=function(t,e,i){var r=n(e);r in t?s.f(t,r,o(0,i)):t[r]=i}},7045:(t,e,i)=>{var n=i(6339),s=i(3070);t.exports=function(t,e,i){return i.get&&n(i.get,e,{getter:!0}),i.set&&n(i.set,e,{setter:!0}),s.f(t,e,i)}},8052:(t,e,i)=>{var n=i(614),s=i(3070),o=i(6339),r=i(3072);t.exports=function(t,e,i,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:e;if(n(i)&&o(i,u,a),a.global)c?t[e]=i:r(e,i);else{try{a.unsafe?t[e]&&(c=!0):delete t[e]}catch(t){}c?t[e]=i:s.f(t,e,{value:i,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},9190:(t,e,i)=>{var n=i(8052);t.exports=function(t,e,i){for(var s in e)n(t,s,e[s],i);return t}},3072:(t,e,i)=>{var n=i(7854),s=Object.defineProperty;t.exports=function(t,e){try{s(n,t,{value:e,configurable:!0,writable:!0})}catch(i){n[t]=e}return e}},9781:(t,e,i)=>{var n=i(7293);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:t=>{var e="object"==typeof document&&document.all,i=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:i}},317:(t,e,i)=>{var n=i(7854),s=i(111),o=n.document,r=s(o)&&s(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},7871:(t,e,i)=>{var n=i(3823),s=i(5268);t.exports=!n&&!s&&"object"==typeof window&&"object"==typeof document},3823:t=>{t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},1528:(t,e,i)=>{var n=i(8113);t.exports=/ipad|iphone|ipod/i.test(n)&&"undefined"!=typeof Pebble},6833:(t,e,i)=>{var n=i(8113);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},5268:(t,e,i)=>{var n=i(4326);t.exports="undefined"!=typeof process&&"process"==n(process)},1036:(t,e,i)=>{var n=i(8113);t.exports=/web0s(?!.*chrome)/i.test(n)},8113:t=>{t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:(t,e,i)=>{var n,s,o=i(7854),r=i(8113),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(s=(n=l.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!s&&r&&(!(n=r.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=r.match(/Chrome\/(\d+)/))&&(s=+n[1]),t.exports=s},748:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:(t,e,i)=>{var n=i(7854),s=i(1236).f,o=i(8880),r=i(8052),a=i(3072),c=i(9920),u=i(4705);t.exports=function(t,e){var i,l,h,g,d,f=t.target,p=t.global,v=t.stat;if(i=p?n:v?n[f]||a(f,{}):(n[f]||{}).prototype)for(l in e){if(g=e[l],h=t.dontCallGetSet?(d=s(i,l))&&d.value:i[l],!u(p?l:f+(v?".":"#")+l,t.forced)&&void 0!==h){if(typeof g==typeof h)continue;c(g,h)}(t.sham||h&&h.sham)&&o(g,"sham",!0),r(i,l,g,t)}}},7293:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},7007:(t,e,i)=>{"use strict";i(4916);var n=i(1470),s=i(8052),o=i(2261),r=i(7293),a=i(5112),c=i(8880),u=a("species"),l=RegExp.prototype;t.exports=function(t,e,i,h){var g=a(t),d=!r((function(){var e={};return e[g]=function(){return 7},7!=""[t](e)})),f=d&&!r((function(){var e=!1,i=/a/;return"split"===t&&((i={}).constructor={},i.constructor[u]=function(){return i},i.flags="",i[g]=/./[g]),i.exec=function(){return e=!0,null},i[g](""),!e}));if(!d||!f||i){var p=n(/./[g]),v=e(g,""[t],(function(t,e,i,s,r){var a=n(t),c=e.exec;return c===o||c===l.exec?d&&!r?{done:!0,value:p(e,i,s)}:{done:!0,value:a(i,e,s)}:{done:!1}}));s(String.prototype,t,v[0]),s(l,g,v[1])}h&&c(l[g],"sham",!0)}},6677:(t,e,i)=>{var n=i(7293);t.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},2104:(t,e,i)=>{var n=i(4374),s=Function.prototype,o=s.apply,r=s.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?r.bind(o):function(){return r.apply(o,arguments)})},9974:(t,e,i)=>{var n=i(1470),s=i(9662),o=i(4374),r=n(n.bind);t.exports=function(t,e){return s(t),void 0===e?t:o?r(t,e):function(){return t.apply(e,arguments)}}},4374:(t,e,i)=>{var n=i(7293);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:(t,e,i)=>{var n=i(4374),s=Function.prototype.call;t.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},6530:(t,e,i)=>{var n=i(9781),s=i(2597),o=Function.prototype,r=n&&Object.getOwnPropertyDescriptor,a=s(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!n||n&&r(o,"name").configurable);t.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},5668:(t,e,i)=>{var n=i(1702),s=i(9662);t.exports=function(t,e,i){try{return n(s(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}},1470:(t,e,i)=>{var n=i(4326),s=i(1702);t.exports=function(t){if("Function"===n(t))return s(t)}},1702:(t,e,i)=>{var n=i(4374),s=Function.prototype,o=s.call,r=n&&s.bind.bind(o,o);t.exports=n?r:function(t){return function(){return o.apply(t,arguments)}}},5005:(t,e,i)=>{var n=i(7854),s=i(614);t.exports=function(t,e){return arguments.length<2?(i=n[t],s(i)?i:void 0):n[t]&&n[t][e];var i}},1246:(t,e,i)=>{var n=i(648),s=i(8173),o=i(8554),r=i(7497),a=i(5112)("iterator");t.exports=function(t){if(!o(t))return s(t,a)||s(t,"@@iterator")||r[n(t)]}},4121:(t,e,i)=>{var n=i(6916),s=i(9662),o=i(9670),r=i(6330),a=i(1246),c=TypeError;t.exports=function(t,e){var i=arguments.length<2?a(t):e;if(s(i))return o(n(i,t));throw c(r(t)+" is not iterable")}},8173:(t,e,i)=>{var n=i(9662),s=i(8554);t.exports=function(t,e){var i=t[e];return s(i)?void 0:n(i)}},647:(t,e,i)=>{var n=i(1702),s=i(7908),o=Math.floor,r=n("".charAt),a=n("".replace),c=n("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,i,n,h,g){var d=i+t.length,f=n.length,p=l;return void 0!==h&&(h=s(h),p=u),a(g,p,(function(s,a){var u;switch(r(a,0)){case"$":return"$";case"&":return t;case"`":return c(e,0,i);case"'":return c(e,d);case"<":u=h[c(a,1,-1)];break;default:var l=+a;if(0===l)return s;if(l>f){var g=o(l/10);return 0===g?s:g<=f?void 0===n[g-1]?r(a,1):n[g-1]+r(a,1):s}u=n[l-1]}return void 0===u?"":u}))}},7854:t=>{var e=function(t){return t&&t.Math==Math&&t};t.exports=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof global&&global)||function(){return this}()||Function("return this")()},2597:(t,e,i)=>{var n=i(1702),s=i(7908),o=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(s(t),e)}},3501:t=>{t.exports={}},842:t=>{t.exports=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}}},490:(t,e,i)=>{var n=i(5005);t.exports=n("document","documentElement")},4664:(t,e,i)=>{var n=i(9781),s=i(7293),o=i(317);t.exports=!n&&!s((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},8361:(t,e,i)=>{var n=i(1702),s=i(7293),o=i(4326),r=Object,a=n("".split);t.exports=s((function(){return!r("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?a(t,""):r(t)}:r},9587:(t,e,i)=>{var n=i(614),s=i(111),o=i(7674);t.exports=function(t,e,i){var r,a;return o&&n(r=e.constructor)&&r!==i&&s(a=r.prototype)&&a!==i.prototype&&o(t,a),t}},2788:(t,e,i)=>{var n=i(1702),s=i(614),o=i(5465),r=n(Function.toString);s(o.inspectSource)||(o.inspectSource=function(t){return r(t)}),t.exports=o.inspectSource},2423:(t,e,i)=>{var n=i(2109),s=i(1702),o=i(3501),r=i(111),a=i(2597),c=i(3070).f,u=i(8006),l=i(1156),h=i(2050),g=i(9711),d=i(6677),f=!1,p=g("meta"),v=0,y=function(t){c(t,p,{value:{objectID:"O"+v++,weakData:{}}})},m=t.exports={enable:function(){m.enable=function(){},f=!0;var t=u.f,e=s([].splice),i={};i[p]=1,t(i).length&&(u.f=function(i){for(var n=t(i),s=0,o=n.length;s<o;s++)if(n[s]===p){e(n,s,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,p)){if(!h(t))return"F";if(!e)return"E";y(t)}return t[p].objectID},getWeakData:function(t,e){if(!a(t,p)){if(!h(t))return!0;if(!e)return!1;y(t)}return t[p].weakData},onFreeze:function(t){return d&&f&&h(t)&&!a(t,p)&&y(t),t}};o[p]=!0},9909:(t,e,i)=>{var n,s,o,r=i(4811),a=i(7854),c=i(111),u=i(8880),l=i(2597),h=i(5465),g=i(6200),d=i(3501),f="Object already initialized",p=a.TypeError,v=a.WeakMap;if(r||h.state){var y=h.state||(h.state=new v);y.get=y.get,y.has=y.has,y.set=y.set,n=function(t,e){if(y.has(t))throw p(f);return e.facade=t,y.set(t,e),e},s=function(t){return y.get(t)||{}},o=function(t){return y.has(t)}}else{var m=g("state");d[m]=!0,n=function(t,e){if(l(t,m))throw p(f);return e.facade=t,u(t,m,e),e},s=function(t){return l(t,m)?t[m]:{}},o=function(t){return l(t,m)}}t.exports={set:n,get:s,has:o,enforce:function(t){return o(t)?s(t):n(t,{})},getterFor:function(t){return function(e){var i;if(!c(e)||(i=s(e)).type!==t)throw p("Incompatible receiver, "+t+" required");return i}}}},7659:(t,e,i)=>{var n=i(5112),s=i(7497),o=n("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(s.Array===t||r[o]===t)}},3157:(t,e,i)=>{var n=i(4326);t.exports=Array.isArray||function(t){return"Array"==n(t)}},614:(t,e,i)=>{var n=i(4154),s=n.all;t.exports=n.IS_HTMLDDA?function(t){return"function"==typeof t||t===s}:function(t){return"function"==typeof t}},4411:(t,e,i)=>{var n=i(1702),s=i(7293),o=i(614),r=i(648),a=i(5005),c=i(2788),u=function(){},l=[],h=a("Reflect","construct"),g=/^\s*(?:class|function)\b/,d=n(g.exec),f=!g.exec(u),p=function(t){if(!o(t))return!1;try{return h(u,l,t),!0}catch(t){return!1}},v=function(t){if(!o(t))return!1;switch(r(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(g,c(t))}catch(t){return!0}};v.sham=!0,t.exports=!h||s((function(){var t;return p(p.call)||!p(Object)||!p((function(){t=!0}))||t}))?v:p},4705:(t,e,i)=>{var n=i(7293),s=i(614),o=/#|\.prototype\./,r=function(t,e){var i=c[a(t)];return i==l||i!=u&&(s(e)?n(e):!!e)},a=r.normalize=function(t){return String(t).replace(o,".").toLowerCase()},c=r.data={},u=r.NATIVE="N",l=r.POLYFILL="P";t.exports=r},8554:t=>{t.exports=function(t){return null==t}},111:(t,e,i)=>{var n=i(614),s=i(4154),o=s.all;t.exports=s.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:n(t)||t===o}:function(t){return"object"==typeof t?null!==t:n(t)}},1913:t=>{t.exports=!1},7850:(t,e,i)=>{var n=i(111),s=i(4326),o=i(5112)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==s(t))}},2190:(t,e,i)=>{var n=i(5005),s=i(614),o=i(7976),r=i(3307),a=Object;t.exports=r?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return s(e)&&o(e.prototype,a(t))}},408:(t,e,i)=>{var n=i(9974),s=i(6916),o=i(9670),r=i(6330),a=i(7659),c=i(6244),u=i(7976),l=i(4121),h=i(1246),g=i(9212),d=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,i){var v,y,m,I,C,_,b,T=i&&i.that,O=!(!i||!i.AS_ENTRIES),E=!(!i||!i.IS_RECORD),k=!(!i||!i.IS_ITERATOR),S=!(!i||!i.INTERRUPTED),A=n(e,T),R=function(t){return v&&g(v,"normal",t),new f(!0,t)},x=function(t){return O?(o(t),S?A(t[0],t[1],R):A(t[0],t[1])):S?A(t,R):A(t)};if(E)v=t.iterator;else if(k)v=t;else{if(!(y=h(t)))throw d(r(t)+" is not iterable");if(a(y)){for(m=0,I=c(t);I>m;m++)if((C=x(t[m]))&&u(p,C))return C;return new f(!1)}v=l(t,y)}for(_=E?t.next:v.next;!(b=s(_,v)).done;){try{C=x(b.value)}catch(t){g(v,"throw",t)}if("object"==typeof C&&C&&u(p,C))return C}return new f(!1)}},9212:(t,e,i)=>{var n=i(6916),s=i(9670),o=i(8173);t.exports=function(t,e,i){var r,a;s(t);try{if(!(r=o(t,"return"))){if("throw"===e)throw i;return i}r=n(r,t)}catch(t){a=!0,r=t}if("throw"===e)throw i;if(a)throw r;return s(r),i}},3061:(t,e,i)=>{"use strict";var n=i(3383).IteratorPrototype,s=i(30),o=i(9114),r=i(8003),a=i(7497),c=function(){return this};t.exports=function(t,e,i,u){var l=e+" Iterator";return t.prototype=s(n,{next:o(+!u,i)}),r(t,l,!1,!0),a[l]=c,t}},1656:(t,e,i)=>{"use strict";var n=i(2109),s=i(6916),o=i(1913),r=i(6530),a=i(614),c=i(3061),u=i(9518),l=i(7674),h=i(8003),g=i(8880),d=i(8052),f=i(5112),p=i(7497),v=i(3383),y=r.PROPER,m=r.CONFIGURABLE,I=v.IteratorPrototype,C=v.BUGGY_SAFARI_ITERATORS,_=f("iterator"),b="keys",T="values",O="entries",E=function(){return this};t.exports=function(t,e,i,r,f,v,k){c(i,e,r);var S,A,R,x=function(t){if(t===f&&P)return P;if(!C&&t in w)return w[t];switch(t){case b:case T:case O:return function(){return new i(this,t)}}return function(){return new i(this)}},D=e+" Iterator",N=!1,w=t.prototype,M=w[_]||w["@@iterator"]||f&&w[f],P=!C&&M||x(f),F="Array"==e&&w.entries||M;if(F&&(S=u(F.call(new t)))!==Object.prototype&&S.next&&(o||u(S)===I||(l?l(S,I):a(S[_])||d(S,_,E)),h(S,D,!0,!0),o&&(p[D]=E)),y&&f==T&&M&&M.name!==T&&(!o&&m?g(w,"name",T):(N=!0,P=function(){return s(M,this)})),f)if(A={values:x(T),keys:v?P:x(b),entries:x(O)},k)for(R in A)(C||N||!(R in w))&&d(w,R,A[R]);else n({target:e,proto:!0,forced:C||N},A);return o&&!k||w[_]===P||d(w,_,P,{name:f}),p[e]=P,A}},3383:(t,e,i)=>{"use strict";var n,s,o,r=i(7293),a=i(614),c=i(111),u=i(30),l=i(9518),h=i(8052),g=i(5112),d=i(1913),f=g("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(s=l(l(o)))!==Object.prototype&&(n=s):p=!0),!c(n)||r((function(){var t={};return n[f].call(t)!==t}))?n={}:d&&(n=u(n)),a(n[f])||h(n,f,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:p}},7497:t=>{t.exports={}},6244:(t,e,i)=>{var n=i(7466);t.exports=function(t){return n(t.length)}},6339:(t,e,i)=>{var n=i(1702),s=i(7293),o=i(614),r=i(2597),a=i(9781),c=i(6530).CONFIGURABLE,u=i(2788),l=i(9909),h=l.enforce,g=l.get,d=String,f=Object.defineProperty,p=n("".slice),v=n("".replace),y=n([].join),m=a&&!s((function(){return 8!==f((function(){}),"length",{value:8}).length})),I=String(String).split("String"),C=t.exports=function(t,e,i){"Symbol("===p(d(e),0,7)&&(e="["+v(d(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!r(t,"name")||c&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),m&&i&&r(i,"arity")&&t.length!==i.arity&&f(t,"length",{value:i.arity});try{i&&r(i,"constructor")&&i.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=h(t);return r(n,"source")||(n.source=y(I,"string"==typeof e?e:"")),t};Function.prototype.toString=C((function(){return o(this)&&g(this).source||u(this)}),"toString")},4758:t=>{var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?i:e)(n)}},5948:(t,e,i)=>{var n,s,o,r,a,c=i(7854),u=i(9974),l=i(1236).f,h=i(261).set,g=i(8572),d=i(6833),f=i(1528),p=i(1036),v=i(5268),y=c.MutationObserver||c.WebKitMutationObserver,m=c.document,I=c.process,C=c.Promise,_=l(c,"queueMicrotask"),b=_&&_.value;if(!b){var T=new g,O=function(){var t,e;for(v&&(t=I.domain)&&t.exit();e=T.get();)try{e()}catch(t){throw T.head&&n(),t}t&&t.enter()};d||v||p||!y||!m?!f&&C&&C.resolve?((r=C.resolve(void 0)).constructor=C,a=u(r.then,r),n=function(){a(O)}):v?n=function(){I.nextTick(O)}:(h=u(h,c),n=function(){h(O)}):(s=!0,o=m.createTextNode(""),new y(O).observe(o,{characterData:!0}),n=function(){o.data=s=!s}),b=function(t){T.head||n(),T.add(t)}}t.exports=b},8523:(t,e,i)=>{"use strict";var n=i(9662),s=TypeError,o=function(t){var e,i;this.promise=new t((function(t,n){if(void 0!==e||void 0!==i)throw s("Bad Promise constructor");e=t,i=n})),this.resolve=n(e),this.reject=n(i)};t.exports.f=function(t){return new o(t)}},3929:(t,e,i)=>{var n=i(7850),s=TypeError;t.exports=function(t){if(n(t))throw s("The method doesn't accept regular expressions");return t}},30:(t,e,i)=>{var n,s=i(9670),o=i(6048),r=i(748),a=i(3501),c=i(490),u=i(317),l=i(6200),h="prototype",g="script",d=l("IE_PROTO"),f=function(){},p=function(t){return"<"+g+">"+t+"</"+g+">"},v=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){try{n=new ActiveXObject("htmlfile")}catch(t){}var t,e,i;y="undefined"!=typeof document?document.domain&&n?v(n):(e=u("iframe"),i="java"+g+":",e.style.display="none",c.appendChild(e),e.src=String(i),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):v(n);for(var s=r.length;s--;)delete y[h][r[s]];return y()};a[d]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(f[h]=s(t),i=new f,f[h]=null,i[d]=t):i=y(),void 0===e?i:o.f(i,e)}},6048:(t,e,i)=>{var n=i(9781),s=i(3353),o=i(3070),r=i(9670),a=i(5656),c=i(1956);e.f=n&&!s?Object.defineProperties:function(t,e){r(t);for(var i,n=a(e),s=c(e),u=s.length,l=0;u>l;)o.f(t,i=s[l++],n[i]);return t}},3070:(t,e,i)=>{var n=i(9781),s=i(4664),o=i(3353),r=i(9670),a=i(4948),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,h="enumerable",g="configurable",d="writable";e.f=n?o?function(t,e,i){if(r(t),e=a(e),r(i),"function"==typeof t&&"prototype"===e&&"value"in i&&d in i&&!i[d]){var n=l(t,e);n&&n[d]&&(t[e]=i.value,i={configurable:g in i?i[g]:n[g],enumerable:h in i?i[h]:n[h],writable:!1})}return u(t,e,i)}:u:function(t,e,i){if(r(t),e=a(e),r(i),s)try{return u(t,e,i)}catch(t){}if("get"in i||"set"in i)throw c("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},1236:(t,e,i)=>{var n=i(9781),s=i(6916),o=i(5296),r=i(9114),a=i(5656),c=i(4948),u=i(2597),l=i(4664),h=Object.getOwnPropertyDescriptor;e.f=n?h:function(t,e){if(t=a(t),e=c(e),l)try{return h(t,e)}catch(t){}if(u(t,e))return r(!s(o.f,t,e),t[e])}},1156:(t,e,i)=>{var n=i(4326),s=i(5656),o=i(8006).f,r=i(1589),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"Window"==n(t)?function(t){try{return o(t)}catch(t){return r(a)}}(t):o(s(t))}},8006:(t,e,i)=>{var n=i(6324),s=i(748).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},5181:(t,e)=>{e.f=Object.getOwnPropertySymbols},9518:(t,e,i)=>{var n=i(2597),s=i(614),o=i(7908),r=i(6200),a=i(8544),c=r("IE_PROTO"),u=Object,l=u.prototype;t.exports=a?u.getPrototypeOf:function(t){var e=o(t);if(n(e,c))return e[c];var i=e.constructor;return s(i)&&e instanceof i?i.prototype:e instanceof u?l:null}},2050:(t,e,i)=>{var n=i(7293),s=i(111),o=i(4326),r=i(7556),a=Object.isExtensible,c=n((function(){a(1)}));t.exports=c||r?function(t){return!!s(t)&&(!r||"ArrayBuffer"!=o(t))&&(!a||a(t))}:a},7976:(t,e,i)=>{var n=i(1702);t.exports=n({}.isPrototypeOf)},6324:(t,e,i)=>{var n=i(1702),s=i(2597),o=i(5656),r=i(1318).indexOf,a=i(3501),c=n([].push);t.exports=function(t,e){var i,n=o(t),u=0,l=[];for(i in n)!s(a,i)&&s(n,i)&&c(l,i);for(;e.length>u;)s(n,i=e[u++])&&(~r(l,i)||c(l,i));return l}},1956:(t,e,i)=>{var n=i(6324),s=i(748);t.exports=Object.keys||function(t){return n(t,s)}},5296:(t,e)=>{"use strict";var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!i.call({1:2},1);e.f=s?function(t){var e=n(this,t);return!!e&&e.enumerable}:i},7674:(t,e,i)=>{var n=i(5668),s=i(9670),o=i(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=n(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return s(i),o(n),e?t(i,n):i.__proto__=n,i}}():void 0)},4699:(t,e,i)=>{var n=i(9781),s=i(1702),o=i(1956),r=i(5656),a=s(i(5296).f),c=s([].push),u=function(t){return function(e){for(var i,s=r(e),u=o(s),l=u.length,h=0,g=[];l>h;)i=u[h++],n&&!a(s,i)||c(g,t?[i,s[i]]:s[i]);return g}};t.exports={entries:u(!0),values:u(!1)}},2140:(t,e,i)=>{var n=i(6916),s=i(614),o=i(111),r=TypeError;t.exports=function(t,e){var i,a;if("string"===e&&s(i=t.toString)&&!o(a=n(i,t)))return a;if(s(i=t.valueOf)&&!o(a=n(i,t)))return a;if("string"!==e&&s(i=t.toString)&&!o(a=n(i,t)))return a;throw r("Can't convert object to primitive value")}},3887:(t,e,i)=>{var n=i(5005),s=i(1702),o=i(8006),r=i(5181),a=i(9670),c=s([].concat);t.exports=n("Reflect","ownKeys")||function(t){var e=o.f(a(t)),i=r.f;return i?c(e,i(t)):e}},2534:t=>{t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},3702:(t,e,i)=>{var n=i(7854),s=i(2492),o=i(614),r=i(4705),a=i(2788),c=i(5112),u=i(7871),l=i(3823),h=i(1913),g=i(7392),d=s&&s.prototype,f=c("species"),p=!1,v=o(n.PromiseRejectionEvent),y=r("Promise",(function(){var t=a(s),e=t!==String(s);if(!e&&66===g)return!0;if(h&&(!d.catch||!d.finally))return!0;if(!g||g<51||!/native code/.test(t)){var i=new s((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((i.constructor={})[f]=n,!(p=i.then((function(){}))instanceof n))return!0}return!e&&(u||l)&&!v}));t.exports={CONSTRUCTOR:y,REJECTION_EVENT:v,SUBCLASSING:p}},2492:(t,e,i)=>{var n=i(7854);t.exports=n.Promise},9478:(t,e,i)=>{var n=i(9670),s=i(111),o=i(8523);t.exports=function(t,e){if(n(t),s(e)&&e.constructor===t)return e;var i=o.f(t);return(0,i.resolve)(e),i.promise}},612:(t,e,i)=>{var n=i(2492),s=i(7072),o=i(3702).CONSTRUCTOR;t.exports=o||!s((function(t){n.all(t).then(void 0,(function(){}))}))},2626:(t,e,i)=>{var n=i(3070).f;t.exports=function(t,e,i){i in t||n(t,i,{configurable:!0,get:function(){return e[i]},set:function(t){e[i]=t}})}},8572:t=>{var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},i=this.tail;i?i.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},7651:(t,e,i)=>{var n=i(6916),s=i(9670),o=i(614),r=i(4326),a=i(2261),c=TypeError;t.exports=function(t,e){var i=t.exec;if(o(i)){var u=n(i,t,e);return null!==u&&s(u),u}if("RegExp"===r(t))return n(a,t,e);throw c("RegExp#exec called on incompatible receiver")}},2261:(t,e,i)=>{"use strict";var n,s,o=i(6916),r=i(1702),a=i(1340),c=i(7066),u=i(2999),l=i(2309),h=i(30),g=i(9909).get,d=i(9441),f=i(7168),p=l("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,y=v,m=r("".charAt),I=r("".indexOf),C=r("".replace),_=r("".slice),b=(s=/b*/g,o(v,n=/a/,"a"),o(v,s,"a"),0!==n.lastIndex||0!==s.lastIndex),T=u.BROKEN_CARET,O=void 0!==/()??/.exec("")[1];(b||O||T||d||f)&&(y=function(t){var e,i,n,s,r,u,l,d=this,f=g(d),E=a(t),k=f.raw;if(k)return k.lastIndex=d.lastIndex,e=o(y,k,E),d.lastIndex=k.lastIndex,e;var S=f.groups,A=T&&d.sticky,R=o(c,d),x=d.source,D=0,N=E;if(A&&(R=C(R,"y",""),-1===I(R,"g")&&(R+="g"),N=_(E,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==m(E,d.lastIndex-1))&&(x="(?: "+x+")",N=" "+N,D++),i=new RegExp("^(?:"+x+")",R)),O&&(i=new RegExp("^"+x+"$(?!\\s)",R)),b&&(n=d.lastIndex),s=o(v,A?i:d,N),A?s?(s.input=_(s.input,D),s[0]=_(s[0],D),s.index=d.lastIndex,d.lastIndex+=s[0].length):d.lastIndex=0:b&&s&&(d.lastIndex=d.global?s.index+s[0].length:n),O&&s&&s.length>1&&o(p,s[0],i,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(s[r]=void 0)})),s&&S)for(s.groups=u=h(null),r=0;r<S.length;r++)u[(l=S[r])[0]]=s[l[1]];return s}),t.exports=y},7066:(t,e,i)=>{"use strict";var n=i(9670);t.exports=function(){var t=n(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},4706:(t,e,i)=>{var n=i(6916),s=i(2597),o=i(7976),r=i(7066),a=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in a||s(t,"flags")||!o(a,t)?e:n(r,t)}},2999:(t,e,i)=>{var n=i(7293),s=i(7854).RegExp,o=n((function(){var t=s("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),r=o||n((function(){return!s("a","y").sticky})),a=o||n((function(){var t=s("^r","gy");return t.lastIndex=2,null!=t.exec("str")}));t.exports={BROKEN_CARET:a,MISSED_STICKY:r,UNSUPPORTED_Y:o}},9441:(t,e,i)=>{var n=i(7293),s=i(7854).RegExp;t.exports=n((function(){var t=s(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))},7168:(t,e,i)=>{var n=i(7293),s=i(7854).RegExp;t.exports=n((function(){var t=s("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},4488:(t,e,i)=>{var n=i(8554),s=TypeError;t.exports=function(t){if(n(t))throw s("Can't call method on "+t);return t}},1150:t=>{t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},6340:(t,e,i)=>{"use strict";var n=i(5005),s=i(7045),o=i(5112),r=i(9781),a=o("species");t.exports=function(t){var e=n(t);r&&e&&!e[a]&&s(e,a,{configurable:!0,get:function(){return this}})}},8003:(t,e,i)=>{var n=i(3070).f,s=i(2597),o=i(5112)("toStringTag");t.exports=function(t,e,i){t&&!i&&(t=t.prototype),t&&!s(t,o)&&n(t,o,{configurable:!0,value:e})}},6200:(t,e,i)=>{var n=i(2309),s=i(9711),o=n("keys");t.exports=function(t){return o[t]||(o[t]=s(t))}},5465:(t,e,i)=>{var n=i(7854),s=i(3072),o="__core-js_shared__",r=n[o]||s(o,{});t.exports=r},2309:(t,e,i)=>{var n=i(1913),s=i(5465);(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.30.1",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6707:(t,e,i)=>{var n=i(9670),s=i(9483),o=i(8554),r=i(5112)("species");t.exports=function(t,e){var i,a=n(t).constructor;return void 0===a||o(i=n(a)[r])?e:s(i)}},8710:(t,e,i)=>{var n=i(1702),s=i(9303),o=i(1340),r=i(4488),a=n("".charAt),c=n("".charCodeAt),u=n("".slice),l=function(t){return function(e,i){var n,l,h=o(r(e)),g=s(i),d=h.length;return g<0||g>=d?t?"":void 0:(n=c(h,g))<55296||n>56319||g+1===d||(l=c(h,g+1))<56320||l>57343?t?a(h,g):n:t?u(h,g,g+2):l-56320+(n-55296<<10)+65536}};t.exports={codeAt:l(!1),charAt:l(!0)}},6293:(t,e,i)=>{var n=i(7392),s=i(7293);t.exports=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},261:(t,e,i)=>{var n,s,o,r,a=i(7854),c=i(2104),u=i(9974),l=i(614),h=i(2597),g=i(7293),d=i(490),f=i(206),p=i(317),v=i(8053),y=i(6833),m=i(5268),I=a.setImmediate,C=a.clearImmediate,_=a.process,b=a.Dispatch,T=a.Function,O=a.MessageChannel,E=a.String,k=0,S={},A="onreadystatechange";g((function(){n=a.location}));var R=function(t){if(h(S,t)){var e=S[t];delete S[t],e()}},x=function(t){return function(){R(t)}},D=function(t){R(t.data)},N=function(t){a.postMessage(E(t),n.protocol+"//"+n.host)};I&&C||(I=function(t){v(arguments.length,1);var e=l(t)?t:T(t),i=f(arguments,1);return S[++k]=function(){c(e,void 0,i)},s(k),k},C=function(t){delete S[t]},m?s=function(t){_.nextTick(x(t))}:b&&b.now?s=function(t){b.now(x(t))}:O&&!y?(r=(o=new O).port2,o.port1.onmessage=D,s=u(r.postMessage,r)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&n&&"file:"!==n.protocol&&!g(N)?(s=N,a.addEventListener("message",D,!1)):s=A in p("script")?function(t){d.appendChild(p("script"))[A]=function(){d.removeChild(this),R(t)}}:function(t){setTimeout(x(t),0)}),t.exports={set:I,clear:C}},1400:(t,e,i)=>{var n=i(9303),s=Math.max,o=Math.min;t.exports=function(t,e){var i=n(t);return i<0?s(i+e,0):o(i,e)}},5656:(t,e,i)=>{var n=i(8361),s=i(4488);t.exports=function(t){return n(s(t))}},9303:(t,e,i)=>{var n=i(4758);t.exports=function(t){var e=+t;return e!=e||0===e?0:n(e)}},7466:(t,e,i)=>{var n=i(9303),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},7908:(t,e,i)=>{var n=i(4488),s=Object;t.exports=function(t){return s(n(t))}},7593:(t,e,i)=>{var n=i(6916),s=i(111),o=i(2190),r=i(8173),a=i(2140),c=i(5112),u=TypeError,l=c("toPrimitive");t.exports=function(t,e){if(!s(t)||o(t))return t;var i,c=r(t,l);if(c){if(void 0===e&&(e="default"),i=n(c,t,e),!s(i)||o(i))return i;throw u("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},4948:(t,e,i)=>{var n=i(7593),s=i(2190);t.exports=function(t){var e=n(t,"string");return s(e)?e:e+""}},1694:(t,e,i)=>{var n={};n[i(5112)("toStringTag")]="z",t.exports="[object z]"===String(n)},1340:(t,e,i)=>{var n=i(648),s=String;t.exports=function(t){if("Symbol"===n(t))throw TypeError("Cannot convert a Symbol value to a string");return s(t)}},6330:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},9711:(t,e,i)=>{var n=i(1702),s=0,o=Math.random(),r=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+r(++s+o,36)}},5143:(t,e,i)=>{var n=i(7293),s=i(5112),o=i(9781),r=i(1913),a=s("iterator");t.exports=!n((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,i="";return t.pathname="c%20d",e.forEach((function(t,n){e.delete("b"),i+=n+t})),r&&!t.toJSON||!e.size&&(r||!o)||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==i||"x"!==new URL("http://x",void 0).host}))},3307:(t,e,i)=>{var n=i(6293);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(t,e,i)=>{var n=i(9781),s=i(7293);t.exports=n&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8053:t=>{var e=TypeError;t.exports=function(t,i){if(t<i)throw e("Not enough arguments");return t}},4811:(t,e,i)=>{var n=i(7854),s=i(614),o=n.WeakMap;t.exports=s(o)&&/native code/.test(String(o))},5112:(t,e,i)=>{var n=i(7854),s=i(2309),o=i(2597),r=i(9711),a=i(6293),c=i(3307),u=n.Symbol,l=s("wks"),h=c?u.for||u:u&&u.withoutSetter||r;t.exports=function(t){return o(l,t)||(l[t]=a&&o(u,t)?u[t]:h("Symbol."+t)),l[t]}},7327:(t,e,i)=>{"use strict";var n=i(2109),s=i(2092).filter;n({target:"Array",proto:!0,forced:!i(1194)("filter")},{filter:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},1038:(t,e,i)=>{var n=i(2109),s=i(8457);n({target:"Array",stat:!0,forced:!i(7072)((function(t){Array.from(t)}))},{from:s})},6699:(t,e,i)=>{"use strict";var n=i(2109),s=i(1318).includes,o=i(7293),r=i(1223);n({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},6992:(t,e,i)=>{"use strict";var n=i(5656),s=i(1223),o=i(7497),r=i(9909),a=i(3070).f,c=i(1656),u=i(6178),l=i(1913),h=i(9781),g="Array Iterator",d=r.set,f=r.getterFor(g);t.exports=c(Array,"Array",(function(t,e){d(this,{type:g,target:n(t),index:0,kind:e})}),(function(){var t=f(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,u(void 0,!0)):u("keys"==i?n:"values"==i?e[n]:[n,e[n]],!1)}),"values");var p=o.Arguments=o.Array;if(s("keys"),s("values"),s("entries"),!l&&h&&"values"!==p.name)try{a(p,"name",{value:"values"})}catch(t){}},1249:(t,e,i)=>{"use strict";var n=i(2109),s=i(2092).map;n({target:"Array",proto:!0,forced:!i(1194)("map")},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},7042:(t,e,i)=>{"use strict";var n=i(2109),s=i(3157),o=i(4411),r=i(111),a=i(1400),c=i(6244),u=i(5656),l=i(6135),h=i(5112),g=i(1194),d=i(206),f=g("slice"),p=h("species"),v=Array,y=Math.max;n({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var i,n,h,g=u(this),f=c(g),m=a(t,f),I=a(void 0===e?f:e,f);if(s(g)&&(i=g.constructor,(o(i)&&(i===v||s(i.prototype))||r(i)&&null===(i=i[p]))&&(i=void 0),i===v||void 0===i))return d(g,m,I);for(n=new(void 0===i?v:i)(y(I-m,0)),h=0;m<I;m++,h++)m in g&&l(n,h,g[m]);return n.length=h,n}})},9098:(t,e,i)=>{"use strict";i(7710)("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i(5631))},1532:(t,e,i)=>{i(9098)},9720:(t,e,i)=>{var n=i(2109),s=i(4699).entries;n({target:"Object",stat:!0},{entries:function(t){return s(t)}})},9337:(t,e,i)=>{var n=i(2109),s=i(9781),o=i(3887),r=i(5656),a=i(1236),c=i(6135);n({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(t){for(var e,i,n=r(t),s=a.f,u=o(n),l={},h=0;u.length>h;)void 0!==(i=s(n,e=u[h++]))&&c(l,e,i);return l}})},2479:(t,e,i)=>{var n=i(2109),s=i(4699).values;n({target:"Object",stat:!0},{values:function(t){return s(t)}})},821:(t,e,i)=>{"use strict";var n=i(2109),s=i(6916),o=i(9662),r=i(8523),a=i(2534),c=i(408);n({target:"Promise",stat:!0,forced:i(612)},{all:function(t){var e=this,i=r.f(e),n=i.resolve,u=i.reject,l=a((function(){var i=o(e.resolve),r=[],a=0,l=1;c(t,(function(t){var o=a++,c=!1;l++,s(i,e,t).then((function(t){c||(c=!0,r[o]=t,--l||n(r))}),u)})),--l||n(r)}));return l.error&&u(l.value),i.promise}})},4164:(t,e,i)=>{"use strict";var n=i(2109),s=i(1913),o=i(3702).CONSTRUCTOR,r=i(2492),a=i(5005),c=i(614),u=i(8052),l=r&&r.prototype;if(n({target:"Promise",proto:!0,forced:o,real:!0},{catch:function(t){return this.then(void 0,t)}}),!s&&c(r)){var h=a("Promise").prototype.catch;l.catch!==h&&u(l,"catch",h,{unsafe:!0})}},3401:(t,e,i)=>{"use strict";var n,s,o,r=i(2109),a=i(1913),c=i(5268),u=i(7854),l=i(6916),h=i(8052),g=i(7674),d=i(8003),f=i(6340),p=i(9662),v=i(614),y=i(111),m=i(5787),I=i(6707),C=i(261).set,_=i(5948),b=i(842),T=i(2534),O=i(8572),E=i(9909),k=i(2492),S=i(3702),A=i(8523),R="Promise",x=S.CONSTRUCTOR,D=S.REJECTION_EVENT,N=S.SUBCLASSING,w=E.getterFor(R),M=E.set,P=k&&k.prototype,F=k,H=P,j=u.TypeError,V=u.document,U=u.process,L=A.f,B=L,G=!!(V&&V.createEvent&&u.dispatchEvent),q="unhandledrejection",K=function(t){var e;return!(!y(t)||!v(e=t.then))&&e},Q=function(t,e){var i,n,s,o=e.value,r=1==e.state,a=r?t.ok:t.fail,c=t.resolve,u=t.reject,h=t.domain;try{a?(r||(2===e.rejection&&Y(e),e.rejection=1),!0===a?i=o:(h&&h.enter(),i=a(o),h&&(h.exit(),s=!0)),i===t.promise?u(j("Promise-chain cycle")):(n=K(i))?l(n,i,c,u):c(i)):u(o)}catch(t){h&&!s&&h.exit(),u(t)}},$=function(t,e){t.notified||(t.notified=!0,_((function(){for(var i,n=t.reactions;i=n.get();)Q(i,t);t.notified=!1,e&&!t.rejection&&J(t)})))},z=function(t,e,i){var n,s;G?((n=V.createEvent("Event")).promise=e,n.reason=i,n.initEvent(t,!1,!0),u.dispatchEvent(n)):n={promise:e,reason:i},!D&&(s=u["on"+t])?s(n):t===q&&b("Unhandled promise rejection",i)},J=function(t){l(C,u,(function(){var e,i=t.facade,n=t.value;if(W(t)&&(e=T((function(){c?U.emit("unhandledRejection",n,i):z(q,i,n)})),t.rejection=c||W(t)?2:1,e.error))throw e.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){l(C,u,(function(){var e=t.facade;c?U.emit("rejectionHandled",e):z("rejectionhandled",e,t.value)}))},Z=function(t,e,i){return function(n){t(e,n,i)}},X=function(t,e,i){t.done||(t.done=!0,i&&(t=i),t.value=e,t.state=2,$(t,!0))},tt=function(t,e,i){if(!t.done){t.done=!0,i&&(t=i);try{if(t.facade===e)throw j("Promise can't be resolved itself");var n=K(e);n?_((function(){var i={done:!1};try{l(n,e,Z(tt,i,t),Z(X,i,t))}catch(e){X(i,e,t)}})):(t.value=e,t.state=1,$(t,!1))}catch(e){X({done:!1},e,t)}}};if(x&&(H=(F=function(t){m(this,H),p(t),l(n,this);var e=w(this);try{t(Z(tt,e),Z(X,e))}catch(t){X(e,t)}}).prototype,(n=function(t){M(this,{type:R,done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=h(H,"then",(function(t,e){var i=w(this),n=L(I(this,F));return i.parent=!0,n.ok=!v(t)||t,n.fail=v(e)&&e,n.domain=c?U.domain:void 0,0==i.state?i.reactions.add(n):_((function(){Q(n,i)})),n.promise})),s=function(){var t=new n,e=w(t);this.promise=t,this.resolve=Z(tt,e),this.reject=Z(X,e)},A.f=L=function(t){return t===F||void 0===t?new s(t):B(t)},!a&&v(k)&&P!==Object.prototype)){o=P.then,N||h(P,"then",(function(t,e){var i=this;return new F((function(t,e){l(o,i,t,e)})).then(t,e)}),{unsafe:!0});try{delete P.constructor}catch(t){}g&&g(P,H)}r({global:!0,constructor:!0,wrap:!0,forced:x},{Promise:F}),d(F,R,!1,!0),f(R)},8674:(t,e,i)=>{i(3401),i(821),i(4164),i(6027),i(683),i(6294)},6027:(t,e,i)=>{"use strict";var n=i(2109),s=i(6916),o=i(9662),r=i(8523),a=i(2534),c=i(408);n({target:"Promise",stat:!0,forced:i(612)},{race:function(t){var e=this,i=r.f(e),n=i.reject,u=a((function(){var r=o(e.resolve);c(t,(function(t){s(r,e,t).then(i.resolve,n)}))}));return u.error&&n(u.value),i.promise}})},683:(t,e,i)=>{"use strict";var n=i(2109),s=i(6916),o=i(8523);n({target:"Promise",stat:!0,forced:i(3702).CONSTRUCTOR},{reject:function(t){var e=o.f(this);return s(e.reject,void 0,t),e.promise}})},6294:(t,e,i)=>{"use strict";var n=i(2109),s=i(5005),o=i(1913),r=i(2492),a=i(3702).CONSTRUCTOR,c=i(9478),u=s("Promise"),l=o&&!a;n({target:"Promise",stat:!0,forced:o||a},{resolve:function(t){return c(l&&this===u?r:this,t)}})},4603:(t,e,i)=>{var n=i(9781),s=i(7854),o=i(1702),r=i(4705),a=i(9587),c=i(8880),u=i(8006).f,l=i(7976),h=i(7850),g=i(1340),d=i(4706),f=i(2999),p=i(2626),v=i(8052),y=i(7293),m=i(2597),I=i(9909).enforce,C=i(6340),_=i(5112),b=i(9441),T=i(7168),O=_("match"),E=s.RegExp,k=E.prototype,S=s.SyntaxError,A=o(k.exec),R=o("".charAt),x=o("".replace),D=o("".indexOf),N=o("".slice),w=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,M=/a/g,P=/a/g,F=new E(M)!==M,H=f.MISSED_STICKY,j=f.UNSUPPORTED_Y;if(r("RegExp",n&&(!F||H||b||T||y((function(){return P[O]=!1,E(M)!=M||E(P)==P||"/a/i"!=E(M,"i")}))))){for(var V=function(t,e){var i,n,s,o,r,u,f=l(k,this),p=h(t),v=void 0===e,y=[],C=t;if(!f&&p&&v&&t.constructor===V)return t;if((p||l(k,t))&&(t=t.source,v&&(e=d(C))),t=void 0===t?"":g(t),e=void 0===e?"":g(e),C=t,b&&"dotAll"in M&&(n=!!e&&D(e,"s")>-1)&&(e=x(e,/s/g,"")),i=e,H&&"sticky"in M&&(s=!!e&&D(e,"y")>-1)&&j&&(e=x(e,/y/g,"")),T&&(o=function(t){for(var e,i=t.length,n=0,s="",o=[],r={},a=!1,c=!1,u=0,l="";n<=i;n++){if("\\"===(e=R(t,n)))e+=R(t,++n);else if("]"===e)a=!1;else if(!a)switch(!0){case"["===e:a=!0;break;case"("===e:A(w,N(t,n+1))&&(n+=2,c=!0),s+=e,u++;continue;case">"===e&&c:if(""===l||m(r,l))throw new S("Invalid capture group name");r[l]=!0,o[o.length]=[l,u],c=!1,l="";continue}c?l+=e:s+=e}return[s,o]}(t),t=o[0],y=o[1]),r=a(E(t,e),f?this:k,V),(n||s||y.length)&&(u=I(r),n&&(u.dotAll=!0,u.raw=V(function(t){for(var e,i=t.length,n=0,s="",o=!1;n<=i;n++)"\\"!==(e=R(t,n))?o||"."!==e?("["===e?o=!0:"]"===e&&(o=!1),s+=e):s+="[\\s\\S]":s+=e+R(t,++n);return s}(t),i)),s&&(u.sticky=!0),y.length&&(u.groups=y)),t!==C)try{c(r,"source",""===C?"(?:)":C)}catch(t){}return r},U=u(E),L=0;U.length>L;)p(V,E,U[L++]);k.constructor=V,V.prototype=k,v(s,"RegExp",V,{constructor:!0})}C("RegExp")},4916:(t,e,i)=>{"use strict";var n=i(2109),s=i(2261);n({target:"RegExp",proto:!0,forced:/./.exec!==s},{exec:s})},2087:(t,e,i)=>{var n=i(7854),s=i(9781),o=i(7045),r=i(7066),a=i(7293),c=n.RegExp,u=c.prototype;s&&a((function(){var t=!0;try{c(".","d")}catch(e){t=!1}var e={},i="",n=t?"dgimsy":"gimsy",s=function(t,n){Object.defineProperty(e,t,{get:function(){return i+=n,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var r in t&&(o.hasIndices="d"),o)s(r,o[r]);return Object.getOwnPropertyDescriptor(u,"flags").get.call(e)!==n||i!==n}))&&o(u,"flags",{configurable:!0,get:r})},7227:(t,e,i)=>{"use strict";i(7710)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i(5631))},189:(t,e,i)=>{i(7227)},7852:(t,e,i)=>{"use strict";var n,s=i(2109),o=i(1470),r=i(1236).f,a=i(7466),c=i(1340),u=i(3929),l=i(4488),h=i(4964),g=i(1913),d=o("".endsWith),f=o("".slice),p=Math.min,v=h("endsWith");s({target:"String",proto:!0,forced:!(!g&&!v&&(n=r(String.prototype,"endsWith"),n&&!n.writable)||v)},{endsWith:function(t){var e=c(l(this));u(t);var i=arguments.length>1?arguments[1]:void 0,n=e.length,s=void 0===i?n:p(a(i),n),o=c(t);return d?d(e,o,s):f(e,s-o.length,s)===o}})},2023:(t,e,i)=>{"use strict";var n=i(2109),s=i(1702),o=i(3929),r=i(4488),a=i(1340),c=i(4964),u=s("".indexOf);n({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~u(a(r(this)),a(o(t)),arguments.length>1?arguments[1]:void 0)}})},5306:(t,e,i)=>{"use strict";var n=i(2104),s=i(6916),o=i(1702),r=i(7007),a=i(7293),c=i(9670),u=i(614),l=i(8554),h=i(9303),g=i(7466),d=i(1340),f=i(4488),p=i(1530),v=i(8173),y=i(647),m=i(7651),I=i(5112)("replace"),C=Math.max,_=Math.min,b=o([].concat),T=o([].push),O=o("".indexOf),E=o("".slice),k="$0"==="a".replace(/./,"$0"),S=!!/./[I]&&""===/./[I]("a","$0");r("replace",(function(t,e,i){var o=S?"$":"$0";return[function(t,i){var n=f(this),o=l(t)?void 0:v(t,I);return o?s(o,t,n,i):s(e,d(n),t,i)},function(t,s){var r=c(this),a=d(t);if("string"==typeof s&&-1===O(s,o)&&-1===O(s,"$<")){var l=i(e,r,a,s);if(l.done)return l.value}var f=u(s);f||(s=d(s));var v=r.global;if(v){var I=r.unicode;r.lastIndex=0}for(var k=[];;){var S=m(r,a);if(null===S)break;if(T(k,S),!v)break;""===d(S[0])&&(r.lastIndex=p(a,g(r.lastIndex),I))}for(var A,R="",x=0,D=0;D<k.length;D++){for(var N=d((S=k[D])[0]),w=C(_(h(S.index),a.length),0),M=[],P=1;P<S.length;P++)T(M,void 0===(A=S[P])?A:String(A));var F=S.groups;if(f){var H=b([N],M,w,a);void 0!==F&&T(H,F);var j=d(n(s,void 0,H))}else j=y(N,a,w,M,F,s);w>=x&&(R+=E(a,x,w)+j,x=w+N.length)}return R+E(a,x)}]}),!!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!k||S)},4765:(t,e,i)=>{"use strict";var n=i(6916),s=i(7007),o=i(9670),r=i(8554),a=i(4488),c=i(1150),u=i(1340),l=i(8173),h=i(7651);s("search",(function(t,e,i){return[function(e){var i=a(this),s=r(e)?void 0:l(e,t);return s?n(s,e,i):new RegExp(e)[t](u(i))},function(t){var n=o(this),s=u(t),r=i(e,n,s);if(r.done)return r.value;var a=n.lastIndex;c(a,0)||(n.lastIndex=0);var l=h(n,s);return c(n.lastIndex,a)||(n.lastIndex=a),null===l?-1:l.index}]}))},6755:(t,e,i)=>{"use strict";var n,s=i(2109),o=i(1470),r=i(1236).f,a=i(7466),c=i(1340),u=i(3929),l=i(4488),h=i(4964),g=i(1913),d=o("".startsWith),f=o("".slice),p=Math.min,v=h("startsWith");s({target:"String",proto:!0,forced:!(!g&&!v&&(n=r(String.prototype,"startsWith"),n&&!n.writable)||v)},{startsWith:function(t){var e=c(l(this));u(t);var i=a(p(arguments.length>1?arguments[1]:void 0,e.length)),n=c(t);return d?d(e,n,i):f(e,i,i+n.length)===n}})},1817:(t,e,i)=>{"use strict";var n=i(2109),s=i(9781),o=i(7854),r=i(1702),a=i(2597),c=i(614),u=i(7976),l=i(1340),h=i(7045),g=i(9920),d=o.Symbol,f=d&&d.prototype;if(s&&c(d)&&(!("description"in f)||void 0!==d().description)){var p={},v=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),e=u(f,this)?new d(t):void 0===t?d():d(t);return""===t&&(p[e]=!0),e};g(v,d),v.prototype=f,f.constructor=v;var y="Symbol(test)"==String(d("test")),m=r(f.valueOf),I=r(f.toString),C=/^Symbol\((.*)\)[^)]+$/,_=r("".replace),b=r("".slice);h(f,"description",{configurable:!0,get:function(){var t=m(this);if(a(p,t))return"";var e=I(t),i=y?b(e,7,-1):_(e,C,"$1");return""===i?void 0:i}}),n({global:!0,constructor:!0,forced:!0},{Symbol:v})}},5556:(t,e,i)=>{"use strict";i(6992);var n=i(2109),s=i(7854),o=i(6916),r=i(1702),a=i(9781),c=i(5143),u=i(8052),l=i(7045),h=i(9190),g=i(8003),d=i(3061),f=i(9909),p=i(5787),v=i(614),y=i(2597),m=i(9974),I=i(648),C=i(9670),_=i(111),b=i(1340),T=i(30),O=i(9114),E=i(4121),k=i(1246),S=i(8053),A=i(5112),R=i(4362),x=A("iterator"),D="URLSearchParams",N=D+"Iterator",w=f.set,M=f.getterFor(D),P=f.getterFor(N),F=Object.getOwnPropertyDescriptor,H=function(t){if(!a)return s[t];var e=F(s,t);return e&&e.value},j=H("fetch"),V=H("Request"),U=H("Headers"),L=V&&V.prototype,B=U&&U.prototype,G=s.RegExp,q=s.TypeError,K=s.decodeURIComponent,Q=s.encodeURIComponent,$=r("".charAt),z=r([].join),J=r([].push),W=r("".replace),Y=r([].shift),Z=r([].splice),X=r("".split),tt=r("".slice),et=/\+/g,it=Array(4),nt=function(t){return it[t-1]||(it[t-1]=G("((?:%[\\da-f]{2}){"+t+"})","gi"))},st=function(t){try{return K(t)}catch(e){return t}},ot=function(t){var e=W(t,et," "),i=4;try{return K(e)}catch(t){for(;i;)e=W(e,nt(i--),st);return e}},rt=/[!'()~]|%20/g,at={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ct=function(t){return at[t]},ut=function(t){return W(Q(t),rt,ct)},lt=d((function(t,e){w(this,{type:N,iterator:E(M(t).entries),kind:e})}),"Iterator",(function(){var t=P(this),e=t.kind,i=t.iterator.next(),n=i.value;return i.done||(i.value="keys"===e?n.key:"values"===e?n.value:[n.key,n.value]),i}),!0),ht=function(t){this.entries=[],this.url=null,void 0!==t&&(_(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===$(t,0)?tt(t,1):t:b(t)))};ht.prototype={type:D,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,i,n,s,r,a,c,u=k(t);if(u)for(i=(e=E(t,u)).next;!(n=o(i,e)).done;){if(r=(s=E(C(n.value))).next,(a=o(r,s)).done||(c=o(r,s)).done||!o(r,s).done)throw q("Expected sequence with length 2");J(this.entries,{key:b(a.value),value:b(c.value)})}else for(var l in t)y(t,l)&&J(this.entries,{key:l,value:b(t[l])})},parseQuery:function(t){if(t)for(var e,i,n=X(t,"&"),s=0;s<n.length;)(e=n[s++]).length&&(i=X(e,"="),J(this.entries,{key:ot(Y(i)),value:ot(z(i,"="))}))},serialize:function(){for(var t,e=this.entries,i=[],n=0;n<e.length;)t=e[n++],J(i,ut(t.key)+"="+ut(t.value));return z(i,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var gt=function(){p(this,dt);var t=w(this,new ht(arguments.length>0?arguments[0]:void 0));a||(this.length=t.entries.length)},dt=gt.prototype;if(h(dt,{append:function(t,e){S(arguments.length,2);var i=M(this);J(i.entries,{key:b(t),value:b(e)}),a||this.length++,i.updateURL()},delete:function(t){S(arguments.length,1);for(var e=M(this),i=e.entries,n=b(t),s=0;s<i.length;)i[s].key===n?Z(i,s,1):s++;a||(this.length=i.length),e.updateURL()},get:function(t){S(arguments.length,1);for(var e=M(this).entries,i=b(t),n=0;n<e.length;n++)if(e[n].key===i)return e[n].value;return null},getAll:function(t){S(arguments.length,1);for(var e=M(this).entries,i=b(t),n=[],s=0;s<e.length;s++)e[s].key===i&&J(n,e[s].value);return n},has:function(t){S(arguments.length,1);for(var e=M(this).entries,i=b(t),n=0;n<e.length;)if(e[n++].key===i)return!0;return!1},set:function(t,e){S(arguments.length,1);for(var i,n=M(this),s=n.entries,o=!1,r=b(t),c=b(e),u=0;u<s.length;u++)(i=s[u]).key===r&&(o?Z(s,u--,1):(o=!0,i.value=c));o||J(s,{key:r,value:c}),a||(this.length=s.length),n.updateURL()},sort:function(){var t=M(this);R(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,i=M(this).entries,n=m(t,arguments.length>1?arguments[1]:void 0),s=0;s<i.length;)n((e=i[s++]).value,e.key,this)},keys:function(){return new lt(this,"keys")},values:function(){return new lt(this,"values")},entries:function(){return new lt(this,"entries")}},{enumerable:!0}),u(dt,x,dt.entries,{name:"entries"}),u(dt,"toString",(function(){return M(this).serialize()}),{enumerable:!0}),a&&l(dt,"size",{get:function(){return M(this).entries.length},configurable:!0,enumerable:!0}),g(gt,D),n({global:!0,constructor:!0,forced:!c},{URLSearchParams:gt}),!c&&v(U)){var ft=r(B.has),pt=r(B.set),vt=function(t){if(_(t)){var e,i=t.body;if(I(i)===D)return e=t.headers?new U(t.headers):new U,ft(e,"content-type")||pt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),T(t,{body:O(0,b(i)),headers:O(0,e)})}return t};if(v(j)&&n({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return j(t,arguments.length>1?vt(arguments[1]):{})}}),v(V)){var yt=function(t){return p(this,L),new V(t,arguments.length>1?vt(arguments[1]):{})};L.constructor=yt,yt.prototype=L,n({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:yt})}}t.exports={URLSearchParams:gt,getState:M}},1637:(t,e,i)=>{i(5556)},3685:t=>{"use strict";t.exports=require("http")},5687:t=>{"use strict";t.exports=require("https")},3897:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},t.exports.__esModule=!0,t.exports.default=t.exports},5372:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},7156:t=>{function e(t,e,i,n,s,o,r){try{var a=t[o](r),c=a.value}catch(t){return void i(t)}a.done?e(c):Promise.resolve(c).then(n,s)}t.exports=function(t){return function(){var i=this,n=arguments;return new Promise((function(s,o){var r=t.apply(i,n);function a(t){e(r,s,o,a,c,"next",t)}function c(t){e(r,s,o,a,c,"throw",t)}a(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},8416:(t,e,i)=>{var n=i(4062);t.exports=function(t,e,i){return(e=n(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},t.exports.__esModule=!0,t.exports.default=t.exports},8872:t=>{t.exports=function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,s,o,r,a=[],c=!0,u=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=o.call(i)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,s=t}finally{try{if(!c&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(u)throw s}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},215:(t,e,i)=>{var n=i(7071);t.exports=function(t,e){if(null==t)return{};var i,s,o=n(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o},t.exports.__esModule=!0,t.exports.default=t.exports},7071:t=>{t.exports=function(t,e){if(null==t)return{};var i,n,s={},o=Object.keys(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||(s[i]=t[i]);return s},t.exports.__esModule=!0,t.exports.default=t.exports},7424:(t,e,i)=>{var n=i(5372),s=i(8872),o=i(6116),r=i(2218);t.exports=function(t,e){return n(t)||s(t,e)||o(t,e)||r()},t.exports.__esModule=!0,t.exports.default=t.exports},5036:(t,e,i)=>{var n=i(8698).default;t.exports=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!==n(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports},4062:(t,e,i)=>{var n=i(8698).default,s=i(5036);t.exports=function(t){var e=s(t,"string");return"symbol"===n(e)?e:String(e)},t.exports.__esModule=!0,t.exports.default=t.exports},8698:t=>{function e(i){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:(t,e,i)=>{var n=i(3897);t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";i.r(n),i.d(n,{APP_VERSION_CODE:()=>xi,APP_VERSION_NAME:()=>Ri,CARRIER_NAME:()=>Si,CacheStrategy:()=>jt,DEVICE_LOCALE:()=>pi,DEVICE_MODEL:()=>yi,DEVICE_TYPE:()=>vi,DecisionApiConfig:()=>Qt,DecisionMode:()=>mt,EventCategory:()=>ae,FLAGSHIP_CLIENT:()=>Ni,FLAGSHIP_CONTEXT:()=>Pi,FLAGSHIP_VERSION:()=>wi,FLAGSHIP_VISITOR:()=>Mi,FSFetchReasons:()=>bt,FSFetchStatus:()=>Hi,FSFlag:()=>tn,FSFlagCollection:()=>en,FSFlagMetadata:()=>Fi,FSFlagStatus:()=>Zi,FSSdkStatus:()=>yt,Flagship:()=>kn,HitType:()=>se,INTERFACE_NAME:()=>Di,INTERNET_CONNECTION:()=>Ai,IP:()=>Ti,LOCATION_CITY:()=>mi,LOCATION_COUNTRY:()=>Ci,LOCATION_LAT:()=>_i,LOCATION_LONG:()=>bi,LOCATION_REGION:()=>Ii,LogLevel:()=>_t,OS_NAME:()=>Oi,OS_VERSION_CODE:()=>ki,OS_VERSION_NAME:()=>Ei,TroubleshootingLabel:()=>zt,Visitor:()=>vt,VisitorCacheStatus:()=>Jt,default:()=>Sn});var t=i(7156),e=i.n(t);const s=require("events"),o="4.0.4",r={name:"TypeScript",version:o},a=25e5,c="https://decision.flagship.io/v2/",u="https://events.flagship.io",l="https://events.flagship.io/troubleshooting",h="https://events.flagship.io/analytics",g="activate",d="https://qa-assistant.flagship.io/bundle.js",f="https://staging-qa-assistant.flagship.io/bundle.js",p="https://local-qa-assistant.flagship.io/bundle.js",v="qa-assistant.abtasty.com",y="qa-assistant.flagship.io",m="fs_consent",I="FS_IS_QA_MODE_ENABLED",C="FS_FORCED_VARIATIONS",_="FS_QA_ASSISTANT_SCRIPT_TAG_ID",b=144e5,T="ready",O="https://docs.developers.flagship.io/docs/js-v3",E=`Params 'envId' and 'apiKey' must not be null or empty.\n  Learn more: ${O}#initialization`,k="{0} must be a {1}",S="Visitor {0}, method {1} is deactivated while SDK status is: {2}.",A="SEND BATCH",R="without calling `fetchFlags` method afterwards. So, the value of the flag `{1}` might be outdated",x=`You can't create a new visitor without first calling the "Flagship.start" method.\nLearn more: ${O}#initialization\n`,D="INITIALIZATION",N="UPDATE CONTEXT",w="NEW VISITOR",M="ADD HIT",P="cid",F="cuid",H="vid",j="ds",V="qt",U="APP",L="x-api-key",B="Content-Type",G="x-sdk-client",q="x-sdk-version",K="application/json",Q="BUCKETING",$=`Visitor {0}, the key '{1}' must be a non null String.\nLearn more: ${O}#updating-the-visitor-context`,z=`Visitor {0}, 'value' for key '{1}[], must be one of the following types : String, Number, Boolean\nLearn more: ${O}#updating-the-visitor-context`,J=`visitor {0}, Predefined Context {0} must be of type {1}\nLearn more: ${O}#predefined-user-context-keys-`,W="FETCH_FLAGS",Y="FLAG_VALUE",Z="GET_FLAG",X="FLAG_VISITOR_EXPOSED",tt="FLAG_METADATA",et="Visitor {0}, No Flags found for key {1}:  Empty metadata object is returned",it=`Visitor {0}, Flag for key {1} Method Flag.metadata is deactivated while SDK status is NOT_READY: Empty metadata object is returned {2}\nLearn more: ${O}#getting-flags-campaigns-metadata`,nt="AUTHENTICATE",st=`Visitor {0}, visitorId must not be null or empty\nLearn more: ${O}#authenticate`,ot="UNAUTHENTICATE",rt="ALLOCATION",at=`lookupVisitor method has loaded a bad format version ({0}) for visitor {1}.\nLearn more: ${O}#managing-visitor-cache`,ct="CACHE",ut="visitor {0}. {1} threw an exception {2}",lt="{0} threw an exception {1}",ht="TRACKING_MANAGER",gt="{0} Unexpected Error occurred {1}",dt="{0} has been sent : {1}",ft="ACTIVATE HIT",pt="BATCH HIT";class vt extends s.EventEmitter{constructor(t){super(),this.visitorDelegate=t,this.visitorDelegate.on(T,(t=>{this.emit(T,t)}))}get visitorId(){return this.visitorDelegate.visitorId}set visitorId(t){this.visitorDelegate.visitorId=t}get anonymousId(){return this.visitorDelegate.anonymousId}get config(){return this.visitorDelegate.config}get context(){return this.visitorDelegate.context}get fetchStatus(){return this.visitorDelegate.fetchStatus}get hasConsented(){return this.visitorDelegate.hasConsented}setConsent(t){this.visitorDelegate.setConsent(t)}updateContext(t,e){this.visitorDelegate.updateContext(t,e)}clearContext(){this.visitorDelegate.clearContext()}getFlag(t){return this.visitorDelegate.getFlag(t)}getFlags(){return this.visitorDelegate.getFlags()}fetchFlags(){return this.visitorDelegate.fetchFlags()}sendHit(t){return this.visitorDelegate.sendHit(t)}sendHits(t){return this.visitorDelegate.sendHits(t)}authenticate(t){this.visitorDelegate.authenticate(t)}unauthenticate(){this.visitorDelegate.unauthenticate()}}let yt=function(t){return t[t.SDK_NOT_INITIALIZED=0]="SDK_NOT_INITIALIZED",t[t.SDK_INITIALIZING=1]="SDK_INITIALIZING",t[t.SDK_PANIC=2]="SDK_PANIC",t[t.SDK_INITIALIZED=3]="SDK_INITIALIZED",t}({}),mt=function(t){return t.DECISION_API="DECISION-API",t.BUCKETING="BUCKETING",t.BUCKETING_EDGE="BUCKETING_EDGE",t}({});i(7327),i(9337);var It=i(8416),Ct=i.n(It);let _t=function(t){return t[t.NONE=0]="NONE",t[t.EMERGENCY=1]="EMERGENCY",t[t.ALERT=2]="ALERT",t[t.CRITICAL=3]="CRITICAL",t[t.ERROR=4]="ERROR",t[t.WARNING=5]="WARNING",t[t.NOTICE=6]="NOTICE",t[t.INFO=7]="INFO",t[t.DEBUG=8]="DEBUG",t[t.ALL=9]="ALL",t}({});i(6992),i(1532),i(1038),i(4916),i(5306),i(4603),i(8674),i(7042);let bt=function(t){return t.UPDATE_CONTEXT="UPDATE_CONTEXT",t.AUTHENTICATE="AUTHENTICATE",t.UNAUTHENTICATE="UNAUTHENTICATE",t.FETCH_ERROR="FETCH_ERROR",t.READ_FROM_CACHE="READ_FROM_CACHE",t.VISITOR_CREATED="VISITOR_CREATED",t.NONE="NONE",t}({});function Tt(t,...e){let i=t;for(let t=0;t<e.length;t++){const n=e[t],s="string"==typeof n?n:JSON.stringify(n instanceof Map?Array.from(n.values()):n);i=i.replace(new RegExp(`\\{${t}\\}`,"g"),s)}return i}function Ot(t,e,i,...n){!t||!t.logLevel||t.logLevel<_t.ERROR||Et(t,Tt(i,...n),e)}function Et(t,e,i){!t||!t.logLevel||t.logLevel<_t.ERROR||("function"==typeof t.onLog&&t.onLog(_t.ERROR,i,e),t.logManager&&"function"==typeof t.logManager.error&&t.logManager.error(e,i))}function kt(t,e,i,...n){!t||!t.logLevel||t.logLevel<_t.WARNING||St(t,Tt(i,...n),e)}function St(t,e,i){!t||!t.logLevel||t.logLevel<_t.WARNING||("function"==typeof t.onLog&&t.onLog(_t.WARNING,i,e),t.logManager&&"function"==typeof t.logManager.warning&&t.logManager.warning(e,i))}function At(t,e,i,...n){!t||!t.logLevel||t.logLevel<_t.INFO||Rt(t,Tt(i,...n),e)}function Rt(t,e,i){!t||!t.logLevel||t.logLevel<_t.INFO||("function"==typeof t.onLog&&t.onLog(_t.INFO,i,e),t.logManager&&"function"==typeof t.logManager.info&&t.logManager.info(e,i))}function xt(t,e,i,...n){!t||!t.logLevel||t.logLevel<_t.DEBUG||Dt(t,Tt(i,...n),e)}function Dt(t,e,i){!t||!t.logLevel||t.logLevel<_t.DEBUG||("function"==typeof t.onLog&&t.onLog(_t.DEBUG,i,e),t.logManager&&"function"==typeof t.logManager.debug&&t.logManager.debug(e,i))}function Nt(){return"undefined"!=typeof window&&void 0!==window.document}function wt(t,e){return typeof t==typeof e&&("object"!=typeof t||"object"!=typeof e||Array.isArray(t)===Array.isArray(e))}function Mt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function Pt(t,e){return JSON.stringify({message:t,data:e})}function Ft(t){const e=JSON.stringify(t);return Array.from(e,(t=>t.charCodeAt(0).toString(16))).join("")}function Ht(t,e){if("string"!=typeof t)return Ot(e,"hexToValue","Invalid hex string: {0}",t),null;let i="";for(let n=0;n<t.length;n+=2){const s=t.slice(n,n+2),o=parseInt(s,16);if(isNaN(o))return Ot(e,"hexToValue","Invalid hex character: {0}",s),null;i+=String.fromCharCode(o)}try{return JSON.parse(i)}catch(t){return Ot(e,"hexToValue","Error while parsing JSON: {0}",t),null}}let jt=function(t){return t[t.CONTINUOUS_CACHING=0]="CONTINUOUS_CACHING",t[t.PERIODIC_CACHING=1]="PERIODIC_CACHING",t}({});class Vt{constructor(t){this.batchIntervals=null==t?void 0:t.batchIntervals,this.poolMaxSize=null==t?void 0:t.poolMaxSize,this._batchStrategy=this.getCacheStrategy(null==t?void 0:t.cacheStrategy)}getCacheStrategy(t){return"number"==typeof t?t:Nt()?jt.CONTINUOUS_CACHING:jt.PERIODIC_CACHING}get batchIntervals(){return this._batchIntervals}set batchIntervals(t){("number"!=typeof t||t<1||t>10800)&&(t=Nt()?5:10),this._batchIntervals=t}get poolMaxSize(){return this._poolMaxSize}set poolMaxSize(t){("number"!=typeof t||t<5)&&(t=Nt()?10:100),this._poolMaxSize=t}get cacheStrategy(){return this._batchStrategy}}class Ut{get isQAModeEnabled(){return this._isQAModeEnabled}set isQAModeEnabled(t){this._isQAModeEnabled=t}get disableDeveloperUsageTracking(){return this._disableDeveloperUsageTracking}set disableDeveloperUsageTracking(t){this._disableDeveloperUsageTracking=t}get fetchFlagsBufferingTime(){return this._fetchFlagsBufferingTime}set fetchFlagsBufferingTime(t){this._fetchFlagsBufferingTime=t}get nextFetchConfig(){return this._nextFetchConfig}set nextFetchConfig(t){this._nextFetchConfig=t}get fetchThirdPartyData(){return this._fetchThirdPartyData}set fetchThirdPartyData(t){this._fetchThirdPartyData=t}get trackingManagerConfig(){return this._trackingManagerConfig}get onLog(){return this._onLog}set onLog(t){this._onLog=t}get onVisitorExposed(){return this._onVisitorExposed}constructor(t){const e=t.envId,i=t.apiKey,n=t.timeout,s=t.logLevel,o=t.logManager,r=t.onSdkStatusChanged,a=t.fetchNow,u=t.decisionMode,l=t.reuseVisitorIds,h=t.initialBucketing,g=t.decisionApiUrl,d=t.hitDeduplicationTime,f=t.visitorCacheImplementation,p=t.hitCacheImplementation,v=t.disableCache,y=t.language,m=t.sdkVersion,I=t.trackingManagerConfig,C=t.onLog,_=t.onVisitorExposed,b=t.nextFetchConfig,T=t.fetchFlagsBufferingTime,O=t.disableDeveloperUsageTracking;this.initQaMode(),this.initSDKInfo(y,m),o&&(this.logManager=o),this.fetchFlagsBufferingTime=null!=T?T:2,this.nextFetchConfig=b||{revalidate:20},this._trackingManagerConfig=new Vt(I||{}),this.onLog=C,this.decisionApiUrl=g||c,this._envId=e,this._apiKey=i,this.logLevel=null!=s?s:_t.ALL,this.timeout=n||2,this.fetchNow=void 0===a||a,this.reuseVisitorIds=void 0===l||l,this._decisionMode=u||mt.DECISION_API,this._initialBucketing=h,this.hitDeduplicationTime=null!=d?d:2.5,this.disableCache=!!v,this.disableDeveloperUsageTracking=O||!1,f&&(this.visitorCacheImplementation=f),p&&(this.hitCacheImplementation=p),this.onSdkStatusChanged=r,this._onVisitorExposed=_}initQaMode(){if(Nt())try{const t=sessionStorage.getItem(I);this.isQAModeEnabled=t?JSON.parse(t):void 0}catch(t){Et(this,Pt(t.message||t),"initQaMode"),this.isQAModeEnabled=!1}}initSDKInfo(t,e){switch(t){case 1:r.name="ReactJS",r.version=null!=e?e:o;break;case 2:r.name="React-Native",r.version=null!=e?e:o;break;default:r.name="undefined"!=typeof window&&"Deno"in window?"Deno":"TypeScript",r.version=o}}get initialBucketing(){return this._initialBucketing}set initialBucketing(t){this._initialBucketing=t}get reuseVisitorIds(){return this._reuseVisitorIds}set reuseVisitorIds(t){this._reuseVisitorIds=t}get onBucketingSuccess(){return this._onBucketingSuccess}set onBucketingSuccess(t){this._onBucketingSuccess=t}get onBucketingFail(){return this._onBucketingFail}set onBucketingFail(t){this._onBucketingFail=t}get onBucketingUpdated(){return this._onBucketingUpdated}set onBucketingUpdated(t){this._onBucketingUpdated=t}set envId(t){this._envId=t}get envId(){return this._envId}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}get decisionMode(){return this._decisionMode}get timeout(){return this._timeout}set timeout(t){this._timeout=t}get logLevel(){return this._logLevel}set logLevel(t){this._logLevel=t}get fetchNow(){return this._fetchNow}set fetchNow(t){this._fetchNow=t}get pollingInterval(){return this._pollingInterval}set pollingInterval(t){this._pollingInterval=t}get hitDeduplicationTime(){return this._hitDeduplicationTime}set hitDeduplicationTime(t){"number"==typeof t?this._hitDeduplicationTime=t:Et(this,Tt(k,"hitDeduplicationTime","number"),"hitDeduplicationTime")}get visitorCacheImplementation(){return this._visitorCacheImplementation}set visitorCacheImplementation(t){this._visitorCacheImplementation=t}get hitCacheImplementation(){return this._hitCacheImplementation}set hitCacheImplementation(t){this._hitCacheImplementation=t}get disableCache(){return this._disableCache}set disableCache(t){this._disableCache=t}get onSdkStatusChanged(){return this._onSdkStatusChanged}set onSdkStatusChanged(t){t&&"function"!=typeof t?Et(this,"statusChangedCallback must be a function","onSdkStatusChanged"):this._onSdkStatusChanged=t}get logManager(){return this._logManager}set logManager(t){this._logManager=t}get decisionApiUrl(){return this._decisionApiUrl}set decisionApiUrl(t){"string"==typeof t?this._decisionApiUrl=t:Et(this,Tt(k,"decisionApiUrl","string"),"decisionApiUrl")}}function Lt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Bt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Lt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Gt extends Ut{constructor(t){var e;super(Bt(Bt({},t),{},{decisionMode:mt.BUCKETING})),this.pollingInterval=null!=(e=null==t?void 0:t.pollingInterval)?e:5,this.onBucketingFail=null==t?void 0:t.onBucketingFail,this.onBucketingSuccess=null==t?void 0:t.onBucketingSuccess,this.onBucketingUpdated=null==t?void 0:t.onBucketingUpdated,this.fetchThirdPartyData=null==t?void 0:t.fetchThirdPartyData}}function qt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Kt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):qt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Qt extends Ut{constructor(t){super(Kt(Kt({},t),{},{decisionMode:mt.DECISION_API}))}}class $t{constructor(t,e,i){this._config=t,this._decisionManager=e,this._trackingManager=i}get config(){return this._config}set config(t){this._config=t}get decisionManager(){return this._decisionManager}set decisionManager(t){this._decisionManager=t}get trackingManager(){return this._trackingManager}set trackingManager(t){this._trackingManager=t}}let zt=function(t){return t.VISITOR_SEND_HIT="VISITOR_SEND_HIT",t.VISITOR_FETCH_CAMPAIGNS_ERROR="VISITOR_FETCH_CAMPAIGNS_ERROR",t.VISITOR_FETCH_CAMPAIGNS="VISITOR_FETCH_CAMPAIGNS",t.VISITOR_AUTHENTICATE="VISITOR_AUTHENTICATE",t.VISITOR_UNAUTHENTICATE="VISITOR_UNAUTHENTICATE",t.VISITOR_EXPOSED_FLAG_NOT_FOUND="VISITOR_EXPOSED_FLAG_NOT_FOUND",t.FLAG_VALUE_NOT_CALLED="FLAG_VALUE_NOT_CALLED",t.GET_FLAG_VALUE_FLAG_NOT_FOUND="GET_FLAG_VALUE_FLAG_NOT_FOUND",t.GET_FLAG_METADATA_TYPE_WARNING="GET_FLAG_METADATA_TYPE_WARNING",t.GET_FLAG_VALUE_TYPE_WARNING="GET_FLAG_VALUE_TYPE_WARNING",t.VISITOR_EXPOSED_TYPE_WARNING="VISITOR_EXPOSED_TYPE_WARNING",t.VISITOR_SEND_ACTIVATE="VISITOR_SEND_ACTIVATE",t.GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR="GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR",t.GET_CAMPAIGNS_ROUTE_RESPONSE="GET_CAMPAIGNS_ROUTE_RESPONSE",t.SDK_BUCKETING_FILE="SDK_BUCKETING_FILE",t.SEND_ACTIVATE_HIT_ROUTE_ERROR="SEND_ACTIVATE_HIT_ROUTE_ERROR",t.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR="SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR",t.SEND_HIT_ROUTE_ERROR="SEND_HIT_ROUTE_ERROR",t.SDK_BUCKETING_FILE_ERROR="SDK_BUCKETING_FILE_ERROR",t.SDK_CONFIG="SDK_CONFIG",t}({}),Jt=function(t){return t.NONE="NONE",t.ANONYMOUS_ID_CACHE="ANONYMOUS_ID_CACHE",t.VISITOR_ID_CACHE="VISITOR_ID_CACHE",t.VISITOR_ID_CACHE_NOT_ANONYMOUS_ID_CACHE="VISITOR_ID_CACHE_NOT_ANONYMOUS_ID_CACHE",t}({});class Wt{get key(){return this._key}set key(t){this._key=t}get sessionNumber(){return this._sessionNumber}set sessionNumber(t){this._sessionNumber=t}get locale(){return this._locale}set locale(t){this._locale=t}get screenResolution(){return this._screenResolution}set screenResolution(t){this._screenResolution=t}get userIp(){return this._userIp}set userIp(t){this._userIp=t}get anonymousId(){return this._anonymousId}set anonymousId(t){this._anonymousId=t}get visitorId(){return this._visitorId}set visitorId(t){this._visitorId=t}get ds(){return this._ds}set ds(t){this._ds=t}get type(){return this._type}get config(){return this._config}set config(t){this._config=t}get createdAt(){return this._createdAt}set createdAt(t){this._createdAt=t}get qaMode(){return this._qaMode}set qaMode(t){this._qaMode=t}constructor(t){const e=t.type,i=t.userIp,n=t.screenResolution,s=t.locale,o=t.sessionNumber,r=t.visitorId,a=t.anonymousId,c=t.ds,u=t.qaMode;this._type=e,i&&(this.userIp=i),n&&(this.screenResolution=n),s&&(this.locale=s),o&&(this.sessionNumber=o),this.visitorId=r,this._anonymousId=a||null,this.createdAt=Date.now(),this.ds=c||U,this.qaMode=u}isNotEmptyString(t,e){return!(!t||"string"!=typeof t)||(Et(this.config,Tt(k,e,"string"),e),!1)}isNumeric(t,e){return!(!t||"number"!=typeof t)||(Et(this.config,Tt(k,e,"number"),e),!1)}isInteger(t,e){return!!Number.isInteger(t)||(Et(this.config,Tt(k,e,"integer"),e),!1)}toApiKeys(){var t;const e={[H]:this.visitorId,[j]:this.ds,[P]:`${null==(t=this.config)?void 0:t.envId}`,t:this.type,[F]:null,[V]:Date.now()-this._createdAt};return this.qaMode&&(e.qa=!0),this.userIp&&(e.uip=this.userIp),this.screenResolution&&(e.sr=this.screenResolution),this.locale&&(e.ul=this.locale),this.sessionNumber&&(e.sn=this.sessionNumber),this.visitorId&&this.anonymousId&&(e[H]=this.anonymousId,e[F]=this.visitorId),e}toObject(){return{key:this.key,visitorId:this.visitorId,ds:this.ds,type:this.type,userIp:this.userIp,screenResolution:this.screenResolution,locale:this.locale,sessionNumber:this.sessionNumber,anonymousId:this.anonymousId,createdAt:this.createdAt,qaMode:this.qaMode}}isReady(t=!0){return!!(this.visitorId&&this.ds&&this.config&&this.config.envId&&this.type)}}let Yt=function(t){return t[t.Timer=0]="Timer",t[t.BatchLength=1]="BatchLength",t[t.Flush=2]="Flush",t[t.ActivateLength=3]="ActivateLength",t[t.DirectHit=4]="DirectHit",t[t.DirectActivate=5]="DirectActivate",t}({});class Zt extends Wt{get sdkConfigLogLevel(){return this._sdkConfigLogLevel}set sdkConfigLogLevel(t){this._sdkConfigLogLevel=t}get traffic(){return this._traffic}set traffic(t){this._traffic=t}get flagshipInstanceId(){return this._flagshipInstanceId}set flagshipInstanceId(t){this._flagshipInstanceId=t}get visitorSessionId(){return this._visitorSessionId}set visitorSessionId(t){this._visitorSessionId=t}get sdkConfigDisableCache(){return this._sdkConfigDisableCache}set sdkConfigDisableCache(t){this._sdkConfigDisableCache=t}get sdkConfigDisableDeveloperUsageTracking(){return this._sdkConfigDisableDeveloperUsageTracking}set sdkConfigDisableDeveloperUsageTracking(t){this._sdkConfigDisableDeveloperUsageTracking=t}get sdkConfigNextFetchConfig(){return this._sdkConfigNextFetchConfig}set sdkConfigNextFetchConfig(t){this._sdkConfigNextFetchConfig=t}get sdkConfigFetchFlagsBufferingTime(){return this._sdkConfigFetchFlagsBufferingTime}set sdkConfigFetchFlagsBufferingTime(t){this._sdkConfigFetchFlagsBufferingTime=t}get sdkConfigFetchThirdPartyData(){return this._sdkConfigFetchThirdPartyData}set sdkConfigFetchThirdPartyData(t){this._sdkConfigFetchThirdPartyData=t}get sdkConfigUsingOnVisitorExposed(){return this._sdkConfigUsingOnVisitorExposed}set sdkConfigUsingOnVisitorExposed(t){this._sdkConfigUsingOnVisitorExposed=t}get sdkConfigUsingCustomVisitorCache(){return this._sdkConfigUsingCustomVisitorCache}set sdkConfigUsingCustomVisitorCache(t){this._sdkConfigUsingCustomVisitorCache=t}get sdkConfigUsingCustomHitCache(){return this._sdkConfigUsingCustomHitCache}set sdkConfigUsingCustomHitCache(t){this._sdkConfigUsingCustomHitCache=t}get flagMetadataVariationName(){return this._flagMetadataVariationName}set flagMetadataVariationName(t){this._flagMetadataVariationName=t}get flagMetadataVariationGroupName(){return this._flagMetadataVariationGroupName}set flagMetadataVariationGroupName(t){this._flagMetadataVariationGroupName=t}get flagMetadataCampaignName(){return this._flagMetadataCampaignName}set flagMetadataCampaignName(t){this._flagMetadataCampaignName=t}get sdkBucketingFile(){return this._sdkBucketingFile}set sdkBucketingFile(t){this._sdkBucketingFile=t}get contextValue(){return this._contextValue}set contextValue(t){this._contextValue=t}get contextKey(){return this._contextKey}set contextKey(t){this._contextKey=t}get flagMetadataCampaignIsReference(){return this._flagMetadataCampaignIsReference}set flagMetadataCampaignIsReference(t){this._flagMetadataCampaignIsReference=t}get timeZone(){return this._timeZone}set timeZone(t){this._timeZone=t}get visitorCampaignFromCache(){return this._visitorCampaignFromCache}set visitorCampaignFromCache(t){this._visitorCampaignFromCache=t}get batchTriggeredBy(){return this._batchTriggeredBy}set batchTriggeredBy(t){this._batchTriggeredBy=t}get lastBucketingTimestamp(){return this._lastBucketingTimestamp}set lastBucketingTimestamp(t){this._lastBucketingTimestamp=t}get lastInitializationTimestamp(){return this._lastInitializationTimestamp}set lastInitializationTimestamp(t){this._lastInitializationTimestamp=t}get hitContent(){return this._hitContent}set hitContent(t){this._hitContent=t}get httpResponseTime(){return this._httRequestTime}set httpResponseTime(t){this._httRequestTime=t}get visitorCampaigns(){return this._visitorCampaign}set visitorCampaigns(t){this._visitorCampaign=t}get visitorInitialFlagsData(){return this._visitorInitialFlagsData}set visitorInitialFlagsData(t){this._visitorInitialFlagsData=t}get visitorInitialCampaigns(){return this._visitorInitialCampaigns}set visitorInitialCampaigns(t){this._visitorInitialCampaigns=t}get sdkConfigHitDeduplicationTime(){return this._sdkConfigHitDeduplicationTime}set sdkConfigHitDeduplicationTime(t){this._sdkConfigHitDeduplicationTime=t}get sdkConfigDecisionApiUrl(){return this._sdkConfigDecisionApiUrl}set sdkConfigDecisionApiUrl(t){this._sdkConfigDecisionApiUrl=t}get sdkConfigInitialBucketing(){return this._sdkConfigInitialBucketing}set sdkConfigInitialBucketing(t){this._sdkConfigInitialBucketing=t}get sdkConfigReuseVisitorIds(){return this._sdkConfigReuseVisitorIds}set sdkConfigReuseVisitorIds(t){this._sdkConfigReuseVisitorIds=t}get sdkConfigFetchNow(){return this._sdkConfigFetchNow}set sdkConfigFetchNow(t){this._sdkConfigFetchNow=t}get flagMetadataCampaignType(){return this._flagMetadataCampaignType}set flagMetadataCampaignType(t){this._flagMetadataCampaignType=t}get flagMetadataCampaignSlug(){return this._flagMetadataCampaignSlug}set flagMetadataCampaignSlug(t){this._flagMetadataCampaignSlug=t}get flagMetadataVariationId(){return this._flagMetadataVariationId}set flagMetadataVariationId(t){this._flagMetadataVariationId=t}get flagMetadataVariationGroupId(){return this._flagMetadataVariationGroupId}set flagMetadataVariationGroupId(t){this._flagMetadataVariationGroupId=t}get flagMetadataCampaignId(){return this._flagMetadataCampaignId}set flagMetadataCampaignId(t){this._flagMetadataCampaignId=t}get flagDefault(){return this._flagDefault}set flagDefault(t){this._flagDefault=t}get flagValue(){return this._flagValue}set flagValue(t){this._flagValue=t}get flagKey(){return this._flagKey}set flagKey(t){this._flagKey=t}get visitorIsAuthenticated(){return this._visitorIsAuthenticated}set visitorIsAuthenticated(t){this._visitorIsAuthenticated=t}get visitorFlags(){return this._visitorFlags}set visitorFlags(t){this._visitorFlags=t}get visitorAssignmentHistory(){return this._visitorAssignmentHistory}set visitorAssignmentHistory(t){this._visitorAssignmentHistory=t}get visitorConsent(){return this._visitorConsent}set visitorConsent(t){this._visitorConsent=t}get visitorContext(){return this._visitorContext}set visitorContext(t){this._visitorContext=t}get visitorInstanceType(){return this._visitorInstanceType}set visitorInstanceType(t){this._visitorInstanceType=t}get visitorStatus(){return this._visitorStatus}set visitorStatus(t){this._visitorStatus=t}get httpResponseBody(){return this._httpResponseBody}set httpResponseBody(t){this._httpResponseBody=t}get httpResponseCode(){return this._httpResponseCode}set httpResponseCode(t){this._httpResponseCode=t}get httpResponseHeaders(){return this._httpResponseHeaders}set httpResponseHeaders(t){this._httpResponseHeaders=t}get httpResponseMethod(){return this._httpResponseMethod}set httpResponseMethod(t){this._httpResponseMethod=t}get httpResponseUrl(){return this._httpResponseUrl}set httpResponseUrl(t){this._httpResponseUrl=t}get httpRequestBody(){return this._httpRequestBody}set httpRequestBody(t){this._httpRequestBody=t}get httpRequestHeaders(){return this._httpRequestHeaders}set httpRequestHeaders(t){this._httpRequestHeaders=t}get httpRequestMethod(){return this._httpRequestMethod}set httpRequestMethod(t){this._httpRequestMethod=t}get httpRequestUrl(){return this._httpRequestUrl}set httpRequestUrl(t){this._httpRequestUrl=t}get sdkConfigTrackingManagerPoolMaxSize(){return this._sdkConfigTrackingManagerConfigBatchLength}set sdkConfigTrackingManagerPoolMaxSize(t){this._sdkConfigTrackingManagerConfigBatchLength=t}get sdkConfigTrackingManagerBatchIntervals(){return this._sdkConfigTrackingManagerConfigBatchIntervals}set sdkConfigTrackingManagerBatchIntervals(t){this._sdkConfigTrackingManagerConfigBatchIntervals=t}get sdkConfigTrackingManagerStrategy(){return this._sdkConfigTrackingManagerConfigStrategy}set sdkConfigTrackingManagerStrategy(t){this._sdkConfigTrackingManagerConfigStrategy=t}get sdkConfigPollingInterval(){return this._sdkConfigPollingTime}set sdkConfigPollingInterval(t){this._sdkConfigPollingTime=t}get sdkConfigTimeout(){return this._sdkConfigTimeout}set sdkConfigTimeout(t){this._sdkConfigTimeout=t}get sdkConfigStatusListener(){return this._sdkConfigStatusListener}set sdkConfigStatusListener(t){this._sdkConfigStatusListener=t}get sdkConfigCustomCacheManager(){return this._sdkConfigCustomCacheManager}set sdkConfigCustomCacheManager(t){this._sdkConfigCustomCacheManager=t}get sdkConfigCustomLogManager(){return this._sdkConfigCustomLogManager}set sdkConfigCustomLogManager(t){this._sdkConfigCustomLogManager=t}get sdkConfigMode(){return this._sdkConfigMode}set sdkConfigMode(t){this._sdkConfigMode=t}get sdkStatus(){return this._sdkStatus}set sdkStatus(t){this._sdkStatus=t}get stackOriginVersion(){return this._stackOriginVersion}set stackOriginVersion(t){this._stackOriginVersion=t}get stackOriginName(){return this._stackOriginName}set stackOriginName(t){this._stackOriginName=t}get stackVersion(){return this._stackVersion}set stackVersion(t){this._stackVersion=t}get stackName(){return this._stackName}set stackName(t){this._stackName=t}get stackType(){return this._stackType}set stackType(t){this._stackType=t}get label(){return this._label}set label(t){this._label=t}get timestamp(){return this._timestamp}set timestamp(t){this._timestamp=t}get envId(){return this._envId}set envId(t){this._envId=t}get accountId(){return this._accountId}set accountId(t){this._accountId=t}get logLevel(){return this._logLevel}set logLevel(t){this._logLevel=t}get version(){return this._logVersion}set version(t){this._logVersion=t}constructor(t){super({type:t.type,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId});const e=t.version,i=t.logLevel,n=t.accountId,s=t.envId,o=t.timestamp,a=t.label,c=t.stackType,u=t.stackName,l=t.stackVersion,h=t.stackOriginName,g=t.stackOriginVersion,d=t.sdkStatus,f=t.sdkConfigMode,p=t.sdkConfigCustomLogManager,v=t.sdkConfigCustomCacheManager,y=t.sdkConfigStatusListener,m=t.sdkConfigTimeout,I=t.sdkConfigPollingInterval,C=t.sdkConfigTrackingManagerStrategy,_=t.sdkConfigTrackingManagerBatchIntervals,b=t.sdkConfigTrackingManagerPoolMaxSize,T=t.httpRequestUrl,O=t.httpRequestMethod,E=t.httpRequestHeaders,k=t.httpRequestBody,S=t.httpResponseTime,A=t.httpResponseUrl,R=t.httpResponseMethod,x=t.httpResponseHeaders,D=t.httpResponseCode,N=t.httpResponseBody,w=t.visitorStatus,M=t.visitorInstanceType,P=t.visitorContext,F=t.visitorConsent,H=t.visitorAssignmentHistory,j=t.visitorFlags,V=t.visitorIsAuthenticated,L=t.config,B=t.flagKey,G=t.flagValue,q=t.flagDefault,K=t.flagMetadataCampaignId,Q=t.flagMetadataVariationGroupId,$=t.flagMetadataVariationId,z=t.flagMetadataCampaignSlug,J=t.flagMetadataCampaignType,W=t.sdkConfigFetchNow,Y=t.sdkConfigReuseVisitorIds,Z=t.sdkConfigInitialBucketing,X=t.sdkConfigDecisionApiUrl,tt=t.sdkConfigHitDeduplicationTime,et=t.flagshipInstanceId,it=t.hitContent,nt=t.traffic,st=t.lastInitializationTimestamp,ot=t.lastBucketingTimestamp,rt=t.batchTriggeredBy,at=t.visitorCampaigns,ct=t.visitorCampaignFromCache,ut=t.visitorInitialCampaigns,lt=t.visitorInitialFlagsData,ht=t.flagMetadataCampaignIsReference,gt=t.contextKey,dt=t.contextValue,ft=t.sdkBucketingFile,pt=t.flagMetadataCampaignName,vt=t.flagMetadataVariationGroupName,yt=t.flagMetadataVariationName,mt=t.sdkConfigUsingCustomHitCache,It=t.sdkConfigUsingCustomVisitorCache,Ct=t.sdkConfigUsingOnVisitorExposed,_t=t.sdkConfigFetchThirdPartyData,bt=t.sdkConfigFetchFlagsBufferingTime,Tt=t.sdkConfigDisableDeveloperUsageTracking,Ot=t.sdkConfigNextFetchConfig,Et=t.sdkConfigDisableCache,kt=t.visitorSessionId,St=t.sdkConfigLogLevel;this.visitorSessionId=kt,this.sdkConfigDisableCache=Et,this.sdkConfigDisableDeveloperUsageTracking=Tt,this.sdkConfigNextFetchConfig=Ot,this.sdkConfigFetchFlagsBufferingTime=bt,this.sdkConfigFetchThirdPartyData=_t,this.sdkConfigUsingCustomHitCache=mt,this.sdkConfigUsingCustomVisitorCache=It,this.sdkConfigUsingOnVisitorExposed=Ct,this.flagMetadataCampaignName=pt,this.flagMetadataVariationGroupName=vt,this.flagMetadataVariationName=yt,this.traffic=nt,this.sdkBucketingFile=ft,this.contextKey=gt,this.contextValue=dt,this.lastBucketingTimestamp=ot,this.lastInitializationTimestamp=st,this.batchTriggeredBy=rt,this.visitorCampaigns=at,this.visitorAssignmentHistory=H,this.visitorInitialCampaigns=ut,this.visitorInitialFlagsData=lt,this.visitorCampaignFromCache=ct,this.flagMetadataCampaignIsReference=ht,this.config=L,this.version=e||"1",this.logLevel=i,this.flagshipInstanceId=et,this.accountId=n,this.envId=s||L.envId,this.timestamp=o||new Date(Date.now()).toISOString(),this.timeZone=this.getTimezone(),this.label=a,this.stackType=c||"SDK",this.stackName=u||r.name,this.stackVersion=l||r.version,this.stackOriginName=h,this.stackOriginVersion=g,this.sdkStatus=d,this.sdkConfigMode=f,this.sdkConfigCustomLogManager=p,this.sdkConfigCustomCacheManager=v,this.sdkConfigStatusListener=y,this.sdkConfigTimeout=m,this.sdkConfigPollingInterval=I,this.sdkConfigTrackingManagerStrategy=C,this.sdkConfigTrackingManagerBatchIntervals=_,this.sdkConfigTrackingManagerPoolMaxSize=b,this.sdkConfigFetchNow=W,this.sdkConfigReuseVisitorIds=Y,this.sdkConfigInitialBucketing=Z,this.sdkConfigDecisionApiUrl=X,this.sdkConfigHitDeduplicationTime=tt,this.httpRequestUrl=T,this.httpRequestMethod=O,this.httpRequestHeaders=E,this.httpRequestBody=k,this.httpResponseUrl=A,this.httpResponseMethod=R,this.httpResponseHeaders=x,this.httpResponseCode=D,this.httpResponseBody=N,this.httpResponseTime=S,this.visitorStatus=w,this.visitorInstanceType=M,this.visitorContext=P,this.visitorConsent=F,this.visitorAssignmentHistory=H,this.visitorFlags=j,this.visitorIsAuthenticated=V,this.flagKey=B,this.flagValue=G,this.flagDefault=q,this.flagMetadataCampaignId=K,this.flagMetadataVariationGroupId=Q,this.flagMetadataVariationId=$,this.flagMetadataCampaignSlug=z,this.flagMetadataCampaignType=J,this.hitContent=it,this.ds=U,this.sdkConfigLogLevel=St}getTimezone(){var t,e;return("object"==typeof Intl?null==(t=Intl.DateTimeFormat())||null==(e=t.resolvedOptions())?void 0:e.timeZone:void 0)||""+(new Date).getTimezoneOffset()/60}toApiKeys(){var t;const e={[H]:this.visitorId,[j]:this.ds,[P]:`${null==(t=this.config)?void 0:t.envId}`,t:this.type,cv:{}},i={version:`${this.version}`,logLevel:`${_t[this.logLevel]}`,timestamp:`${this.timestamp}`,timeZone:`${this.timeZone}`,label:`${this.label}`,"stack.type":`${this.stackType}`,"stack.name":`${this.stackName}`,"stack.version":`${this.stackVersion}`};if(void 0!==this.lastBucketingTimestamp&&(i.lastBucketingTimestamp=`${this.lastBucketingTimestamp}`),void 0!==this.lastInitializationTimestamp&&(i.lastInitializationTimestamp=`${this.lastInitializationTimestamp}`),void 0!==this.flagshipInstanceId&&(i.flagshipInstanceId=`${this.flagshipInstanceId}`),this.accountId&&(i.accountId=`${this.accountId}`),this.envId&&(i.envId=`${this.envId}`),void 0!==this.sdkBucketingFile&&(i.sdkBucketingFile=JSON.stringify(this.sdkBucketingFile)),void 0!==this.stackOriginName&&(i["stack.origin.name"]=`${this.stackOriginName}`),void 0!==this.stackOriginVersion&&(i["stack.origin.version"]=`${this.stackOriginVersion}`),void 0!==this.sdkStatus&&(i["sdk.status"]=`${yt[this.sdkStatus]}`),void 0!==this.sdkConfigLogLevel&&(i["sdk.config.logLevel"]=`${_t[this.sdkConfigLogLevel]}`),void 0!==this.sdkConfigMode&&(i["sdk.config.mode"]=`${this.sdkConfigMode}`),void 0!==this.sdkConfigCustomLogManager&&(i["sdk.config.customLogManager"]=`${this.sdkConfigCustomLogManager}`),void 0!==this.sdkConfigCustomCacheManager&&(i["sdk.config.customCacheManager"]=`${this.sdkConfigCustomCacheManager}`),void 0!==this.sdkConfigStatusListener&&(i["sdk.config.custom.StatusListener"]=`${this.sdkConfigStatusListener}`),void 0!==this.sdkConfigTimeout&&(i["sdk.config.timeout"]=""+1e3*this.sdkConfigTimeout),void 0!==this.sdkConfigPollingInterval&&(i["sdk.config.pollingTime"]=""+1e3*this.sdkConfigPollingInterval),void 0!==this.sdkConfigTrackingManagerStrategy&&(i["sdk.config.trackingManager.strategy"]=`${jt[this.sdkConfigTrackingManagerStrategy]}`),void 0!==this.sdkConfigTrackingManagerBatchIntervals&&(i["sdk.config.trackingManager.batchIntervals"]=""+1e3*this.sdkConfigTrackingManagerBatchIntervals),void 0!==this.sdkConfigTrackingManagerPoolMaxSize&&(i["sdk.config.trackingManager.poolMaxSize"]=`${this.sdkConfigTrackingManagerPoolMaxSize}`),void 0!==this.sdkConfigFetchNow&&(i["sdk.config.fetchNow"]=`${this.sdkConfigFetchNow}`),void 0!==this.sdkConfigReuseVisitorIds&&(i["sdk.config.reuseVisitorIds"]=`${this.sdkConfigReuseVisitorIds}`),void 0!==this.sdkConfigInitialBucketing&&(i["sdk.config.initialBucketing"]=JSON.stringify(this.sdkConfigInitialBucketing)),void 0!==this.sdkConfigDecisionApiUrl&&(i["sdk.config.decisionApiUrl"]=`${this.sdkConfigDecisionApiUrl}`),void 0!==this.sdkConfigHitDeduplicationTime&&(i["sdk.config.hitDeduplicationTime"]=""+1e3*this.sdkConfigHitDeduplicationTime),void 0!==this.sdkConfigUsingCustomHitCache&&(i["sdk.config.usingCustomHitCache"]=JSON.stringify(this.sdkConfigUsingCustomHitCache)),void 0!==this.sdkConfigUsingCustomVisitorCache&&(i["sdk.config.usingCustomVisitorCache"]=JSON.stringify(this.sdkConfigUsingCustomVisitorCache)),void 0!==this.sdkConfigUsingOnVisitorExposed&&(i["sdk.config.usingOnVisitorExposed"]=JSON.stringify(this.sdkConfigUsingOnVisitorExposed)),void 0!==this.sdkConfigFetchThirdPartyData&&(i["sdk.config.fetchThirdPartyData"]=JSON.stringify(this.sdkConfigFetchThirdPartyData)),void 0!==this.sdkConfigFetchFlagsBufferingTime&&(i["sdk.config.fetchFlagsBufferingTime"]=JSON.stringify(1e3*this.sdkConfigFetchFlagsBufferingTime)),void 0!==this.sdkConfigNextFetchConfig&&(i["sdk.config.nextFetchConfig"]=JSON.stringify(this.sdkConfigNextFetchConfig)),void 0!==this.sdkConfigDisableDeveloperUsageTracking&&(i["sdk.config.disableDeveloperUsageTracking"]=JSON.stringify(this.sdkConfigDisableDeveloperUsageTracking)),void 0!==this.sdkConfigDisableCache&&(i["sdk.config.disableCache"]=JSON.stringify(this.sdkConfigDisableCache)),void 0!==this.httpRequestUrl&&(i["http.request.url"]=`${this.httpRequestUrl}`),void 0!==this.httpRequestMethod&&(i["http.request.method"]=`${this.httpRequestMethod}`),void 0!==this.httpRequestHeaders&&(i["http.request.headers"]=JSON.stringify(this.httpRequestHeaders)),void 0!==this.httpRequestBody&&(i["http.request.body"]=JSON.stringify(this.httpRequestBody)),void 0!==this.httpResponseUrl&&(i["http.response.url"]=`${this.httpResponseUrl}`),void 0!==this.httpResponseMethod&&(i["http.response.method"]=`${this.httpResponseMethod}`),void 0!==this.httpResponseHeaders&&(i["http.response.headers"]=JSON.stringify(this.httpResponseHeaders)),void 0!==this.httpResponseCode&&(i["http.response.code"]=`${this.httpResponseCode}`),void 0!==this.httpResponseBody&&(i["http.response.body"]=JSON.stringify(this.httpResponseBody)),void 0!==this.httpResponseTime&&(i["http.response.time"]=`${this.httpResponseTime}`),void 0!==this.visitorId&&(i["visitor.visitorId"]=`${this.visitorId}`),void 0!==this.anonymousId&&(i["visitor.anonymousId"]=`${this.anonymousId}`),void 0!==this.visitorSessionId&&(i["visitor.sessionId"]=`${this.visitorSessionId}`),void 0!==this.visitorStatus&&(i["visitor.status"]=`${this.visitorStatus}`),void 0!==this.visitorInstanceType&&(i["visitor.instanceType"]=`${this.visitorInstanceType}`),void 0!==this.visitorContext)for(const t in this.visitorContext){const e=this.visitorContext[t];i[`visitor.context.[${t}]`]=`${e}`}if(void 0!==this.visitorConsent&&(i["visitor.consent"]=`${this.visitorConsent}`),void 0!==this.visitorAssignmentHistory)for(const t in this.visitorAssignmentHistory){const e=this.visitorAssignmentHistory[t];i[`visitor.assignments.[${t}]`]=e}if(void 0!==this.visitorFlags&&this.visitorFlags.forEach(((t,e)=>{for(const n in t){const s=t[n],o="value"===n||"key"===n,r="string"==typeof s?s:JSON.stringify(s);i[`visitor.flags.[${e}]${o?"":".metadata"}.${n}`]=r}})),void 0!==this.visitorIsAuthenticated&&(i["visitor.isAuthenticated"]=`${this.visitorIsAuthenticated}`),void 0!==this.visitorInitialCampaigns&&(i["visitor.initialCampaigns"]=JSON.stringify(this.visitorInitialCampaigns)),void 0!==this.visitorInitialFlagsData&&(i["visitor.initialFlagsData"]=JSON.stringify(Array.isArray(this.visitorInitialFlagsData)?this.visitorInitialFlagsData:Array.from(this.visitorInitialFlagsData))),void 0!==this.visitorCampaigns&&(i["visitor.campaigns"]=JSON.stringify(this.visitorCampaigns)),void 0!==this.visitorCampaignFromCache&&(i["visitor.campaignFromCache"]=JSON.stringify(this.visitorCampaignFromCache)),void 0!==this.contextKey&&(i.contextKey=`${this.contextKey}`),void 0!==this.contextValue&&(i.contextValue=`${this.contextValue}`),void 0!==this.flagKey&&(i["flag.key"]=`${this.flagKey}`),void 0!==this.flagValue&&(i["flag.value"]=`${this.flagValue}`),void 0!==this.flagDefault&&(i["flag.default"]=JSON.stringify(this.flagDefault)),void 0!==this.flagMetadataCampaignId&&(i["flag.metadata.campaignId"]=`${this.flagMetadataCampaignId}`),void 0!==this.flagMetadataCampaignName&&(i["flag.metadata.campaignName"]=`${this.flagMetadataCampaignName}`),void 0!==this.flagMetadataVariationGroupId&&(i["flag.metadata.variationGroupId"]=`${this.flagMetadataVariationGroupId}`),void 0!==this.flagMetadataVariationGroupName&&(i["flag.metadata.variationGroupName"]=`${this.flagMetadataVariationGroupName}`),void 0!==this.flagMetadataVariationId&&(i["flag.metadata.variationId"]=`${this.flagMetadataVariationId}`),void 0!==this.flagMetadataVariationName&&(i["flag.metadata.variationName"]=`${this.flagMetadataVariationName}`),void 0!==this.flagMetadataCampaignSlug&&(i["flag.metadata.campaignSlug"]=`${this.flagMetadataCampaignSlug}`),void 0!==this.flagMetadataCampaignType&&(i["flag.metadata.campaignType"]=`${this.flagMetadataCampaignType}`),void 0!==this.flagMetadataCampaignIsReference&&(i["flag.metadata.isReference"]=`${this.flagMetadataCampaignIsReference}`),void 0!==this.hitContent)for(const t in this.hitContent){const e=this.hitContent[t];i[`hit.${t}`]="string"==typeof e?e:JSON.stringify(e)}return void 0!==this.batchTriggeredBy&&(i.batchTriggeredBy=`${Yt[this.batchTriggeredBy]}`),e.cv=i,e}isReady(t=!0){return!(t&&!super.isReady())}getErrorMessage(){return"event category and event action are required"}}function Xt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function te(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Xt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class ee extends Zt{constructor(t){super(te(te({},t),{},{type:"TROUBLESHOOTING"}))}}class ie{get trackingManager(){return this._trackingManager}set trackingManager(t){this._trackingManager=t}get flagshipInstanceId(){return this._flagshipInstanceId}set flagshipInstanceId(t){this._flagshipInstanceId=t}get lastBucketingTimestamp(){return this._lastBucketingTimestamp}get troubleshooting(){return this._troubleshooting}set troubleshooting(t){this._troubleshooting=t}get config(){return this._config}set panic(t){this.updateFlagshipStatus(t?yt.SDK_PANIC:yt.SDK_INITIALIZED),this._panic=t,t&&Dt(this.config,"Panic mode is enabled : all feature are disabled except fetchFlags.",W)}statusChangedCallback(t){this._statusChangedCallback=t}constructor(t,e){Ct()(this,"_panic",!1),this._config=e,this._httpClient=t}updateFlagshipStatus(t){"function"==typeof this._statusChangedCallback&&this._statusChangedCallback&&this._statusChangedCallback(t)}getModifications(t){const e=new Map;return t.forEach((t=>{const i=t.variation.modifications.value;for(const n in i){const s=i[n];e.set(n,{key:n,campaignId:t.id,campaignName:t.name||"",variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName||"",variationId:t.variation.id,variationName:t.variation.name||"",isReference:!!t.variation.reference,campaignType:t.type,slug:t.slug,value:s})}})),e}isPanic(){return this._panic}getDecisionApiCampaignsAsync(t){var i=this;return e()((function*(){const e={[L]:`${i.config.apiKey}`,[G]:r.name,[q]:r.version,[B]:K},n={visitorId:t.visitorId,anonymousId:t.anonymousId,trigger_hit:!1,context:t.context,visitor_consent:t.hasConsented},s=`${i.config.decisionApiUrl||c}${i.config.envId}/campaigns?exposeAllKeys=true&extras[]=accountSettings`,o=Date.now();try{var a,u,l,h,g;const t=yield i._httpClient.postAsync(s,{headers:e,timeout:i.config.timeout,body:n,nextFetchConfig:i.config.nextFetchConfig});i.panic=!(null==t||null==(a=t.body)||!a.panic);let o=null;null!=t&&null!=(u=t.body)&&u.campaigns&&(o=t.body.campaigns);const r=null==t||null==(l=t.body)||null==(h=l.extras)||null==(g=h.accountSettings)?void 0:g.troubleshooting;return r&&(i.troubleshooting={startDate:new Date(r.startDate),endDate:new Date(r.endDate),timezone:r.timezone,traffic:r.traffic}),o}catch(r){const a=new ee({label:zt.GET_CAMPAIGNS_ROUTE_RESPONSE_ERROR,logLevel:_t.ERROR,visitorId:t.visitorId,anonymousId:t.anonymousId,visitorSessionId:t.instanceId,traffic:100,config:i.config,visitorContext:t.context,httpRequestBody:n,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:s,httpResponseBody:null==r?void 0:r.message,httpResponseHeaders:null==r?void 0:r.headers,httpResponseCode:null==r?void 0:r.statusCode,httpResponseTime:Date.now()-o});yield i.trackingManager.addTroubleshootingHit(a);const c=Pt(r.message||r,{url:s,headers:e,body:n,duration:Date.now()-o});throw new Error(c)}}))()}}class ne extends ie{getCampaignsAsync(t){var i=this;return e()((function*(){return i.getDecisionApiCampaignsAsync(t)}))()}}i(9720);let se=function(t){return t.PAGE_VIEW="PAGEVIEW",t.PAGE="PAGEVIEW",t.SCREEN_VIEW="SCREENVIEW",t.SCREEN="SCREENVIEW",t.TRANSACTION="TRANSACTION",t.ITEM="ITEM",t.EVENT="EVENT",t}({});function oe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function re(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):oe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i(6699),i(2023),i(2479);let ae=function(t){return t.ACTION_TRACKING="Action Tracking",t.USER_ENGAGEMENT="User Engagement",t}({});class ce extends Wt{get category(){return this._category}set category(t){Object.values(ae).includes(t)?this._category=t:Et(this.config,"The category value must be either EventCategory::ACTION_TRACKING or EventCategory::ACTION_TRACKING","category")}get action(){return this._action}set action(t){this.isNotEmptyString(t,"action")&&(this._action=t)}get label(){return this._label}set label(t){this.isNotEmptyString(t,"label")&&(this._label=t)}get value(){return this._value}set value(t){!Number.isInteger(t)||t<0?Et(this.config,"value must be an integer and be >= 0","value"):this._value=t}constructor(t){super({type:se.EVENT,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode});const e=t.category,i=t.action,n=t.label,s=t.value;this.category=e,this.action=i,n&&(this.label=n),s&&(this.value=s)}toApiKeys(){const t=super.toApiKeys();return t.ec=this.category,t.ea=this.action,this.label&&(t.el=this.label),this.value&&(t.ev=this.value),t}toObject(){return re(re({},super.toObject()),{},{category:this.category,action:this.action,label:this.label,value:this.value})}isReady(t=!0){return!(t&&!super.isReady()||!this.category||!this.action)}getErrorMessage(){return"event category and event action are required"}}function ue(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function le(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ue(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class he extends Wt{get transactionId(){return this._transactionId}set transactionId(t){this.isNotEmptyString(t,"transactionId")&&(this._transactionId=t)}get productName(){return this._productName}set productName(t){this.isNotEmptyString(t,"productName")&&(this._productName=t)}get productSku(){return this._productSku}set productSku(t){this.isNotEmptyString(t,"productSku")&&(this._productSku=t)}get itemPrice(){return this._itemPrice}set itemPrice(t){this.isNumeric(t,"itemPrice")&&(this._itemPrice=t)}get itemQuantity(){return this._itemQuantity}set itemQuantity(t){this.isInteger(t,"itemQuantity")&&(this._itemQuantity=Math.trunc(t))}get itemCategory(){return this._itemCategory}set itemCategory(t){this.isNotEmptyString(t,"itemCategory")&&(this._itemCategory=t)}constructor(t){super({type:se.ITEM,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode});const e=t.transactionId,i=t.productName,n=t.productSku,s=t.itemCategory,o=t.itemPrice,r=t.itemQuantity;this.transactionId=e,this.productName=i,this.productSku=n,s&&(this.itemCategory=s),o&&(this.itemPrice=o),r&&(this.itemQuantity=r)}isReady(t=!0){return!(t&&!super.isReady()||!this.transactionId||!this.productName||!this.productSku)}toApiKeys(){const t=super.toApiKeys();return t.tid=this.transactionId,t.in=this.productName,t.ic=this.productSku,this.itemPrice&&(t.ip=this.itemPrice),this.itemQuantity&&(t.iq=this.itemQuantity),this.itemCategory&&(t.iv=this.itemCategory),t}toObject(){return le(le({},super.toObject()),{},{transactionId:this.transactionId,productName:this.productName,productSku:this.productSku,itemPrice:this.itemPrice,itemQuantity:this.itemQuantity,itemCategory:this.itemCategory})}getErrorMessage(){return"Transaction Id, Item name and item code are required"}}function ge(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function de(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ge(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ge(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class fe extends Wt{get documentLocation(){return this._documentLocation}set documentLocation(t){this.isNotEmptyString(t,"documentLocation")&&(this._documentLocation=t)}constructor(t){super({type:se.PAGE_VIEW,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode}),this.documentLocation=t.documentLocation}isReady(t=!0){return!(t&&!super.isReady()||!this.documentLocation)}toApiKeys(){const t=super.toApiKeys();return t.dl=this.documentLocation,t}toObject(){return de(de({},super.toObject()),{},{documentLocation:this.documentLocation})}getErrorMessage(){return"documentLocation url is required"}}function pe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ve(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):pe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class ye extends Wt{get documentLocation(){return this._documentLocation}set documentLocation(t){this.isNotEmptyString(t,"documentLocation")&&(this._documentLocation=t)}constructor(t){super({type:se.SCREEN_VIEW,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode}),this.documentLocation=t.documentLocation}isReady(t=!0){return!(t&&!super.isReady()||!this.documentLocation)}toApiKeys(){const t=super.toApiKeys();return t.dl=this.documentLocation,t}toObject(){return ve(ve({},super.toObject()),{},{documentLocation:this.documentLocation})}getErrorMessage(){return"Screen name is required"}}function me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ie(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?me(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Ce extends Wt{get transactionId(){return this._transactionId}set transactionId(t){this.isNotEmptyString(t,"transactionId")&&(this._transactionId=t)}get affiliation(){return this._affiliation}set affiliation(t){this.isNotEmptyString(t,"affiliation")&&(this._affiliation=t)}get taxes(){return this._taxes}set taxes(t){this.isNumeric(t,"taxes")&&(this._taxes=t)}get currency(){return this._currency}set currency(t){t&&"string"==typeof t&&3===t.length?this._currency=t:Et(this.config,Tt("{0} must be a string and have exactly 3 letters","currency"),"currency")}get couponCode(){return this._couponCode}set couponCode(t){this.isNotEmptyString(t,"couponCode")&&(this._couponCode=t)}get itemCount(){return this._itemCount}set itemCount(t){this.isInteger(t,"itemCount")&&(this._itemCount=Math.trunc(t))}get shippingMethod(){return this._shippingMethod}set shippingMethod(t){this.isNotEmptyString(t,"shippingMethod")&&(this._shippingMethod=t)}get paymentMethod(){return this._paymentMethod}set paymentMethod(t){this.isNotEmptyString(t,"paymentMethod")&&(this._paymentMethod=t)}get totalRevenue(){return this._totalRevenue}set totalRevenue(t){this.isNumeric(t,"totalRevenue")&&(this._totalRevenue=t)}get shippingCosts(){return this._shippingCosts}set shippingCosts(t){this.isNumeric(t,"shippingCosts")&&(this._shippingCosts=t)}constructor(t){super({type:se.TRANSACTION,userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode});const e=t.transactionId,i=t.affiliation,n=t.taxes,s=t.currency,o=t.couponCode,r=t.itemCount,a=t.shippingMethod,c=t.paymentMethod,u=t.totalRevenue,l=t.shippingCosts;this.transactionId=e,this.affiliation=i,n&&(this.taxes=n),s&&(this.currency=s),o&&(this.couponCode=o),r&&(this.itemCount=r),a&&(this.shippingMethod=a),c&&(this.paymentMethod=c),u&&(this.totalRevenue=u),l&&(this.shippingCosts=l)}isReady(t=!0){return!(t&&!super.isReady()||!this.transactionId||!this.affiliation)}toApiKeys(){const t=super.toApiKeys();return t.tid=this.transactionId,t.ta=this.affiliation,this.taxes&&(t.tt=this.taxes),this.currency&&(t.tc=this.currency),this.couponCode&&(t.tcc=this.couponCode),this.itemCount&&(t.icn=this.itemCount),this.shippingMethod&&(t.sm=this.shippingMethod),this.paymentMethod&&(t.pm=this.paymentMethod),this.totalRevenue&&(t.tr=this.totalRevenue),this.shippingCosts&&(t.ts=this.shippingCosts),t}toObject(){return Ie(Ie({},super.toObject()),{},{transactionId:this.transactionId,affiliation:this.affiliation,taxes:this.taxes,currency:this.currency,couponCode:this.couponCode,itemCount:this.itemCount,shippingMethod:this.shippingMethod,paymentMethod:this.paymentMethod,totalRevenue:this.totalRevenue,shippingCosts:this.shippingCosts})}getErrorMessage(){return"Transaction Id and Transaction affiliation are required"}}function _e(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function be(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Te extends Wt{get context(){return this._context}set context(t){this._context=t}constructor(t){super({type:"SEGMENT",userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode}),this.context=t.context}isReady(t=!0){return!(t&&!super.isReady()||!this.context)}toApiKeys(){const t=super.toApiKeys();return t.s=this.context,t}toObject(){return be(be({},super.toObject()),{},{context:this.context})}getErrorMessage(){return"data property is required"}}i(1249);class Oe{get hits(){return this._hits}get config(){return this._config}constructor(t,e){this._config=e,this._hits=t}toApiKeys(){var t;return{[P]:`${null==(t=this.config)?void 0:t.envId}`,batch:this.hits.map((t=>{const e=t.toApiKeys();return delete e[P],e}))}}}i(1817);var Ee=i(7424),ke=i.n(Ee);function Se(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ae(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Se(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Se(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Re extends Wt{get hits(){return this._hits}set hits(t){this._hits=t}constructor(t){super(Ae(Ae({},t),{},{visitorId:"",anonymousId:"",type:"BATCH"})),this.hits=t.hits}isReady(){return!!(super.isReady()&&this.hits&&this.hits.length>0&&this.hits.every((t=>t.isReady(!1))))}toApiKeys(){var t;const e={[j]:this.ds,[P]:`${null==(t=this.config)?void 0:t.envId}`,t:this.type,[V]:Date.now()-this.createdAt};return e.h=this.hits.map((t=>{const e=t.toApiKeys();return delete e[j],delete e[P],e})),e}getErrorMessage(){return"Please check required fields"}}let xe=function(t){return t.QaAssistantClose="ABTASTY_QA_ASSISTANT_CLOSE",t.FsApplyForcedVariations="FS_APPLY_FORCED_VARIATIONS",t.FsResetForcedVariations="FS_RESET_FORCED_VARIATIONS",t.FsQaAssistantReady="FS_QA_ASSISTANT_READY",t.MinimizeQaAssistantClose="ABTASTY_QA_MINIMIZE_QA_ASSISTANT_CLOSE",t.FsTriggerRender="FS_TRIGGER_RENDER",t}({}),De=function(t){return t.FsUpdateVisitorAllocatedVariation="FS_UPDATE_VISITOR_ALLOCATED_VARIATION",t.FsVisitorExposedVariation="FS_VISITOR_EXPOSED_VARIATION",t.FsHIT="FS_HIT",t}({}),Ne=function(t){return t.FsTriggerRendering="FS_TRIGGER_RENDERING",t}({});function we(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Me(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?we(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):we(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Pe(t){var e,i;null!=(e=window)&&null!=(i=e.frames)&&i.ABTastyQaAssistant&&Nt()&&window.frames.ABTastyQaAssistant.postMessage(t,"*")}function Fe(t){Nt()&&(window.flagship=Me(Me({},window.flagship),{},{visitorVariations:t}),Pe({name:De.FsUpdateVisitorAllocatedVariation,value:t}))}function He(t){Pe({name:De.FsVisitorExposedVariation,value:t})}function je(t){Pe({name:De.FsHIT,value:t.map((t=>Me(Me({},t),{},{timestamp:Date.now()-t.qt})))})}function Ve(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ue(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ve(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ve(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Le(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}class Be{get flagshipInstanceId(){return this._flagshipInstanceId}get troubleshootingData(){return this._troubleshootingData}set troubleshootingData(t){this._troubleshootingData=t}get config(){return this._config}constructor(t){const e=t.config,i=t.hitsPoolQueue,n=t.httpClient,s=t.activatePoolQueue,o=t.troubleshootingQueue,r=t.flagshipInstanceId,a=t.analyticHitQueue;this._HitsToFsQa=[],this._config=e,this._hitsPoolQueue=i,this._httpClient=n,this._activatePoolQueue=s,this._troubleshootingQueue=o,this._flagshipInstanceId=r,this._usageHitQueue=a,this._isUsageHitQueueSending=!1,this._isTroubleshootingQueueSending=!1}sendHitsToFsQa(t){Nt()&&this.config.isQAModeEnabled&&(this._HitsToFsQa.push(...t),this._HitsToFsQa.length>=10&&(je(this._HitsToFsQa.map((t=>t.toApiKeys()))),this._HitsToFsQa=[]),this._sendFsHitToQATimeoutId&&clearTimeout(this._sendFsHitToQATimeoutId),this._HitsToFsQa.length&&(this._sendFsHitToQATimeoutId=setTimeout((()=>{je(this._HitsToFsQa.map((t=>t.toApiKeys()))),this._HitsToFsQa=[]}),3e3)))}addHit(t){var i=this;return e()((function*(){var e;const n=`${t.visitorId}:${Mt()}`;t.key=n,yield i.addHitInPoolQueue(t),t.type===se.EVENT&&t.action===m&&t.label===`${r.name}:false`&&(yield i.notConsent(t.visitorId)),xt(i.config,ht,"The HIT has been added into the pool queue : {0}",t.toApiKeys()),null!=(e=i.config.trackingManagerConfig)&&e.poolMaxSize&&i._hitsPoolQueue.size>=i.config.trackingManagerConfig.poolMaxSize&&i.config.decisionMode!==mt.BUCKETING_EDGE&&i.sendBatch()}))()}activateFlag(t){var i=this;return e()((function*(){const e=`${t.visitorId}:${Mt()}`;if(t.key=e,i.config.decisionMode===mt.BUCKETING_EDGE)return yield i.activateFlagEdgeMode(t),void Dt(i.config,Tt("The ACTIVATE has been added to the pool queue : {0}",JSON.stringify(t.toApiKeys())),"ADD ACTIVATE");let n=[];i._activatePoolQueue.size&&(n=Array.from(i._activatePoolQueue.values())),i._activatePoolQueue.clear(),yield i.sendActivate({activateHitsPool:n,currentActivate:t,batchTriggeredBy:Yt.ActivateLength})}))()}activateFlagEdgeMode(t){var i=this;return e()((function*(){i._activatePoolQueue.set(t.key,t),yield i.cacheHit(new Map([[t.key,t]]))}))()}onVisitorExposed(t){const e=this.config.onVisitorExposed;if("function"!=typeof e)return;const i={key:t.flagKey,value:t.flagValue,defaultValue:t.flagDefaultValue,metadata:t.flagMetadata};e({exposedVisitor:{id:t.visitorId,anonymousId:t.anonymousId,context:t.visitorContext},fromFlag:i})}sendBatch(t=Yt.BatchLength){var i=this;return e()((function*(){if(i._activatePoolQueue.size){const e=Array.from(i._activatePoolQueue.values());i._activatePoolQueue.clear(),yield i.sendActivate({activateHitsPool:e,batchTriggeredBy:t})}const e=new Re({hits:[],ds:U});e.config=i.config;const n=[];var s,o=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Le(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Le(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}(i._hitsPoolQueue);try{for(o.s();!(s=o.n()).done;){const t=ke()(s.value,2),i=t[0],o=t[1];if(Date.now()-o.createdAt>=b)n.push(i);else{if(JSON.stringify(e).length>a)break;e.hits.push(o),n.push(i)}}}catch(t){o.e(t)}finally{o.f()}if(n.forEach((t=>{i._hitsPoolQueue.delete(t)})),!e.hits.length)return;const r={[B]:K},c=e.toApiKeys(),l=Date.now();try{yield i._httpClient.postAsync(u,{headers:r,body:c,timeout:i.config.timeout,nextFetchConfig:i.config.nextFetchConfig}),xt(i.config,ht,dt,pt,{url:u,body:c,headers:r,nextFetchConfig:i.config.nextFetchConfig,duration:Date.now()-l,batchTriggeredBy:Yt[t]}),yield i.flushHits(n),i.sendHitsToFsQa(e.hits)}catch(n){e.hits.forEach((t=>{i._hitsPoolQueue.set(t.key,t)})),Ot(i.config,ht,gt,pt,{httpRequestBody:c,httpRequestHeaders:r,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==n?void 0:n.message,httpResponseHeaders:null==n?void 0:n.headers,httpResponseCode:null==n?void 0:n.statusCode,duration:Date.now()-l,batchTriggeredBy:Yt[t]});const s=new ee({label:zt.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR,logLevel:_t.ERROR,visitorId:`${i._flagshipInstanceId}`,flagshipInstanceId:i._flagshipInstanceId,traffic:0,config:i.config,httpRequestBody:e.hits,httpRequestHeaders:r,httpResponseBody:null==n?void 0:n.message,httpResponseHeaders:null==n?void 0:n.headers,httpResponseMethod:"POST",httpResponseUrl:u,httpResponseCode:null==n?void 0:n.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:t});yield i.sendTroubleshootingHit(s)}}))()}notConsent(t){var i=this;return e()((function*(){const e=Array.from(i._hitsPoolQueue).filter((([e,i])=>!((null==i?void 0:i.type)===se.EVENT&&(null==i?void 0:i.action)===m||i.visitorId!==t&&i.anonymousId!==t))),n=Array.from(i._activatePoolQueue).filter((([e,i])=>i.visitorId===t||i.anonymousId===t)),s=[];e.forEach((([t])=>{i._hitsPoolQueue.delete(t),s.push(t)})),n.forEach((([t])=>{i._activatePoolQueue.delete(t),s.push(t)})),s.length&&(yield i.flushHits(s))}))()}cacheHit(t){var i=this;return e()((function*(){try{const e=i.config.hitCacheImplementation;if(i.config.disableCache||!e||"function"!=typeof e.cacheHit)return;const n={};t.forEach(((t,e)=>{const i={version:1,data:{visitorId:t.visitorId,anonymousId:t.anonymousId,type:t.type,content:t.toObject(),time:Date.now()}};n[e]=i})),yield e.cacheHit(n),xt(i.config,"CACHE HIT","Hit cache has been saved into database : {0}",n)}catch(t){Ot(i.config,ct,lt,"cacheHit",t.message||t)}}))()}flushHits(t){var i=this;return e()((function*(){try{const e=i.config.hitCacheImplementation;if(i.config.disableCache||!e||"function"!=typeof e.flushHits)return;yield e.flushHits(t),xt(i.config,ct,"The following hit keys have been flushed from database : {0}",t)}catch(t){Ot(i.config,ct,lt,"flushHits",t.message||t)}}))()}flushAllHits(){var t=this;return e()((function*(){try{const e=t.config.hitCacheImplementation;if(t.config.disableCache||!e||"function"!=typeof e.flushAllHits)return;yield e.flushAllHits(),Dt(t.config,"All hits cache has been flushed from database","FLUSH HIT")}catch(e){Ot(t.config,ct,lt,"flushAllHits",e.message||e)}}))()}isTroubleshootingActivated(){if(!this.troubleshootingData)return!1;const t=new Date;return t>=this.troubleshootingData.startDate&&!(t>this.troubleshootingData.endDate)}addTroubleshootingHit(t){var i=this;return e()((function*(){if(!t.key){const e=`${t.visitorId}:${Mt()}`;t.key=e}i._troubleshootingQueue.set(t.key,t),Dt(i.config,Tt("The TROUBLESHOOTING HIT has been added to the pool queue : {0}",JSON.stringify(t.toApiKeys())),"ADD TROUBLESHOOTING HIT")}))()}sendTroubleshootingHit(t){var i=this;return e()((function*(){if(!i.isTroubleshootingActivated()||void 0===t.traffic||i.troubleshootingData.traffic<t.traffic)return;const e=t.toApiKeys(),n=Date.now();try{yield i._httpClient.postAsync(l,{body:e}),Dt(i.config,Tt("Troubleshooting hit has been sent : {0}",JSON.stringify(Ue(Ue({},e),{},{duration:Date.now()-n}))),"SEND TROUBLESHOOTING"),t.key&&(i._troubleshootingQueue.delete(t.key),yield i.flushHits([t.key]))}catch(s){i.isTroubleshootingActivated()&&(yield i.addTroubleshootingHit(t)),Et(i.config,Pt(s.message||s,{url:l,headers:{},body:e,duration:Date.now()-n}),A)}}))()}sendTroubleshootingQueue(){var t=this;return e()((function*(){if(t.isTroubleshootingActivated()&&!t._isTroubleshootingQueueSending&&0!==t._troubleshootingQueue.size){t._isTroubleshootingQueueSending=!0;for(var e=0,i=Array.from(t._troubleshootingQueue);e<i.length;e++){const n=ke()(i[e],2),s=(n[0],n[1]);yield t.sendTroubleshootingHit(s)}t._isTroubleshootingQueueSending=!1}}))()}addUsageHit(t){var i=this;return e()((function*(){if(!t.key){const e=`${t.visitorId}:${Mt()}`;t.key=e}i._usageHitQueue.set(t.key,t),Dt(i.config,Tt("The USAGE HIT has been added to the pool queue : {0}",JSON.stringify(t.toApiKeys())),"ADD USAGE HIT")}))()}sendUsageHit(t){var i=this;return e()((function*(){const e=t.toApiKeys(),n=Date.now();try{yield i._httpClient.postAsync(h,{body:e}),Dt(i.config,Tt("Usage hit has been sent : {0}",JSON.stringify(Ue(Ue({},e),{},{duration:Date.now()-n}))),"SEND USAGE HIT"),t.key&&(i._usageHitQueue.delete(t.key),yield i.flushHits([t.key]))}catch(s){yield i.addUsageHit(t),Et(i.config,Pt(s.message||s,{url:h,headers:{},body:e,duration:Date.now()-n}),A)}}))()}sendUsageHitQueue(){var t=this;return e()((function*(){if(!t._isUsageHitQueueSending&&0!==t._usageHitQueue.size){t._isUsageHitQueueSending=!0;for(var e=0,i=Array.from(t._usageHitQueue);e<i.length;e++){const n=ke()(i[e],2),s=(n[0],n[1]);yield t.sendUsageHit(s)}t._isUsageHitQueueSending=!1}}))()}}class Ge extends Be{addHitInPoolQueue(t){var i=this;return e()((function*(){i._hitsPoolQueue.set(t.key,t),yield i.cacheHit(new Map([[t.key,t]]))}))()}sendActivate({activateHitsPool:t,currentActivate:i,batchTriggeredBy:n}){var s=this;return e()((function*(){const e={[L]:s.config.apiKey,[G]:r.name,[q]:r.version,[B]:K},o=new Oe(Array.from(t.filter((t=>Date.now()-t.createdAt<b))),s.config);i&&o.hits.push(i);const a=o.toApiKeys(),u=c+g,l=Date.now();try{yield s._httpClient.postAsync(u,{headers:e,body:a,timeout:s.config.timeout,nextFetchConfig:s.config.nextFetchConfig}),xt(s.config,ht,dt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-l,batchTriggeredBy:Yt[n]});const i=t.map((t=>t.key));o.hits.forEach((t=>{s.onVisitorExposed(t)})),i.length&&(yield s.flushHits(i)),s.sendHitsToFsQa(o.hits)}catch(t){o.hits.forEach((t=>{s._activatePoolQueue.set(t.key,t)})),i&&(yield s.cacheHit(new Map([[i.key,i]]))),Ot(s.config,ht,gt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,duration:Date.now()-l,batchTriggeredBy:Yt[n]});const r=new ee({label:zt.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:_t.ERROR,visitorId:`${s._flagshipInstanceId}`,traffic:0,config:s.config,httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:n});yield s.sendTroubleshootingHit(r)}}))()}}function qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}class Ke extends Be{addHitInPoolQueue(t){var i=this;return e()((function*(){i._hitsPoolQueue.set(t.key,t)}))()}sendActivate({activateHitsPool:t,currentActivate:i,batchTriggeredBy:n}){var s=this;return e()((function*(){const e={[L]:s.config.apiKey,[G]:r.name,[q]:r.version,[B]:K},o=new Oe(Array.from(t.filter((t=>Date.now()-t.createdAt<b))),s.config);i&&o.hits.push(i);const a=o.toApiKeys(),u=c+g,l=Date.now();try{yield s._httpClient.postAsync(u,{headers:e,body:a,timeout:s.config.timeout,nextFetchConfig:s.config.nextFetchConfig}),xt(s.config,ht,dt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-l,batchTriggeredBy:Yt[n]}),o.hits.forEach((t=>{s.onVisitorExposed(t)})),s.sendHitsToFsQa(o.hits)}catch(t){o.hits.forEach((t=>{s._activatePoolQueue.set(t.key,t)})),Ot(s.config,ht,gt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,duration:Date.now()-l,batchTriggeredBy:Yt[n]});const i=new ee({label:zt.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:_t.ERROR,visitorId:`${s._flagshipInstanceId}`,traffic:0,config:s.config,httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:n});yield s.sendTroubleshootingHit(i)}}))()}sendBatch(t=Yt.BatchLength){var i=this;return e()((function*(){let e=!1;if(i._activatePoolQueue.size){const n=Array.from(i._activatePoolQueue.values());i._activatePoolQueue.clear(),yield i.sendActivate({activateHitsPool:n,batchTriggeredBy:t}),e=!0}const n={[B]:K},s=new Re({hits:[]});s.config=i.config;let o=0;const r=[];var c,l=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return qe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?qe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}(i._hitsPoolQueue);try{for(l.s();!(c=l.n()).done;){const t=ke()(c.value,2),e=t[0],i=t[1];if(Date.now()-i.createdAt>=b)r.push(e);else{if(o=JSON.stringify(s).length,o>a)break;s.hits.push(i),r.push(e)}}}catch(t){l.e(t)}finally{l.f()}if(r.forEach((t=>{i._hitsPoolQueue.delete(t)})),!s.hits.length)return void(e&&(yield i.cacheHit(i._activatePoolQueue)));const h=s.toApiKeys(),g=Date.now();try{yield i._httpClient.postAsync(u,{headers:n,body:h,timeout:i.config.timeout,nextFetchConfig:i.config.nextFetchConfig}),xt(i.config,ht,dt,pt,{httpRequestBody:h,httpRequestHeaders:n,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-g,batchTriggeredBy:Yt[t]}),i.sendHitsToFsQa(s.hits)}catch(e){s.hits.forEach((t=>{i._hitsPoolQueue.set(t.key,t)})),Ot(i.config,ht,gt,pt,{httpRequestBody:h,httpRequestHeaders:n,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==e?void 0:e.message,httpResponseHeaders:null==e?void 0:e.headers,httpResponseCode:null==e?void 0:e.statusCode,duration:Date.now()-g,batchTriggeredBy:Yt[t]});const o=new ee({label:zt.SEND_BATCH_HIT_ROUTE_RESPONSE_ERROR,logLevel:_t.ERROR,visitorId:`${i._flagshipInstanceId}`,traffic:0,config:i.config,httpRequestBody:h,httpRequestHeaders:n,httpResponseBody:null==e?void 0:e.message,httpResponseHeaders:null==e?void 0:e.headers,httpResponseMethod:"POST",httpResponseUrl:u,httpResponseCode:null==e?void 0:e.statusCode,httpResponseTime:Date.now()-g});i.addTroubleshootingHit(o)}const d=new Map([...i._hitsPoolQueue,...i._activatePoolQueue]);yield i.flushAllHits(),yield i.cacheHit(d)}))()}}function Qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}class $e extends Be{constructor(t){super(t),this.cacheHitKeys={}}activateFlag(t){var i=this;return e()((function*(){const e=`${t.visitorId}:${Mt()}`;t.key=e,yield i.sendActivate({activateHitsPool:[],currentActivate:t,batchTriggeredBy:Yt.ActivateLength})}))()}addHit(t){var i=this;return e()((function*(){const e=`${t.visitorId}:${Mt()}`;t.key=e,t.type===se.EVENT&&t.action===m&&t.label===`${r.name}:false`&&(yield i.notConsent(t.visitorId)),yield i.sendHit(t)}))()}addHitInPoolQueue(t){return Promise.resolve()}sendHit(t){var i=this;return e()((function*(){const e={[B]:K},n=t.toApiKeys(),s=Date.now();try{yield i._httpClient.postAsync(u,{headers:e,body:n,timeout:i.config.timeout,nextFetchConfig:i.config.nextFetchConfig}),xt(i.config,ht,dt,"HIT",{httpRequestBody:n,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-s,batchTriggeredBy:Yt[Yt.DirectHit]}),i.sendHitsToFsQa([t])}catch(o){t.type===se.EVENT&&t.action===m||(i.cacheHitKeys[t.key]=t.visitorId),yield i.cacheHit((new Map).set(t.key,t)),Ot(i.config,ht,gt,"HIT",{httpRequestBody:n,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==o?void 0:o.message,httpResponseHeaders:null==o?void 0:o.headers,httpResponseCode:null==o?void 0:o.statusCode,duration:Date.now()-s,batchTriggeredBy:Yt[Yt.DirectHit]});const r=new ee({label:zt.SEND_HIT_ROUTE_ERROR,logLevel:_t.ERROR,visitorId:`${i._flagshipInstanceId}`,traffic:0,config:i.config,httpRequestBody:n,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==o?void 0:o.message,httpResponseHeaders:null==o?void 0:o.headers,httpResponseCode:null==o?void 0:o.statusCode,httpResponseTime:Date.now()-s,batchTriggeredBy:Yt.DirectHit});yield i.sendTroubleshootingHit(r)}}))()}notConsent(t){var i=this;return e()((function*(){const e=[];var n,s=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Qe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Qe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}(Object.entries(i.cacheHitKeys).filter((([e,i])=>i===t)));try{for(s.s();!(n=s.n()).done;){const t=ke()(n.value,1)[0];e.push(t)}}catch(t){s.e(t)}finally{s.f()}const o=Array.from(i._hitsPoolQueue).filter((([e,i])=>!((null==i?void 0:i.type)===se.EVENT&&(null==i?void 0:i.action)===m||i.visitorId!==t&&i.anonymousId!==t))),r=Array.from(i._activatePoolQueue).filter((([e,i])=>i.visitorId===t||i.anonymousId===t)),a=[];o.forEach((([t])=>{i._hitsPoolQueue.delete(t),a.push(t)})),r.forEach((([t])=>{i._activatePoolQueue.delete(t),a.push(t)}));const c=[...e,...a];c.length&&(yield i.flushHits(c),i.cacheHitKeys={})}))()}sendActivate({activateHitsPool:t,currentActivate:i,batchTriggeredBy:n}){var s=this;return e()((function*(){const e={[L]:s.config.apiKey,[G]:r.name,[q]:r.version,[B]:K},o=new Oe(Array.from(t.filter((t=>Date.now()-t.createdAt<b))),s.config);i&&o.hits.push(i);const a=o.toApiKeys(),u=c+g,l=Date.now();try{yield s._httpClient.postAsync(u,{headers:e,body:a,timeout:s.config.timeout,nextFetchConfig:s.config.nextFetchConfig}),xt(s.config,ht,dt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,duration:Date.now()-l,batchTriggeredBy:Yt[n]});const i=t.map((t=>t.key));o.hits.forEach((t=>{s.onVisitorExposed(t)})),i.length&&(yield s.flushHits(i)),s.sendHitsToFsQa(o.hits)}catch(t){o.hits.forEach((t=>{s.cacheHitKeys[t.key]=t.visitorId})),i&&(yield s.cacheHit(new Map([[i.key,i]]))),Ot(s.config,ht,gt,ft,{httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseCode:null==t?void 0:t.statusCode,duration:Date.now()-l,batchTriggeredBy:Yt[n]});const r=new ee({label:zt.SEND_ACTIVATE_HIT_ROUTE_ERROR,logLevel:_t.ERROR,visitorId:`${s._flagshipInstanceId}`,traffic:0,config:s.config,httpRequestBody:a,httpRequestHeaders:e,httpRequestMethod:"POST",httpRequestUrl:u,httpResponseBody:null==t?void 0:t.message,httpResponseHeaders:null==t?void 0:t.headers,httpResponseMethod:"POST",httpResponseUrl:u,httpResponseCode:null==t?void 0:t.statusCode,httpResponseTime:Date.now()-l,batchTriggeredBy:n});yield s.sendTroubleshootingHit(r)}}))()}}function ze(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Je(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ze(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ze(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class We extends Wt{constructor(t){super({type:"ACTIVATE",userIp:t.userIp,screenResolution:t.screenResolution,locale:t.locale,sessionNumber:t.sessionNumber,visitorId:t.visitorId,anonymousId:t.anonymousId,qaMode:t.qaMode});const e=t.variationGroupId,i=t.variationId,n=t.flagKey,s=t.flagValue,o=t.flagDefaultValue,r=t.flagMetadata,a=t.visitorContext;this.variationGroupId=e,this.variationId=i,this.flagKey=n,this.flagValue=s,this.flagDefaultValue=o,this.flagMetadata=r,this.visitorContext=a}get variationGroupId(){return this._variationGroupId}set variationGroupId(t){this._variationGroupId=t}get variationId(){return this._variationId}set variationId(t){this._variationId=t}get flagKey(){return this._flagKey}set flagKey(t){this._flagKey=t}get flagValue(){return this._flagValue}set flagValue(t){this._flagValue=t}get flagDefaultValue(){return this._flagDefaultValue}set flagDefaultValue(t){this._flagDefaultValue=t}get flagMetadata(){return this._flagMetadata}set flagMetadata(t){this._flagMetadata=t}get visitorContext(){return this._visitorContext}set visitorContext(t){this._visitorContext=t}isReady(t=!0){return!(t&&!super.isReady()||!this.variationGroupId||!this.variationId)}toApiKeys(){const t={[H]:this.anonymousId||this.visitorId,vaid:this.variationId,caid:this.variationGroupId,cid:this.config.envId,aid:null,[V]:Date.now()-this.createdAt};return this.visitorId&&this.anonymousId&&(t[H]=this.visitorId,t.aid=this.anonymousId),this.qaMode&&(t.qa=this.qaMode),t}toObject(){return Je(Je({},super.toObject()),{},{variationGroupId:this.variationGroupId,variationId:this.variationId})}getErrorMessage(){return"variationGroupId and variationId are required"}}class Ye{get flagshipInstanceId(){return this._flagshipInstanceId}get troubleshootingData(){return this.strategy.troubleshootingData}set troubleshootingData(t){this.strategy.troubleshootingData=t}constructor(t,e,i){Ct()(this,"_isPooling",!1),this._flagshipInstanceId=i,this._hitsPoolQueue=new Map,this._activatePoolQueue=new Map,this._troubleshootingQueue=new Map,this._analyticHitQueue=new Map,this._httpClient=t,this._config=e,this.strategy=this.initStrategy(),this.lookupHits()}initStrategy(){var t;let e;const i={config:this.config,httpClient:this.httpClient,hitsPoolQueue:this._hitsPoolQueue,activatePoolQueue:this._activatePoolQueue,troubleshootingQueue:this._troubleshootingQueue,analyticHitQueue:this._analyticHitQueue,flagshipInstanceId:this.flagshipInstanceId};switch(null==(t=this.config.trackingManagerConfig)?void 0:t.cacheStrategy){case jt.PERIODIC_CACHING:e=new Ke(i);break;case jt.CONTINUOUS_CACHING:e=new Ge(i);break;default:e=new $e(i)}return e}get httpClient(){return this._httpClient}get config(){return this._config}sendTroubleshootingHit(t){var i=this;return e()((function*(){yield i.strategy.sendTroubleshootingHit(t)}))()}startBatchingLoop(){var t;const e=1e3*(null==(t=this.config.trackingManagerConfig)?void 0:t.batchIntervals);At(this.config,ht,"The Batch Loop has been started with a time interval of {0} ms",e),this._intervalID=setInterval((()=>{this.batchingLoop()}),e)}stopBatchingLoop(){clearInterval(this._intervalID),this._isPooling=!1,Rt(this.config,"The Batch Loop has been stopped",ht)}batchingLoop(){var t=this;return e()((function*(){t._isPooling||(t._isPooling=!0,yield t.strategy.sendBatch(Yt.Timer),yield t.strategy.sendTroubleshootingQueue(),yield t.strategy.sendUsageHitQueue(),t._isPooling=!1)}))()}checkLookupHitData(t){var e,i;return!(1!==(null==t?void 0:t.version)||null==t||null==(e=t.data)||!e.type||null==t||null==(i=t.data)||!i.content)||(Et(this.config,"JSON DATA must fit the type HitCacheDTO","LOOKUP HIT"),!1)}lookupHits(){var t=this;return e()((function*(){try{const e=t.config.hitCacheImplementation;if(t.config.disableCache||!e||"function"!=typeof e.lookupHits)return;const i=yield e.lookupHits();if(xt(t.config,ct,"Hits cache has been loaded from database: {0}",i),!i||!Object.keys(i).length)return;const n=t=>Date.now()-t<=b,s=[];Object.entries(i).forEach((([e,i])=>{if(!t.checkLookupHitData(i)||!n(i.data.time))return void s.push(e);let o;switch(i.data.type){case se.EVENT:o=new ce(i.data.content);break;case se.ITEM:o=new he(i.data.content);break;case se.PAGE:o=new fe(i.data.content);break;case se.SCREEN:o=new ye(i.data.content);break;case"SEGMENT":o=new Te(i.data.content);break;case"ACTIVATE":return o=new We(i.data.content),o.key=e,o.createdAt=i.data.content.createdAt,o.config=t.config,void t._activatePoolQueue.set(e,o);case se.TRANSACTION:o=new Ce(i.data.content);break;default:return}o.key=e,o.createdAt=i.data.content.createdAt,o.config=t.config,t._hitsPoolQueue.set(e,o)})),s.length&&(yield t.strategy.flushHits(s))}catch(e){Ot(t.config,ct,lt,"lookupHits",e.message||e)}}))()}sendUsageHit(t){var i=this;return e()((function*(){yield i.strategy.sendUsageHit(t)}))()}addTroubleshootingHit(t){var i=this;return e()((function*(){yield i.strategy.addTroubleshootingHit(t)}))()}}class Ze extends Ye{activateFlag(t){var i=this;return e()((function*(){yield i.strategy.activateFlag(t)}))()}addHit(t){var i=this;return e()((function*(){yield i.strategy.addHit(t)}))()}sendBatch(){var t=this;return e()((function*(){yield t.strategy.sendBatch(Yt.Flush)}))()}}class Xe{constructor(){var t,e,i;this.consoleError=null!=(t=console.error)?t:console.log,this.consoleWarn=null!=(e=console.warn)?e:console.log,this.consoleDebug=null!=(i=console.debug)?i:console.log}emergency(t,e){this.consoleError(this.formatOutput(_t.EMERGENCY,t,e))}alert(t,e){this.consoleError(this.formatOutput(_t.ALERT,t,e))}critical(t,e){this.consoleError(this.formatOutput(_t.CRITICAL,t,e))}error(t,e){this.consoleError(this.formatOutput(_t.ERROR,t,e))}warning(t,e){this.consoleWarn(this.formatOutput(_t.WARNING,t,e))}notice(t,e){this.log(_t.NOTICE,t,e)}info(t,e){console.info(this.formatOutput(_t.INFO,t,e))}debug(t,e){this.consoleDebug(this.formatOutput(_t.DEBUG,t,e))}log(t,e,i){console.log(this.formatOutput(t,e,i))}formatOutput(t,e,i){const n=new Date(Date.now()),s=t=>1===t.toString().length?`0${t}`:t;return`[${s(n.getFullYear())}-${s(n.getMonth()+1)}-${s(n.getDate())} ${s(n.getHours())}:${s(n.getMinutes())}:${s(n.getSeconds())}.${s(n.getMilliseconds())}] [Flagship SDK] [${_t[t]}] [${i}] : ${e}`}}var ti=i(215),ei=i.n(ti);function ii(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ni(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ii(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ii(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i(2087);class si extends Zt{constructor(t){super(ni(ni({},t),{},{type:"USAGE"}))}}function oi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ri(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?oi(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):oi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const ai="FS_DEFAULT_HIT_CACHE";class ci{cacheHit(t){const e=localStorage.getItem(ai)||"{}",i=ri(ri({},JSON.parse(e)),t);return localStorage.setItem(ai,JSON.stringify(i)),Promise.resolve()}lookupHits(){const t=localStorage.getItem(ai)||"{}",e=JSON.parse(t);return Promise.resolve(e)}flushHits(t){const e=localStorage.getItem(ai)||"{}",i=JSON.parse(e);return t.forEach((t=>{delete i[t]})),localStorage.setItem(ai,JSON.stringify(i)),Promise.resolve()}flushAllHits(){return localStorage.removeItem(ai),Promise.resolve()}}const ui="FS_VISITOR_CACHE_";class li{cacheVisitor(t,e){return localStorage.setItem(ui+t,JSON.stringify(e)),Promise.resolve()}lookupVisitor(t){const e=localStorage.getItem(ui+t);return Promise.resolve(e?JSON.parse(e):null)}flushVisitor(t){return localStorage.removeItem(ui+t),Promise.resolve()}}function hi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function gi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?hi(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):hi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const di="Visitor ID mismatch: {0} vs {1}";class fi{get configManager(){return this.visitor.configManager}get trackingManager(){return this.configManager.trackingManager}get decisionManager(){return this.configManager.decisionManager}get config(){return this.visitor.config}constructor(t){const e=t.visitor,i=t.murmurHash;this.visitor=e,this._murmurHash=i}updateCampaigns(t){try{this.visitor.campaigns=t,this.visitor.flagsData=this.decisionManager.getModifications(t)}catch(t){Et(this.config,t.message||t,"updateCampaigns")}}hasTrackingManager(t){const e=this.trackingManager;return e||Et(this.config,Tt("trackerManager must not be null."),t),!!e}setConsent(t){var e;if(this.visitor.hasConsented=t,t||this.flushVisitor(),!this.hasTrackingManager("setConsent"))return;const i=new ce({visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,label:`${r.name}:${this.visitor.hasConsented}`,action:m,category:ae.USER_ENGAGEMENT});i.qaMode=this.config.isQAModeEnabled,i.ds=U,i.config=this.config;const n=new ee({label:zt.VISITOR_SEND_HIT,logLevel:_t.INFO,traffic:this.visitor.traffic||0,visitorId:this.visitor.visitorId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,anonymousId:this.visitor.anonymousId,config:this.config,hitContent:i.toApiKeys()});this.trackingManager.addHit(i),xt(this.config,"SET_CONSENT","Visitor `{0}` consent has been changed : {1}",this.visitor.visitorId,t),this.decisionManager.troubleshooting?this.trackingManager.sendTroubleshootingHit(n):this.visitor.consentHitTroubleshooting=n}checKLookupVisitorDataV1(t){if(!t||!t.data||!t.data.visitorId)return!1;const e=t.data.campaigns;return!e||!!Array.isArray(e)&&(this.visitor.visitorCacheStatus!==Jt.VISITOR_ID_CACHE&&this.visitor.visitorCacheStatus!==Jt.VISITOR_ID_CACHE_NOT_ANONYMOUS_ID_CACHE||t.data.visitorId===this.visitor.visitorId?this.visitor.visitorCacheStatus===Jt.ANONYMOUS_ID_CACHE&&t.data.visitorId!==this.visitor.anonymousId?(At(this.config,ct,di,t.data.visitorId,this.visitor.anonymousId),!1):e.every((t=>t.campaignId&&t.type&&t.variationGroupId&&t.variationId)):(At(this.config,ct,di,t.data.visitorId,this.visitor.visitorId),!1))}checKLookupVisitorData(t){return 1===t.version&&this.checKLookupVisitorDataV1(t)}lookupVisitor(){var t=this;return e()((function*(){try{const e=t.config.visitorCacheImplementation;if(t.config.disableCache||!e||!e.lookupVisitor||"function"!=typeof e.lookupVisitor)return;t.visitor.visitorCacheStatus=Jt.NONE;let i=yield e.lookupVisitor(t.visitor.visitorId);if(i&&(t.visitor.visitorCacheStatus=Jt.VISITOR_ID_CACHE),t.visitor.anonymousId){const n=yield e.lookupVisitor(t.visitor.anonymousId);n&&!i?(i=n,t.visitor.visitorCacheStatus=Jt.ANONYMOUS_ID_CACHE):!n&&i&&(t.visitor.visitorCacheStatus=Jt.VISITOR_ID_CACHE_NOT_ANONYMOUS_ID_CACHE)}if(xt(t.config,ct,"Visitor {0}, visitor cache has been loaded from database: {1}",t.visitor.visitorId,i),!i)return;if(!t.checKLookupVisitorData(i))return void Ot(t.config,ct,at,1,t.visitor.visitorId);t.visitor.visitorCache=i}catch(e){Ot(t.config,ct,ut,t.visitor.visitorId,"lookupVisitor",e.message||e)}}))()}cacheVisitor(){var t=this;return e()((function*(){try{var e,i;const n=t.config.visitorCacheImplementation;if(t.config.disableCache||!n||"function"!=typeof n.cacheVisitor)return;const s={},o={version:1,data:{visitorId:t.visitor.visitorId,anonymousId:t.visitor.anonymousId,consent:t.visitor.hasConsented,context:t.visitor.context,campaigns:t.visitor.campaigns.map((t=>(s[t.variationGroupId]=t.variation.id,{campaignId:t.id,slug:t.slug,variationGroupId:t.variationGroupId,variationId:t.variation.id,isReference:t.variation.reference,type:t.variation.modifications.type,activated:!1,flags:t.variation.modifications.value})))}};o.data.assignmentsHistory=gi(gi({},null==(e=t.visitor.visitorCache)||null==(i=e.data)?void 0:i.assignmentsHistory),s),yield n.cacheVisitor(t.visitor.visitorId,o);const r=t.visitor.visitorCacheStatus;if((!r||r===Jt.NONE||r===Jt.VISITOR_ID_CACHE_NOT_ANONYMOUS_ID_CACHE)&&t.visitor.anonymousId){const e=gi(gi({},o),{},{data:gi(gi({},o.data),{},{visitorId:t.visitor.anonymousId,anonymousId:null})});yield n.cacheVisitor(t.visitor.anonymousId,e)}xt(t.config,ct,"Visitor {0}, visitor cache has been saved into database : {0}",t.visitor.visitorId,o),t.visitor.visitorCache=o}catch(e){Ot(t.config,ct,ut,t.visitor.visitorId,"cacheVisitor",e.message||e)}}))()}flushVisitor(){var t=this;return e()((function*(){try{const e=t.config.visitorCacheImplementation;if(t.config.disableCache||!e||"function"!=typeof e.flushVisitor)return;yield e.flushVisitor(t.visitor.visitorId),xt(t.config,ct,"Visitor {0}, visitor cache has been flushed from database.",t.visitor.visitorId)}catch(e){Ot(t.config,ct,ut,t.visitor.visitorId,"flushVisitor",e.message||e)}}))()}sendTroubleshootingHit(t){var i=this;return e()((function*(){yield i.trackingManager.sendTroubleshootingHit(t)}))()}getCurrentDateTime(){return new Date}getSdkConfigDecisionMode(){return this.config.decisionMode===mt.DECISION_API?"DECISION_API":this.config.decisionMode}sendSdkConfigAnalyticHit(){var t=this;return e()((function*(){var e,i,n,s,o,r;if(t.config.disableDeveloperUsageTracking)return;const a=t.visitor.visitorId+t.getCurrentDateTime().toDateString();if(t._murmurHash.murmurHash3Int32(a)%1e3>1)return;const c=t.config.hitCacheImplementation,u=t.config.visitorCacheImplementation,l=c&&!(c instanceof ci),h=u&&!(u instanceof li),g=new si({label:zt.SDK_CONFIG,logLevel:_t.INFO,visitorId:null==(e=t.visitor.sdkInitialData)?void 0:e.instanceId,flagshipInstanceId:null==(i=t.visitor.sdkInitialData)?void 0:i.instanceId,config:t.config,sdkStatus:t.visitor.getSdkStatus(),lastBucketingTimestamp:t.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(n=t.visitor.sdkInitialData)?void 0:n.lastInitializationTimestamp,sdkConfigMode:t.getSdkConfigDecisionMode(),sdkConfigLogLevel:t.config.logLevel,sdkConfigTimeout:t.config.timeout,sdkConfigPollingInterval:t.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(s=t.config.trackingManagerConfig)?void 0:s.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(o=t.config.trackingManagerConfig)?void 0:o.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(r=t.config.trackingManagerConfig)?void 0:r.poolMaxSize,sdkConfigFetchNow:t.config.fetchNow,sdkConfigReuseVisitorIds:t.config.reuseVisitorIds,sdkConfigInitialBucketing:t.config.initialBucketing,sdkConfigDecisionApiUrl:t.config.decisionApiUrl,sdkConfigHitDeduplicationTime:t.config.hitDeduplicationTime,sdkConfigUsingOnVisitorExposed:!!t.config.onVisitorExposed,sdkConfigUsingCustomHitCache:!!l,sdkConfigUsingCustomVisitorCache:!!h,sdkConfigFetchThirdPartyData:t.config.fetchThirdPartyData,sdkConfigFetchFlagsBufferingTime:t.config.fetchFlagsBufferingTime,sdkConfigDisableDeveloperUsageTracking:t.config.disableDeveloperUsageTracking,sdkConfigNextFetchConfig:t.config.nextFetchConfig,sdkConfigDisableCache:t.config.disableCache});yield t.trackingManager.sendUsageHit(g)}))()}sendFetchFlagsTroubleshooting({isFromCache:t,campaigns:e,now:i}){var n,s,o,r,a,c,u,l;const h={};this.visitor.flagsData.forEach((t=>{h[t.variationGroupId]=t.variationId}));const g=this.visitor.visitorId+(null==(n=this.decisionManager.troubleshooting)?void 0:n.endDate.toUTCString()),d=this._murmurHash.murmurHash3Int32(g)%100;this.visitor.traffic=d;const f=this.config.hitCacheImplementation,p=this.config.visitorCacheImplementation,v=f&&!(f instanceof ci),y=p&&!(p instanceof li),m=new ee({label:zt.VISITOR_FETCH_CAMPAIGNS,logLevel:_t.INFO,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(s=this.visitor.sdkInitialData)?void 0:s.instanceId,traffic:d,config:this.config,sdkStatus:this.visitor.getSdkStatus(),visitorContext:this.visitor.context,visitorCampaigns:e,visitorCampaignFromCache:t?e:void 0,visitorConsent:this.visitor.hasConsented,visitorIsAuthenticated:!!this.visitor.anonymousId,visitorFlags:this.visitor.flagsData,visitorAssignmentHistory:h,visitorInitialCampaigns:null==(o=this.visitor.sdkInitialData)?void 0:o.initialCampaigns,visitorInitialFlagsData:null==(r=this.visitor.sdkInitialData)?void 0:r.initialFlagsData,lastBucketingTimestamp:this.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(a=this.visitor.sdkInitialData)?void 0:a.lastInitializationTimestamp,httpResponseTime:Date.now()-i,sdkConfigLogLevel:this.config.logLevel,sdkConfigMode:this.getSdkConfigDecisionMode(),sdkConfigTimeout:this.config.timeout,sdkConfigPollingInterval:this.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(c=this.config.trackingManagerConfig)?void 0:c.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(u=this.config.trackingManagerConfig)?void 0:u.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(l=this.config.trackingManagerConfig)?void 0:l.poolMaxSize,sdkConfigFetchNow:this.config.fetchNow,sdkConfigReuseVisitorIds:this.config.reuseVisitorIds,sdkConfigInitialBucketing:this.config.initialBucketing,sdkConfigDecisionApiUrl:this.config.decisionApiUrl,sdkConfigHitDeduplicationTime:this.config.hitDeduplicationTime,sdkConfigUsingOnVisitorExposed:!!this.config.onVisitorExposed,sdkConfigUsingCustomHitCache:!!v,sdkConfigUsingCustomVisitorCache:!!y,sdkConfigFetchThirdPartyData:this.config.fetchThirdPartyData,sdkConfigFetchFlagsBufferingTime:this.config.fetchFlagsBufferingTime,sdkConfigDisableDeveloperUsageTracking:this.config.disableDeveloperUsageTracking,sdkConfigNextFetchConfig:this.config.nextFetchConfig,sdkConfigDisableCache:this.config.disableCache});this.sendTroubleshootingHit(m)}sendConsentHitTroubleshooting(){const t=this.visitor.consentHitTroubleshooting;t&&(t.traffic=this.visitor.traffic,this.trackingManager.sendTroubleshootingHit(t),this.visitor.consentHitTroubleshooting=void 0)}sendSegmentHitTroubleshooting(){const t=this.visitor.segmentHitTroubleshooting;t&&(t.traffic=this.visitor.traffic,this.trackingManager.sendTroubleshootingHit(t),this.visitor.segmentHitTroubleshooting=void 0)}}const pi="sdk_deviceLanguage",vi="sdk_deviceType",yi="sdk_deviceModel",mi="sdk_city",Ii="sdk_region",Ci="sdk_country",_i="sdk_lat",bi="sdk_long",Ti="sdk_ip",Oi="sdk_osName",Ei="sdk_osVersionName",ki="sdk_osVersionCode",Si="sdk_carrierName",Ai="sdk_internetConnection",Ri="sdk_versionName",xi="sdk_versionCode",Di="sdk_interfaceName",Ni="fs_client",wi="fs_version",Mi="fs_users",Pi={[pi]:"string",[vi]:"string",[yi]:"string",[mi]:"string",[Ii]:"string",[Ci]:"string",[_i]:"number",[bi]:"number",[Ti]:"string",[Oi]:"string",[Ei]:"string",[ki]:"string",[Si]:"string",[Ai]:"string",[Ri]:"string",[xi]:"string",[Di]:"string",[Ni]:"string",[wi]:"string",[Mi]:"string"};class Fi{constructor(t){const e=t.campaignId,i=t.variationGroupId,n=t.variationId,s=t.isReference,o=t.campaignType,r=t.slug,a=t.variationGroupName,c=t.variationName,u=t.campaignName;this.campaignId=e,this.variationGroupId=i,this.variationId=n,this.isReference=s,this.campaignType=o,this.campaignName=u,this.variationGroupName=a,this.variationName=c,this.slug=r}static Empty(){return new Fi({campaignId:"",campaignName:"",campaignType:"",variationId:"",variationName:"",variationGroupId:"",variationGroupName:"",isReference:!1,slug:null})}}let Hi=function(t){return t.FETCHED="FETCHED",t.FETCHING="FETCHING",t.FETCH_REQUIRED="FETCH_REQUIRED",t.PANIC="PANIC",t}({});const ji=["createdAt"],Vi=["createdAt"];function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}class Li extends fi{checkPredefinedContext(t,e){const i=Pi[t];if(!i)return null;let n=!1;return"string"===i?n="string"==typeof e:"number"===i&&(n="number"==typeof e),n||Ot(this.config,N,J,this.visitor.visitorId,t,i),n}updateContextKeyValue(t,e){const i=typeof e;if("string"!=typeof t||""===t)return void Ot(this.config,N,$,this.visitor.visitorId,t);if("string"!==i&&"number"!==i&&"boolean"!==i)return void Ot(this.config,N,z,this.visitor.visitorId,t);if(t===Ni||t===wi||t===Mi)return;const n=this.checkPredefinedContext(t,e);("boolean"!=typeof n||n)&&(this.visitor.context[t]=e)}updateContext(t,e){if("string"==typeof t)return this.updateContextKeyValue(t,e),xt(this.config,N,"visitor `{0}`, context have been updated: key {1}, value {2}, Context {3}",this.visitor.visitorId,t,e,this.visitor.context),void(this.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.UPDATE_CONTEXT});if(t){for(const e in t){const i=t[e];this.updateContextKeyValue(e,i)}this.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.UPDATE_CONTEXT},xt(this.config,N,"visitor `{0}`, context have been updated: key/value {1}, Context {2}",this.visitor.visitorId,t,this.visitor.context)}else Et(this.visitor.config,"Context must not to be null",N)}clearContext(){this.visitor.context={},this.visitor.loadPredefinedContext(),this.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.UPDATE_CONTEXT},xt(this.config,"CLEAR_CONTEXT","visitor `{0}`, context has been cleared cleared `{1}`",this.visitor.visitorId,this.visitor.context)}fetchVisitorCampaigns(t){var e;return Array.isArray(null==t||null==(e=t.visitorCache)?void 0:e.data.campaigns)?t.visitorCache.data.campaigns.map((t=>({id:t.campaignId,variationGroupId:t.variationGroupId,slug:t.slug,variation:{id:t.variationId,reference:!!t.isReference,modifications:{type:t.type,value:t.flags}}}))):null}isDeDuplicated(t,e){if(0===e)return!1;const i=this.visitor.deDuplicationCache[t];return!!(i&&Date.now()-i<=1e3*e)||(this.visitor.deDuplicationCache[t]=Date.now(),this.visitor.clearDeDuplicationCache(e),!1)}sendActivate(t,i){var n=this;return e()((function*(){var e;const s=new We({variationGroupId:t.variationGroupId,variationId:t.variationId,visitorId:n.visitor.visitorId,anonymousId:n.visitor.anonymousId,flagKey:t.key,flagValue:t.value,flagDefaultValue:i,visitorContext:n.visitor.context,flagMetadata:{campaignName:t.campaignName,campaignId:t.campaignId,campaignType:t.campaignType,variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName,variationId:t.variationId,variationName:t.variationName,slug:t.slug,isReference:t.isReference}});s.config=n.config,s.qaMode=n.config.isQAModeEnabled;const o=s.toObject(),r=(o.createdAt,ei()(o,ji));if(n.isDeDuplicated(JSON.stringify(r),n.config.hitDeduplicationTime)){const e={visitorId:n.visitor.visitorId,anonymousId:n.visitor.anonymousId,flag:t,delay:0};return void Dt(n.config,Tt("Activate {0} is deduplicated",JSON.stringify(e)),M)}yield n.trackingManager.activateFlag(s);const a=new ee({label:zt.VISITOR_SEND_ACTIVATE,logLevel:_t.INFO,traffic:n.visitor.traffic,visitorId:s.visitorId,flagshipInstanceId:null==(e=n.visitor.sdkInitialData)?void 0:e.instanceId,visitorSessionId:n.visitor.instanceId,anonymousId:s.anonymousId,config:n.config,hitContent:s.toApiKeys()});n.sendTroubleshootingHit(a)}))()}sendHit(t){var i=this;return e()((function*(){i.hasTrackingManager(M)&&(yield i.prepareAndSendHit(t))}))()}sendHits(t){var i=this;return e()((function*(){if(i.hasTrackingManager(M)){var e,n=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return Ui(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ui(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}(t);try{for(n.s();!(e=n.n()).done;){const t=e.value;yield i.prepareAndSendHit(t)}}catch(t){n.e(t)}finally{n.f()}}}))()}getHit(t){let e=null;switch(t.type.toUpperCase()){case se.EVENT:e=new ce(t);break;case se.ITEM:e=new he(t);break;case se.PAGE_VIEW:e=new fe(t);break;case se.SCREEN_VIEW:e=new ye(t);break;case se.TRANSACTION:e=new Ce(t)}return e}prepareAndSendHit(t,i=M){var n=this;return e()((function*(){let e;if(null==t||!t.type)return void Et(n.config,"Hit must not be null",i);if(t instanceof Wt)e=t;else{const s=n.getHit(t);if(!s)return void Et(n.config,"property type is required and must ",i);e=s}e.visitorId=n.visitor.visitorId,e.ds=U,e.config=n.config,e.anonymousId=n.visitor.anonymousId,e.qaMode=n.config.isQAModeEnabled;const s=e.toObject(),o=(s.createdAt,ei()(s,Vi));if(!n.isDeDuplicated(JSON.stringify(o),n.config.hitDeduplicationTime))if(e.isReady())try{var r;if(yield n.trackingManager.addHit(e),"SEGMENT"===e.type)return;const t=new ee({label:zt.VISITOR_SEND_HIT,logLevel:_t.INFO,traffic:n.visitor.traffic,visitorId:e.visitorId,flagshipInstanceId:null==(r=n.visitor.sdkInitialData)?void 0:r.instanceId,visitorSessionId:n.visitor.instanceId,anonymousId:e.anonymousId,config:n.config,hitContent:e.toApiKeys()});n.sendTroubleshootingHit(t)}catch(t){Et(n.config,t.message||t,i)}else Et(n.config,e.getErrorMessage(),i)}))()}authenticate(t){var e;if(!t)return void Ot(this.config,nt,st,this.visitor.visitorId);if(this.visitor.anonymousId)return void kt(this.config,nt,"The visitor is already authenticated with visitor ID {0}",this.visitor.visitorId,this.visitor.anonymousId);this.visitor.anonymousId=this.visitor.visitorId,this.visitor.visitorId=t;const i=new ee({label:zt.VISITOR_AUTHENTICATE,logLevel:_t.INFO,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorContext:this.visitor.context,traffic:this.visitor.traffic,config:this.config});this.sendTroubleshootingHit(i),this.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.AUTHENTICATE},xt(this.config,nt,"The visitor is authenticated with new visitor ID {0} anonymous ID {1}",this.visitor.visitorId,this.visitor.anonymousId)}unauthenticate(){var t;if(!this.visitor.anonymousId)return void Ot(this.config,ot,"Visitor {0} is not authenticated yet",this.visitor.visitorId);this.visitor.visitorId=this.visitor.anonymousId,this.visitor.anonymousId=null;const e=new ee({label:zt.VISITOR_UNAUTHENTICATE,logLevel:_t.INFO,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,flagshipInstanceId:null==(t=this.visitor.sdkInitialData)?void 0:t.instanceId,visitorContext:this.visitor.context,traffic:this.visitor.traffic,config:this.config});this.sendTroubleshootingHit(e),this.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.UNAUTHENTICATE},xt(this.config,ot,"The visitor is unauthenticated with visitor ID {0}",this.visitor.visitorId)}fetchFlags(){var t=this;return e()((function*(){const e=W,i=Date.now(),n={visitorId:t.visitor.visitorId,anonymousId:t.visitor.anonymousId,context:t.visitor.context,isFromCache:!1,duration:0};let s,o=null;try{const n=Date.now()-t.visitor.lastFetchFlagsTimestamp,s=t.visitor.fetchStatus.status;if(s===Hi.FETCHING)return void(yield t.visitor.getCampaignsPromise);const r=1e3*t.config.fetchFlagsBufferingTime;if(s===Hi.FETCHED&&n<r)return void At(t.config,e,"Visitor {0}, fetchFlags has been ignored and will continue to be ignored for the next {1}ms, this delay can be changed with `fetchFlagsBufferingTime` option in the SDK config",t.visitor.visitorId,r-n);xt(t.config,e,"visitor `{0}` fetchFlags process is started",t.visitor.visitorId),t.visitor.fetchStatus={status:Hi.FETCHING,reason:bt.NONE},t.visitor.getCampaignsPromise=t.decisionManager.getCampaignsAsync(t.visitor),o=yield t.visitor.getCampaignsPromise,t.visitor.lastFetchFlagsTimestamp=Date.now(),t.decisionManager.isPanic()&&(t.visitor.fetchStatus={status:Hi.PANIC,reason:bt.NONE}),t.configManager.trackingManager.troubleshootingData=t.decisionManager.troubleshooting,xt(t.config,e,"Visitor {0}, anonymousId {1} with context {2} has just fetched campaigns {3} in {4} ms",t.visitor.visitorId,t.visitor.anonymousId,t.visitor.context,o,Date.now()-i)}catch(i){Et(t.config,i.message,e),s=i,t.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.FETCH_ERROR}}try{o||(o=t.fetchVisitorCampaigns(t.visitor),n.isFromCache=!0,o&&(t.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.READ_FROM_CACHE},xt(t.config,e,"Visitor {0}, anonymousId {1} with context {2} has just fetched campaigns from cache {3} in {4} ms",t.visitor.visitorId,t.visitor.anonymousId,t.visitor.context,o,Date.now()-i))),o=o||[],t.visitor.campaigns=o,t.visitor.flagsData=t.decisionManager.getModifications(t.visitor.campaigns),t.visitor.emit(T,s),t.visitor.fetchStatus.status===Hi.FETCHING&&(t.visitor.fetchStatus={status:Hi.FETCHED,reason:bt.NONE});const r={};t.visitor.flagsData.forEach((t=>{r[t.campaignId]={variationId:t.variationId,variationGroupId:t.variationGroupId,campaignId:t.campaignId}})),Fe(r),xt(t.config,e,"Visitor {0}, anonymousId {1} with context {2} has just fetched flags {3} from Campaigns",t.visitor.visitorId,t.visitor.anonymousId,t.visitor.context,t.visitor.flagsData),t.decisionManager.troubleshooting&&(t.sendFetchFlagsTroubleshooting({campaigns:o,now:i,isFromCache:n.isFromCache}),t.sendConsentHitTroubleshooting(),t.sendSegmentHitTroubleshooting()),t.sendSdkConfigAnalyticHit()}catch(s){var r,a,c,u,l,h,g;t.visitor.emit(T,s),n.duration=Date.now()-i,Et(t.config,Pt(s.message||s,n),e),t.visitor.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.FETCH_ERROR};const d=new ee({label:zt.VISITOR_FETCH_CAMPAIGNS_ERROR,logLevel:_t.INFO,visitorId:t.visitor.visitorId,anonymousId:t.visitor.anonymousId,visitorSessionId:t.visitor.instanceId,flagshipInstanceId:null==(r=t.visitor.sdkInitialData)?void 0:r.instanceId,traffic:t.visitor.traffic,config:t.config,visitorContext:t.visitor.context,sdkStatus:t.visitor.getSdkStatus(),visitorCampaigns:o,visitorCampaignFromCache:n.isFromCache?o:void 0,visitorConsent:t.visitor.hasConsented,visitorIsAuthenticated:!!t.visitor.anonymousId,visitorFlags:t.visitor.flagsData,visitorInitialCampaigns:null==(a=t.visitor.sdkInitialData)?void 0:a.initialCampaigns,visitorInitialFlagsData:null==(c=t.visitor.sdkInitialData)?void 0:c.initialFlagsData,lastBucketingTimestamp:t.configManager.decisionManager.lastBucketingTimestamp,lastInitializationTimestamp:null==(u=t.visitor.sdkInitialData)?void 0:u.lastInitializationTimestamp,httpResponseTime:Date.now()-i,sdkConfigMode:t.getSdkConfigDecisionMode(),sdkConfigTimeout:t.config.timeout,sdkConfigPollingInterval:t.config.pollingInterval,sdkConfigTrackingManagerStrategy:null==(l=t.config.trackingManagerConfig)?void 0:l.cacheStrategy,sdkConfigTrackingManagerBatchIntervals:null==(h=t.config.trackingManagerConfig)?void 0:h.batchIntervals,sdkConfigTrackingManagerPoolMaxSize:null==(g=t.config.trackingManagerConfig)?void 0:g.poolMaxSize,sdkConfigFetchNow:t.config.fetchNow,sdkConfigReuseVisitorIds:t.config.reuseVisitorIds,sdkConfigInitialBucketing:t.config.initialBucketing,sdkConfigDecisionApiUrl:t.config.decisionApiUrl,sdkConfigHitDeduplicationTime:t.config.hitDeduplicationTime});t.trackingManager.addTroubleshootingHit(d)}}))()}visitorExposed(t){var i=this;return e()((function*(){const e=t.key,n=t.flag,s=t.defaultValue,o=t.hasGetValueBeenCalled;if(!n)return kt(i.visitor.config,X,'For the visitor "{0}", no flags were found with the key "{1}". As a result, user exposure will not be sent.',i.visitor.visitorId,e),void i.sendFlagTroubleshooting(zt.VISITOR_EXPOSED_FLAG_NOT_FOUND,e,s);o||(kt(i.visitor.config,X,'Visitor "{0}", the flag with the key "{1}" has been exposed without calling the `getValue` method first.',i.visitor.visitorId,e),i.sendFlagTroubleshooting(zt.FLAG_VALUE_NOT_CALLED,e,s,!0)),null==s||null===n.value||wt(n.value,s)||(kt(i.visitor.config,X,'For the visitor "{0}", the flag with key "{1}" has been exposed despite having a different type compared to the default value',i.visitor.visitorId,e),i.sendFlagTroubleshooting(zt.VISITOR_EXPOSED_TYPE_WARNING,e,s)),yield i.sendActivate(n,s)}))()}sendFlagTroubleshooting(t,e,i,n){var s;const o=new ee({label:t,logLevel:_t.WARNING,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(s=this.visitor.sdkInitialData)?void 0:s.instanceId,traffic:this.visitor.traffic,config:this.config,visitorContext:this.visitor.context,flagKey:e,flagDefault:i,visitorExposed:n});this.sendTroubleshootingHit(o)}getFlagValue(t){const e=t.key,i=t.defaultValue,n=t.flag,s=t.visitorExposed;return n?(s&&this.sendActivate(n,i),null===n.value?i:null==i||wt(n.value,i)?(xt(this.config,Y,"Visitor {0}, Flag for key {1} returns value {2}",this.visitor.visitorId,e,n.value),n.value):(kt(this.config,Y,'For the visitor "{0}", the flag with key "{1}" has a different type compared to the default value. Therefore, the default value "{2}" has been returned.',this.visitor.visitorId,e,i),this.sendFlagTroubleshooting(zt.GET_FLAG_VALUE_TYPE_WARNING,e,i,s),i)):(kt(this.config,Y,'For the visitor "{0}", no flags were found with the key "{1}". Therefore, the default value "{2}" has been returned.',this.visitor.visitorId,e,i),this.sendFlagTroubleshooting(zt.GET_FLAG_VALUE_FLAG_NOT_FOUND,e,i,s),i)}SendFlagMetadataTroubleshooting(t){var e;kt(this.config,tt,et,this.visitor.visitorId,t);const i=new ee({label:zt.GET_FLAG_METADATA_TYPE_WARNING,logLevel:_t.WARNING,visitorId:this.visitor.visitorId,anonymousId:this.visitor.anonymousId,visitorSessionId:this.visitor.instanceId,flagshipInstanceId:null==(e=this.visitor.sdkInitialData)?void 0:e.instanceId,traffic:this.visitor.traffic,config:this.config,visitorContext:this.visitor.context,flagKey:t});this.sendTroubleshootingHit(i)}getFlagMetadata(t){const e=t.key,i=t.flag;return i?new Fi({campaignId:i.campaignId,campaignName:i.campaignName,variationGroupId:i.variationGroupId,variationGroupName:i.variationGroupName,variationId:i.variationId,variationName:i.variationName,isReference:!!i.isReference,campaignType:i.campaignType,slug:i.slug}):(kt(this.config,tt,et,this.visitor.visitorId,e),this.SendFlagMetadataTroubleshooting(e),Fi.Empty())}}class Bi extends Li{lookupHits(){return e()((function*(){}))()}lookupVisitor(){return e()((function*(){}))()}cacheVisitor(){return e()((function*(){}))()}sendHit(t){var i=this;return e()((function*(){i.log("sendHit")}))()}sendHits(t){var i=this;return e()((function*(){i.log("sendHits")}))()}fetchFlags(){var t=this;return e()((function*(){t.log("fetchFlags")}))()}getFlagValue(t){return this.log("Flag.value"),t.defaultValue}visitorExposed(){var t=this;return e()((function*(){t.log(X)}))()}getFlagMetadata(t){const e=Fi.Empty();return Ot(this.config,tt,it,this.visitor.visitorId,t.key,e),e}sendActivate(t,i){return e()((function*(){}))()}sendTroubleshootingHit(t){return e()((function*(){}))()}sendSdkConfigAnalyticHit(){return e()((function*(){}))()}log(t){Ot(this.config,t,S,this.visitor.visitorId,t,yt[yt.SDK_NOT_INITIALIZED])}}class Gi extends Li{setConsent(t){this.visitor.hasConsented=t}updateContext(){this.log("updateContext")}clearContext(){this.log("clearContext")}lookupHits(){return e()((function*(){}))()}lookupVisitor(){return e()((function*(){}))()}cacheVisitor(){return e()((function*(){}))()}cacheHit(){return e()((function*(){}))()}fetchVisitorCampaigns(){return[]}sendHit(t){var i=this;return e()((function*(){i.log("sendHit")}))()}sendHits(t){var i=this;return e()((function*(){i.log("sendHits")}))()}getFlagValue(t){return this.log("Flag.value"),t.defaultValue}visitorExposed(){var t=this;return e()((function*(){t.log(X)}))()}getFlagMetadata(t){const e=Fi.Empty();return At(this.config,tt,"Visitor {0}, Flag for key {1} Method Flag.metadata is deactivated while SDK status is PANIC: Empty metadata object is returned {2}\nLearn more: https://docs.developers.flagship.io/docs/glossary#panic-mode",this.visitor.visitorId,t.key,e),e}sendTroubleshootingHit(t){return e()((function*(){}))()}sendSdkConfigAnalyticHit(){return e()((function*(){}))()}sendActivate(t,i){return e()((function*(){}))()}log(t){At(this.config,t,S,this.visitor.visitorId,t,yt[yt.SDK_PANIC])}}class qi extends Li{lookupHits(){return e()((function*(){}))()}lookupVisitor(){return e()((function*(){}))()}cacheVisitor(){return e()((function*(){}))()}cacheHit(){return e()((function*(){}))()}fetchVisitorCampaigns(){return[]}sendHit(t){var i=this;return e()((function*(){i.log("sendHit")}))()}sendHits(t){var i=this;return e()((function*(){i.log("sendHits")}))()}sendActivate(t,i){return e()((function*(){}))()}visitorExposed(){var t=this;return e()((function*(){t.log(X)}))()}sendTroubleshootingHit(t){return e()((function*(){}))()}log(t){Rt(this.config,Tt("Method {0} is deactivated for visitor {1} : visitor did not consent.",t,this.visitor.visitorId),t)}}const Ki="FS_CLIENT_VISITOR",Qi={saveVisitorProfile(t){try{localStorage.setItem(Ki,JSON.stringify(t))}catch(t){}},loadVisitorProfile(){let t=null;try{t=localStorage.getItem(Ki)}catch(t){}return t?JSON.parse(t):null}};class $i{murmurHash3Int32(t,e=0){let i,n,s,o;const r=3&t.length,a=t.length-r;i=e;const c=3432918353,u=461845907;for(o=0;o<a;)s=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24,++o,s=(65535&s)*c+(((s>>>16)*c&65535)<<16)&4294967295,s=s<<15|s>>>17,s=(65535&s)*u+(((s>>>16)*u&65535)<<16)&4294967295,i^=s,i=i<<13|i>>>19,n=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&n)+((58964+(n>>>16)&65535)<<16);switch(s=0,r){case 3:s^=(255&t.charCodeAt(o+2))<<16;case 2:s^=(255&t.charCodeAt(o+1))<<8;case 1:s^=255&t.charCodeAt(o),s=(65535&s)*c+(((s>>>16)*c&65535)<<16)&4294967295,s=s<<15|s>>>17,s=(65535&s)*u+(((s>>>16)*u&65535)<<16)&4294967295,i^=s}return i^=t.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0}}function zi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ji(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?zi(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):zi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class Wi extends s.EventEmitter{get getCampaignsPromise(){return this._getCampaignsPromise}set getCampaignsPromise(t){this._getCampaignsPromise=t}get onFetchFlagsStatusChanged(){return this._onFetchFlagsStatusChanged}set onFetchFlagsStatusChanged(t){this._onFetchFlagsStatusChanged=t}get fetchStatus(){return this._fetchStatus}set fetchStatus(t){this._fetchStatus=t,this.onFetchFlagsStatusChanged&&this.onFetchFlagsStatusChanged(t)}get segmentHitTroubleshooting(){return this._segmentHitTroubleshooting}set segmentHitTroubleshooting(t){this._segmentHitTroubleshooting=t}get consentHitTroubleshooting(){return this._consentHitTroubleshooting}set consentHitTroubleshooting(t){this._consentHitTroubleshooting=t}get sdkInitialData(){return this._sdkInitialData}getSdkStatus(){return Wi.SdkStatus}get visitorCacheStatus(){return this._visitorCacheStatus}set visitorCacheStatus(t){this._visitorCacheStatus=t}constructor(t){const e=t.visitorId,i=t.configManager,n=t.context,s=t.isAuthenticated,o=t.hasConsented,a=t.initialFlagsData,c=t.initialCampaigns,u=t.monitoringData,l=t.onFetchFlagsStatusChanged;super(),Ct()(this,"lastFetchFlagsTimestamp",0),this._exposedVariations={},this._sdkInitialData=u,this._instanceId=Mt(),this._isCleaningDeDuplicationCache=!1,this.deDuplicationCache={},this._context={},this._configManager=i;const h=this.config.reuseVisitorIds?Qi.loadVisitorProfile():null;h&&xt(this.config,w,"Visitor profile has been loaded {0}",h),this.visitorId=e||(!s&&null!=h&&h.anonymousId?null==h?void 0:h.anonymousId:null==h?void 0:h.visitorId)||this.generateVisitorId(),this.campaigns=[],this._anonymousId=null,s&&(this._anonymousId=(null==h?void 0:h.anonymousId)||Mt()),this.setConsent(o||!1),this.updateContext(n),this.loadPredefinedContext(),xt(this.config,w,"Predefined Context have been loaded {0}",{fs_client:r.name,fs_version:r.version,fs_users:this.visitorId}),this.updateCache(),this.setInitialFlags(a),this.setInitializeCampaigns(c,!!a),this.onFetchFlagsStatusChanged=l,this.fetchStatus={status:Hi.FETCH_REQUIRED,reason:bt.VISITOR_CREATED},xt(this.config,w,"Visitor {0} has been created with context {1}, isAuthenticated:{2} and hasConsented {3}",this.visitorId,this.context,!!s,!!this.hasConsented)}get traffic(){return this._traffic}set traffic(t){this._traffic=t}get instanceId(){return this._instanceId}generateVisitorId(){const t=Mt();return xt(this.config,w,"Visitor identifier is empty. A UUID {0} has been generated.",t),t}clearDeDuplicationCache(t){if(!this._isCleaningDeDuplicationCache){this._isCleaningDeDuplicationCache=!0;for(var e=0,i=Object.entries(this.deDuplicationCache);e<i.length;e++){const n=ke()(i[e],2),s=n[0],o=n[1];Date.now()-o>1e3*t&&delete this.deDuplicationCache[s]}this._isCleaningDeDuplicationCache=!1}}setInitialFlags(t){this._flags=new Map,Array.isArray(t)&&t.forEach((t=>{var e;this._flags.set(t.key,{key:t.key,campaignId:t.campaignId,campaignName:t.campaignName,variationGroupId:t.variationGroupId,variationGroupName:t.variationGroupName,variationId:t.variationId,variationName:t.variationName,isReference:t.isReference,value:null==(e=Ht(t.hex,this.config))?void 0:e.v,slug:t.slug,campaignType:t.campaignType})}))}setInitializeCampaigns(t,e){t&&Array.isArray(t)&&!e&&this.getStrategy().updateCampaigns(t)}updateCache(){const t={visitorId:this.visitorId,anonymousId:this.anonymousId};Qi.saveVisitorProfile(t)}loadPredefinedContext(){this.context.fs_client=r.name,this.context.fs_version=r.version,this.context.fs_users=this.visitorId}get visitorId(){return this._visitorId}set visitorId(t){t&&"string"==typeof t?(this._visitorId=t,this.loadPredefinedContext(),this.visitorCache=void 0):Et(this.config,"visitorId must not be null or empty","VISITOR ID")}get hasConsented(){return this._hasConsented}set hasConsented(t){this._hasConsented=t}setConsent(t){this.hasConsented=t,this.getStrategy().setConsent(t)}get context(){return this._context}set context(t){this._context={},this.updateContext(t)}get flagsData(){return this._flags}set flagsData(t){this._flags=t}get configManager(){return this._configManager}get config(){return this.configManager.config}get campaigns(){return this._campaigns}set campaigns(t){this._campaigns=t}get anonymousId(){return this._anonymousId}set anonymousId(t){this._anonymousId=t}getStrategy(){let t;const e={visitor:this,murmurHash:new $i},i=this.getSdkStatus();return t=void 0===i||i===yt.SDK_NOT_INITIALIZED?new Bi(e):i===yt.SDK_PANIC?new Gi(e):this.hasConsented?new Li(e):new qi(e),t}sendExposedVariation(t){t&&Nt()&&(this._exposedVariations[t.campaignId]={campaignId:t.campaignId,variationGroupId:t.variationGroupId,variationId:t.variationId},window.flagship=Ji(Ji({},window.flagship),{},{exposedVariations:this._exposedVariations}),this.config.isQAModeEnabled&&(Object.keys(this._exposedVariations).length>=10&&(He(this._exposedVariations),this._exposedVariations={}),this._sendExposedVariationTimeoutId&&clearTimeout(this._sendExposedVariationTimeoutId),0!==Object.keys(this._exposedVariations).length&&(this._sendExposedVariationTimeoutId=setTimeout((()=>{He(this._exposedVariations),this._exposedVariations={}}),100))))}}let Yi,Zi=function(t){return t.FETCHED="FETCHED",t.FETCH_REQUIRED="FETCH_REQUIRED",t.NOT_FOUND="NOT_FOUND",t.PANIC="PANIC",t}({});function Xi({flagDTO:t,config:e}){var i,n;if(!(e.isQAModeEnabled&&Nt()&&t&&null!=(i=window)&&null!=(n=i.flagship)&&n.forcedVariations))return;const s=window.flagship.forcedVariations[t.campaignId];if(!s)return;const o=s.campaignId,r=s.campaignName,a=s.variationGroupId,c=s.variationGroupName,u=s.campaignType,l=s.CampaignSlug,h=s.variation,g=h.modifications.value[t.key];return{key:t.key,campaignId:o,campaignName:r,variationGroupId:a,variationGroupName:c,variationId:h.id,variationName:h.name,isReference:!!h.reference,campaignType:u,slug:l,value:g}}class tn{constructor(t){Ct()(this,"hasGetValueBeenCalled",!1);const e=t.key,i=t.visitor;this._key=e,this._visitor=i}exists(){var t;if(!this._visitor)return!1;const e=null==(t=this._visitor)?void 0:t.flagsData.get(this._key),i=Xi({flagDTO:e,config:this._visitor.config})||e;return!!(null!=i&&i.campaignId&&null!=i&&i.variationId&&null!=i&&i.variationGroupId)}get metadata(){if(!this._visitor)return Fi.Empty();const t=this._visitor.flagsData.get(this._key),e=Xi({flagDTO:t,config:this._visitor.config});return this._visitor.getFlagMetadata({key:this._key,flag:e||t})}visitorExposed(){var t=this;return e()((function*(){if(!t._visitor)return;const e=t._visitor.flagsData.get(t._key),i=Xi({flagDTO:e,config:t._visitor.config});return t._visitor.visitorExposed({key:t._key,flag:i||e,defaultValue:t._defaultValue,hasGetValueBeenCalled:t.hasGetValueBeenCalled})}))()}getValue(t,e=!0){if(this._defaultValue=t,this.hasGetValueBeenCalled=!0,!this._visitor)return t;const i=this._visitor.flagsData.get(this._key),n=Xi({flagDTO:i,config:this._visitor.config})||i;return this._visitor.sendExposedVariation(n),this._visitor.getFlagValue({key:this._key,defaultValue:t,flag:n,visitorExposed:e})}get status(){var t,e,i,n,s,o;return(null==(t=this._visitor)||null==(e=t.fetchStatus)?void 0:e.status)===Hi.PANIC?Zi.PANIC:this.exists()?(null==(i=this._visitor)||null==(n=i.fetchStatus)?void 0:n.status)===Hi.FETCH_REQUIRED||(null==(s=this._visitor)||null==(o=s.fetchStatus)?void 0:o.status)===Hi.FETCHING?Zi.FETCH_REQUIRED:Zi.FETCHED:Zi.NOT_FOUND}}i(189),Yi=Symbol.iterator;class en{constructor(t){Ct()(this,"_keys",new Set);const e=t.visitor,i=t.flags;this._visitor=e,this._flags=i||new Map,0===this._flags.size?(this._keys=new Set(null==e?void 0:e.flagsData.keys()),this._keys.forEach((t=>{this._flags.set(t,new tn({key:t,visitor:e}))}))):this._keys=new Set(this._flags.keys())}get size(){return this._keys.size}get(t){var e,i,n;return this._flags.get(t)||((null==(e=this._visitor)?void 0:e.config)&&kt(null==(i=this._visitor)?void 0:i.config,Z,'For the visitor "{0}", no flags were found with the key "{1}". Therefore, an empty flag has been returned.',null==(n=this._visitor)?void 0:n.visitorId,t),new tn({key:t}))}has(t){return this._keys.has(t)}keys(){return this._keys}[Yi](){let t=0;const e=Array.from(this._keys);return{next:()=>{if(t<e.length){const i=e[t++];return{value:[i,this._flags.get(i)],done:!1}}return{value:null,done:!0}}}}filter(t){const e=new Map;return this._flags.forEach(((i,n)=>{t(i,n,this)&&e.set(n,i)})),new en({visitor:this._visitor,flags:e})}exposeAll(){var t=this;return e()((function*(){yield Promise.all(Array.from(t._flags.values(),(t=>t.visitorExposed())))}))()}getMetadata(){const t=new Map;return this._flags.forEach(((e,i)=>{t.set(i,e.metadata)})),t}toJSON(){const t=[];return this._flags.forEach(((e,i)=>{const n=e.metadata;t.push({key:i,campaignId:n.campaignId,campaignName:n.campaignName,variationGroupId:n.variationGroupId,variationGroupName:n.variationGroupName,variationId:n.variationId,variationName:n.variationName,isReference:n.isReference,campaignType:n.campaignType,slug:n.slug,hex:Ft({v:e.getValue(null,!1)})})})),t}forEach(t){this._flags.forEach(((e,i)=>{t(e,i,this)}))}}class nn extends Wi{updateContext(t,e){this.getStrategy().updateContext(t,e),this.loadPredefinedContext()}clearContext(){this.getStrategy().clearContext()}getFlag(t){return this.fetchStatus.status!==Hi.FETCHED&&this.fetchStatus.status!==Hi.FETCHING&&kt(this.config,Z,function(t){let e="";switch(t){case bt.VISITOR_CREATED:e=`Visitor \`{0}\` has been created ${R}`;break;case bt.UPDATE_CONTEXT:e=`Visitor context for visitor \`{0}\` has been updated ${R}`;break;case bt.AUTHENTICATE:e=`Visitor \`{0}\` has been authenticated ${R}`;break;case bt.UNAUTHENTICATE:e=`Visitor \`{0}\` has been unauthenticated ${R}`;break;case bt.FETCH_ERROR:e='There was an error while fetching flags for visitor `{0}`. So the value of the flag `{1}` may be outdated"';break;case bt.READ_FROM_CACHE:e="Flags for visitor `{0}` have been fetched from cache"}return e}(this.fetchStatus.reason),this.visitorId,t),new tn({key:t,visitor:this})}getFlags(){return new en({visitor:this})}sendHit(t){return this.getStrategy().sendHit(t)}sendHits(t){return this.getStrategy().sendHits(t)}authenticate(t){this.getStrategy().authenticate(t),this.updateCache()}unauthenticate(){this.getStrategy().unauthenticate(),this.updateCache()}fetchFlags(){var t=this;return e()((function*(){yield t.getStrategy().lookupVisitor(),yield t.getStrategy().fetchFlags(),yield t.getStrategy().cacheVisitor()}))()}visitorExposed(t){return this.getStrategy().visitorExposed(t)}getFlagValue(t){return this.getStrategy().getFlagValue(t)}getFlagMetadata(t){return this.getStrategy().getFlagMetadata(t)}}function sn(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return on(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?on(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}i(6755),i(7852);class rn extends ie{constructor(t,e,i){super(t,e),this._murmurHash=i,this._isFirstPooling=!0,e.initialBucketing&&(this._bucketingContent=e.initialBucketing)}finishLoop(t){const e=t.response,i=t.headers,n=t.url,s=t.now;if(200===e.status){xt(this.config,Q,"Polling event with code status 200 : {0}",e.body),this._bucketingContent=e.body,this._lastBucketingTimestamp=(new Date).toISOString();const t=new ee({visitorId:this.flagshipInstanceId,flagshipInstanceId:this.flagshipInstanceId,label:zt.SDK_BUCKETING_FILE,traffic:0,logLevel:_t.INFO,config:this.config,httpRequestHeaders:i,httpRequestMethod:"POST",httpRequestUrl:n,httpResponseBody:null==e?void 0:e.body,httpResponseHeaders:null==e?void 0:e.headers,httpResponseCode:null==e?void 0:e.status,httpResponseTime:Date.now()-s});this.trackingManager.sendTroubleshootingHit(t)}else 304===e.status&&Dt(this.config,"Polling event with code status 304",Q);if(e.headers&&e.headers["last-modified"]){const t=e.headers["last-modified"];this._lastModified!==t&&this.config.onBucketingUpdated&&this.config.onBucketingUpdated(new Date(t)),this._lastModified=t}this._isFirstPooling&&(this._isFirstPooling=!1,this.updateFlagshipStatus(yt.SDK_INITIALIZED)),"function"==typeof this.config.onBucketingSuccess&&this.config.onBucketingSuccess({status:e.status,payload:this._bucketingContent}),this._isPooling=!1}startPolling(){var t=this;return e()((function*(){const e=1e3*t.config.pollingInterval;Rt(t.config,"Bucketing polling process has been started",Q),yield t.polling(),0!==e&&(t._intervalID=setInterval((()=>{t.polling()}),e))}))()}polling(){var t=this;return e()((function*(){if(t._isPooling)return;t._isPooling=!0,t._isFirstPooling&&t.updateFlagshipStatus(yt.SDK_INITIALIZING);const e=Tt("https://cdn.flagship.io/{0}/bucketing.json",t.config.envId),i={[L]:`${t.config.apiKey}`,[G]:r.name,[q]:r.version,[B]:K},n=Date.now();try{t._lastModified&&(i["if-modified-since"]=t._lastModified);const s=yield t._httpClient.getAsync(e,{headers:i,timeout:t.config.timeout,nextFetchConfig:t.config.nextFetchConfig});t.finishLoop({response:s,headers:i,url:e,now:n})}catch(s){t._isPooling=!1,Et(t.config,Pt("Polling event failed with error",{url:e,headers:i,nextFetchConfig:t.config.nextFetchConfig,method:"GET",duration:Date.now()-n}),Q),t._isFirstPooling&&t.updateFlagshipStatus(yt.SDK_NOT_INITIALIZED),"function"==typeof t.config.onBucketingFail&&t.config.onBucketingFail(new Error(s));const o=new ee({visitorId:t.flagshipInstanceId,flagshipInstanceId:t.flagshipInstanceId,label:zt.SDK_BUCKETING_FILE_ERROR,traffic:0,logLevel:_t.INFO,config:t.config,httpRequestHeaders:i,httpRequestMethod:"GET",httpRequestUrl:e,httpResponseBody:null==s?void 0:s.message,httpResponseHeaders:null==s?void 0:s.headers,httpResponseCode:null==s?void 0:s.statusCode,httpResponseTime:Date.now()-n});t.trackingManager.sendTroubleshootingHit(o)}}))()}stopPolling(){clearInterval(this._intervalID),this._isPooling=!1,Rt(this.config,"Bucketing polling process has been stopped",Q)}sendContext(t){var i=this;return e()((function*(){try{var e;if(Object.keys(t.context).length<=3||!t.hasConsented)return;const n=new Te({context:t.context,visitorId:t.visitorId,anonymousId:t.anonymousId});yield t.sendHit(n);const s=new ee({label:zt.VISITOR_SEND_HIT,logLevel:_t.INFO,traffic:t.traffic||0,visitorId:t.visitorId,visitorSessionId:t.instanceId,flagshipInstanceId:null==(e=t.sdkInitialData)?void 0:e.instanceId,anonymousId:t.anonymousId,config:i.config,hitContent:n.toApiKeys()});t.segmentHitTroubleshooting=s}catch(t){Et(i.config,t.message||t,"sendContext")}}))()}getThirdPartySegment(t){var i=this;return e()((function*(){const e=Tt("https://api-data-connector.flagship.io/accounts/{0}/segments/{1}",i.config.envId,t),n=Date.now(),s={};try{const t=(yield i._httpClient.getAsync(e,{nextFetchConfig:i.config.nextFetchConfig})).body;if(Array.isArray(t)){var o,r=sn(t);try{for(r.s();!(o=r.n()).done;){const t=o.value;s[`${t.partner}::${t.segment}`]=t.value}}catch(t){r.e(t)}finally{r.f()}}}catch(t){Et(i.config,Pt(t.message||t,{url:e,nextFetchConfig:i.config.nextFetchConfig,duration:Date.now()-n}),"GET_THIRD_PARTY_SEGMENT")}return s}))()}getCampaignsAsync(t){var i=this;return e()((function*(){var e,n;if(!i._bucketingContent)return null;const s=null==(e=i._bucketingContent)||null==(n=e.accountSettings)?void 0:n.troubleshooting;if(i.troubleshooting=void 0,s&&(i.troubleshooting={startDate:new Date(s.startDate),endDate:new Date(s.endDate),timezone:s.timezone,traffic:s.traffic}),i._bucketingContent.panic)return i.panic=!0,[];if(i.panic=!1,!i._bucketingContent.campaigns)return null;if(i.config.fetchThirdPartyData){const e=yield i.getThirdPartySegment(t.visitorId);t.updateContext(e)}yield i.sendContext(t);const o=[];return i._bucketingContent.campaigns.forEach((e=>{const n=i.getVisitorCampaigns(e.variationGroups,e.id,e.type,t);var s;n&&(n.slug=null!=(s=e.slug)?s:null,n.name=e.name,o.push(n))})),o}))()}getVisitorCampaigns(t,e,i,n){var s,o=sn(t);try{for(o.s();!(s=o.n()).done;){const t=s.value;if(this.isMatchTargeting(t,n)){const s=this.getVariation(t,n);return s?{id:e,variation:s,variationGroupId:t.id,variationGroupName:t.name,type:i}:null}}}catch(t){o.e(t)}finally{o.f()}return null}getVariation(t,e){const i=this._murmurHash.murmurHash3Int32(t.id+e.visitorId)%100;let n=0;var s,o=sn(t.variations);try{for(o.s();!(s=o.n()).done;){var r,a;const o=s.value,c=null==(r=e.visitorCache)||null==(a=r.data)?void 0:a.assignmentsHistory,u=c?c[t.id]:null;if(u){const i=t.variations.find((t=>t.id===u));if(!i)continue;return xt(this.config,rt,"Visitor {0}, Variation {1} selected from cache.",e.visitorId,i.id),{id:i.id,name:i.name,modifications:i.modifications,reference:i.reference}}if(void 0!==o.allocation&&(n+=o.allocation,i<=n))return xt(this.config,rt,"Visitor {0}, Variation {1} selected with allocation {2}.",e.visitorId,o.id,n),{id:o.id,modifications:o.modifications,reference:o.reference,name:o.name}}}catch(t){o.e(t)}finally{o.f()}return null}isMatchTargeting(t,e){return!!(t&&t.targeting&&t.targeting.targetingGroups)&&t.targeting.targetingGroups.some((t=>this.checkAndTargeting(t.targetings,e)))}isANDListOperator(t){return["NOT_EQUALS","NOT_CONTAINS"].includes(t)}checkAndTargeting(t,e){let i,n=!1;var s,o=sn(t);try{for(o.s();!(s=o.n()).done;){const t=s.value,o=t.key,r=t.value,a=t.operator;if("EXISTS"===a){if(o in e.context){n=!0;continue}n=!1;break}if("NOT_EXISTS"!==a)if("fs_all_users"!==o){if("fs_users"===o)i=e.visitorId;else{if(!(o in e.context)){n=!1;break}i=e.context[o]}if(n=this.testOperator(a,i,r),!n)break}else n=!0;else{if(o in e.context){n=!1;break}n=!0}}}catch(t){o.e(t)}finally{o.f()}return n}testListOperatorLoop(t,e,i,n){let s=n;var o,r=sn(i);try{for(r.s();!(o=r.n()).done;){const i=o.value;if(s=this.testOperator(t,e,i),s!==n)break}}catch(t){r.e(t)}finally{r.f()}return s}testListOperator(t,e,i){return this.isANDListOperator(t)?this.testListOperatorLoop(t,e,i,!0):this.testListOperatorLoop(t,e,i,!1)}testOperator(t,e,i){let n;if(Array.isArray(i))return this.testListOperator(t,e,i);switch(t){case"EQUALS":n=e===i;break;case"NOT_EQUALS":n=e!==i;break;case"CONTAINS":n=e.toString().includes(i.toString());break;case"NOT_CONTAINS":n=!e.toString().includes(i.toString());break;case"GREATER_THAN":n=e>i;break;case"LOWER_THAN":n=e<i;break;case"GREATER_THAN_OR_EQUALS":n=e>=i;break;case"LOWER_THAN_OR_EQUALS":n=e<=i;break;case"STARTS_WITH":n=e.toString().startsWith(i.toString());break;case"ENDS_WITH":n=e.toString().endsWith(i.toString());break;default:n=!1}return n}}class an extends Error{get headers(){return this._headers}get statusCode(){return this._statusCode}constructor(t,e,i){super(e),this._statusCode=t,this._headers=i}}const cn=require("node-abort-controller"),un=require("node-fetch");var ln=i.n(un);function hn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function gn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?hn(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):hn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const dn=function(){var t=e()((function*(t,e){const n=function(){const t={};if("undefined"==typeof window){const e=i(3685).Agent,n=i(5687).Agent;t.agent=t=>"http:"===t.protocol?new e({keepAlive:!0}):new n({keepAlive:!0})}return t}();return ln()(t,gn(gn({},n),e))}));return function(e,i){return t.apply(this,arguments)}}();class fn{getResponse(t){return e()((function*(){const e="application/json"===t.headers.get("Content-Type");let i;const n={};if(t.headers.forEach(((t,e)=>{n[e]=t})),e&&t.ok&&204!==t.status&&(i=yield t.json()),t.status>=400){const e=yield t.text();throw new an(t.status,e||t.statusText,n)}return{status:t.status,body:i,headers:n}}))()}getAsync(t,i){var n=this;return e()((function*(){const e=new cn.AbortController,s=setTimeout((()=>e.abort()),1e3*(null!=i&&i.timeout?i.timeout:2));try{const s=yield dn(t,{method:"GET",headers:null==i?void 0:i.headers,signal:e.signal,keepalive:!0,next:null==i?void 0:i.nextFetchConfig});return n.getResponse(s)}finally{clearTimeout(s)}}))()}postAsync(t,i){var n=this;return e()((function*(){const e=new cn.AbortController,s=setTimeout((()=>e.abort()),i.timeout?1e3*i.timeout:2e3);try{const s=yield dn(t,{method:"POST",headers:i.headers,body:JSON.stringify(i.body),signal:e.signal,keepalive:!0,next:null==i?void 0:i.nextFetchConfig});return n.getResponse(s)}finally{clearTimeout(s)}}))()}}class pn extends rn{getCampaignsAsync(t){return super.getCampaignsAsync(t)}}function vn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function yn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?vn(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class mn extends Ut{constructor(t){super(yn(yn({},t),{},{decisionMode:mt.BUCKETING_EDGE}))}}i(1637),i(4765);const In=t=>document.querySelector(`script[src*="${t}"]`);function Cn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function _n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Cn(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Cn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function bn(t=!1){"TypeScript"===r.name&&document.location.reload();const e=new CustomEvent(Ne.FsTriggerRendering,{detail:{forcedReFetchFlags:t}});window.dispatchEvent(e)}function Tn(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function On(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Tn(Object(i),!0).forEach((function(e){Ct()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Tn(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function En(t,e=null){var i,n;if(null!=(i=window)&&null!=(n=i.frames)&&n.ABTastyQaAssistant)return;let s={};const o=sessionStorage.getItem(C);try{s=JSON.parse(o||"{}")}catch(t){console.error("Error parsing sessionForcedVariations",t)}window.flagship=On(On({},window.flagship),{},{envId:t.envId,forcedVariations:s});const r=e=>{!function({event:t,config:e,func:i}){var n,s,o,r;if(e.isQAModeEnabled&&Nt())switch(t.data.name){case xe.FsQaAssistantReady:null!=(n=window.flagship)&&n.visitorVariations&&Fe(null==(o=window.flagship)?void 0:o.visitorVariations),null!=(s=window.flagship)&&s.exposedVariations&&He(null==(r=window.flagship)?void 0:r.exposedVariations);break;case xe.MinimizeQaAssistantClose:case xe.QaAssistantClose:!function({config:t,func:e}){var i;t.isQAModeEnabled=!1,sessionStorage.removeItem(I),e&&window.removeEventListener("message",e),null==(i=document.getElementById(_))||i.remove(),window.flagship=_n(_n({},window.flagship),{},{forcedVariations:{}}),bn()}({config:e,func:i});break;case xe.FsApplyForcedVariations:!function({value:t}){const e=sessionStorage.getItem(C);let i={};try{i=JSON.parse(e||"{}")}catch(t){console.error("Error parsing sessionForcedVariations",t)}i=_n(_n({},i),t),sessionStorage.setItem(C,JSON.stringify(i)),window.flagship=_n(_n({},window.flagship),{},{forcedVariations:i}),bn()}({value:t.data.value});break;case xe.FsResetForcedVariations:sessionStorage.removeItem(C),window.flagship=_n(_n({},window.flagship),{},{forcedVariations:{}}),bn();break;case xe.FsTriggerRender:bn(!0)}}({event:e,config:t,func:r})};window.addEventListener("message",r),At(t,"QA assistant","Loading QA Assistant"),function(t){if(In(v)||In(y))return;const e=document.createElement("script");e.src=t,e.id=_,document.body.append(e)}(e||d),t.isQAModeEnabled=!0,sessionStorage.setItem(I,"true")}class kn{set configManager(t){this._configManager=t}get configManager(){return this._configManager}constructor(){this.instanceId=Mt(),this._status=yt.SDK_NOT_INITIALIZED}static getInstance(){return this._instance||(this._instance=new this),this._instance}setStatus(t){var e;if(this._status===t)return;this._status=t,Wi.SdkStatus=t;const i=null==(e=this.getConfig())?void 0:e.onSdkStatusChanged;var n,s,o,r;(At(this._config,"SDK STATUS","SDK status has changed:  {0}",yt[t]),this.getConfig().decisionMode!==mt.BUCKETING_EDGE)&&(t===yt.SDK_INITIALIZED&&(null==(n=this.configManager)||null==(s=n.trackingManager)||s.startBatchingLoop()),t===yt.SDK_NOT_INITIALIZED&&(null==(o=this.configManager)||null==(r=o.trackingManager)||r.stopBatchingLoop()));i&&i(t)}static getStatus(){return this.getInstance()._status}getStatus(){return this._status}static getConfig(){return this.getInstance()._config}getConfig(){return this._config}getVisitor(){return this._visitorInstance}static getVisitor(){return this.getInstance().getVisitor()}buildConfig(t){let e;switch(null==t?void 0:t.decisionMode){case mt.BUCKETING:e=new Gt(t);break;case mt.BUCKETING_EDGE:e=new mn(t);break;default:e=new Qt(t)}return e}buildDecisionManager(t,e,i){let n;const s=e=>{t.setStatus(e)};switch(e.decisionMode){case mt.BUCKETING:n=new rn(i,e,new $i),n.statusChangedCallback(s),n.startPolling();break;case mt.BUCKETING_EDGE:n=new pn(i,e,new $i),n.statusChangedCallback(s);break;default:n=new ne(i,e),n.statusChangedCallback(s)}return n}static start(t,e,i){var n,s;const o=this.getInstance(),a=o.buildConfig(i);if(a.envId=t,a.apiKey=e,o._config=a,a.onLog||a.logManager||(a.logManager=new Xe),!t||!e)return o.setStatus(yt.SDK_NOT_INITIALIZED),Et(a,E,D),o;xt(a,D,"Flagship SDK version {0} is starting in {1} mode with config {2}",r.version,a.decisionMode,a),!a.hitCacheImplementation&&Nt()&&(a.hitCacheImplementation=new ci),!a.visitorCacheImplementation&&Nt()&&(a.visitorCacheImplementation=new li);const c=new fn,u=null==(n=o.configManager)?void 0:n.decisionManager;u instanceof rn&&a.decisionMode!==mt.BUCKETING_EDGE&&u.stopPolling();let l=null==(s=o.configManager)?void 0:s.trackingManager;return l||(l=new Ze(c,a,o.instanceId)),o.configManager=new $t(a,u,l),o.configManager.decisionManager=o.buildDecisionManager(o,a,c),o.configManager.decisionManager.trackingManager=l,o.configManager.decisionManager.flagshipInstanceId=o.instanceId,o._status!==yt.SDK_INITIALIZING&&o.setStatus(yt.SDK_INITIALIZED),Rt(a,Tt("Flagship SDK (version: {0}) {1}",r.version,yt[o._status]),D),function(t){if(!Nt())return;const e={fs_qa_assistant:d,abtasty_qa_assistant:d,fs_qa_assistant_staging:f,abtasty_qa_assistant_staging:f,fs_qa_assistant_local:p,abtasty_qa_assistant_local:p},i=new URLSearchParams(window.location.search),n=Object.keys(e).find((t=>"true"===i.get(t)))||"";t.isQAModeEnabled||n?En(t,e[n]):function(t){At(t,"QA assistant","Listening for keyboard events to launch QA Assistant");const e={};document.addEventListener("keydown",(i=>{e[i.key]=!0,sessionStorage.removeItem(C),(e.Control||e.Alt)&&e.q&&e.a&&En(t)})),document.addEventListener("keyup",(t=>{delete e[t.key]}))}(t)}(a),o.lastInitializationTimestamp=(new Date).toISOString(),o}close(){return e()((function*(){yield kn.close()}))()}static close(){var t=this;return e()((function*(){var e,i,n;yield null==(e=t._instance)||null==(i=e.configManager)||null==(n=i.trackingManager)?void 0:n.sendBatch()}))()}newVisitor(t){return kn.newVisitor(t)}static newVisitor({visitorId:t,context:e,isAuthenticated:i,hasConsented:n,initialCampaigns:s,initialFlagsData:o,shouldSaveInstance:r,onFetchFlagsStatusChanged:a}){var c;const u=null!=r?r:Nt();if(null==(c=this._instance)||!c.configManager){const t=this.getInstance(),e=new Qt;e.logManager=new Xe,t._config=e;const i=new fn,n=new Ze(i,e),s=new ne(i,e);t.configManager=new $t(e,s,n),Et(this.getConfig(),x,w)}void 0===n&&St(this.getConfig(),"Consent has not been specified. By default, consent is set to false, which may result in some features being deactivated.",w);const l=new nn({visitorId:t,context:e||{},isAuthenticated:null!=i&&i,hasConsented:null!=n&&n,configManager:this.getInstance().configManager,initialCampaigns:s,initialFlagsData:o,onFetchFlagsStatusChanged:a,monitoringData:{instanceId:this.getInstance().instanceId,lastInitializationTimestamp:this.getInstance().lastInitializationTimestamp,initialCampaigns:s,initialFlagsData:o}}),h=new vt(l);return this.getInstance()._visitorInstance=u?h:void 0,u&&xt(this.getConfig(),w,"Visitor {0} has been saved in SDK instance",h.visitorId),this.getConfig().fetchNow&&this.getConfig().decisionMode!==mt.BUCKETING_EDGE&&h.fetchFlags(),h}}const Sn=kn})(),module.exports=n})();
//# sourceMappingURL=index.cjs.map